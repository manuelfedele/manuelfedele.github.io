<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=false><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>Clean Package Design in Go: Single Responsibility and Package Cohesion &#183; Git Push and Run</title><meta name=title content="Clean Package Design in Go: Single Responsibility and Package Cohesion &#183; Git Push and Run"><meta name=description content="Software Engineer and Cloud Architect writing about Go, Python, AWS, and AI automation."><meta name=keywords content="golang,design patterns,architecture,"><link rel=canonical href=https://manuelfedele.github.io/posts/the-single-responsibility-principle/><meta name=author content="Manuel Fedele"><link href=https://github.com/manuelfedele rel=me><link href=https://linkedin.com/in/manuel-fedele rel=me><meta property="og:url" content="https://manuelfedele.github.io/posts/the-single-responsibility-principle/"><meta property="og:site_name" content="Git Push and Run"><meta property="og:title" content="Clean Package Design in Go: Single Responsibility and Package Cohesion"><meta property="og:description" content="SRP in Go is about package boundaries and exported surfaces, not just splitting methods into files. When a package has one reason to change, you can test it in isolation, swap implementations behind an interface, and reason about its behavior without reading the rest of the codebase. The Single Responsibility Principle (SRP) is often stated as “a class should have one reason to change.” In Go, there are no classes, but the principle applies with equal force to packages and to the exported types within them. Getting it wrong produces a God service: one package that knows about the database, email, HTTP, and business logic all at once. Getting it right produces a codebase where changing the email provider does not require touching the database layer."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-21T15:10:03+01:00"><meta property="article:modified_time" content="2023-03-21T15:10:03+01:00"><meta property="article:tag" content="Golang"><meta property="article:tag" content="Design Patterns"><meta property="article:tag" content="Architecture"><meta name=twitter:card content="summary"><meta name=twitter:title content="Clean Package Design in Go: Single Responsibility and Package Cohesion"><meta name=twitter:description content="SRP in Go is about package boundaries and exported surfaces, not just splitting methods into files. When a package has one reason to change, you can test it in isolation, swap implementations behind an interface, and reason about its behavior without reading the rest of the codebase. The Single Responsibility Principle (SRP) is often stated as “a class should have one reason to change.” In Go, there are no classes, but the principle applies with equal force to packages and to the exported types within them. Getting it wrong produces a God service: one package that knows about the database, email, HTTP, and business logic all at once. Getting it right produces a codebase where changing the email provider does not require touching the database layer."><link type=text/css rel=stylesheet href=/css/main.bundle.min.726dfbf42bcd66e35e2d7258d72fe8fe77509ff76d153e2b46cdbae9c3af9620653459f0119a72d2af4a9b4bc446652d244ad58743d0290e5d8e09e3983b98e5.css integrity="sha512-cm379CvNZuNeLXJY1y/o/ndQn/dtFT4rRs266cOvliBlNFnwEZpy0q9Km0vERmUtJErVh0PQKQ5djgnjmDuY5Q=="><script type=text/javascript src=/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js integrity="sha512-b0EXSzoFtoCCD+CMrb+l+3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.88278edec77139635e1ad294df5b32b7be9338191c5252d3f6f451ace5852d5f82390cccacedab9c64739d8e068b7e8502895cf8f951060c0368f9a73709fcb7.js integrity="sha512-iCeO3sdxOWNeGtKU31syt76TOBkcUlLT9vRRrOWFLV+COQzMrO2rnGRznY4Gi36FAolc+PlRBgwDaPmnNwn8tw==" data-copy=Copy data-copied=Copied></script><script defer type=text/javascript src=/js/mermaid.bundle.c63c50c6884d5e5a17085b7ea24a2ef1f2c96af692b3e243dfab2ab9ef6e6c045a111b16d5cd3ce4d3f1a4919e6a86c4d49c16f5cf9b44db6dd7f6ffbc8d4b49.js integrity="sha512-xjxQxohNXloXCFt+okou8fLJavaSs+JD36sque9ubARaERsW1c085NPxpJGeaobE1JwW9c+bRNtt1/b/vI1LSQ=="></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Clean Package Design in Go: Single Responsibility and Package Cohesion","headline":"Clean Package Design in Go: Single Responsibility and Package Cohesion","inLanguage":"en","url":"https://manuelfedele.github.io/posts/the-single-responsibility-principle/","author":{"@type":"Person","name":"Manuel Fedele"},"copyrightYear":"2023","dateCreated":"2023-03-21T15:10:03\u002b01:00","datePublished":"2023-03-21T15:10:03\u002b01:00","dateModified":"2023-03-21T15:10:03\u002b01:00","keywords":["golang","design patterns","architecture"],"mainEntityOfPage":"true","wordCount":"1642"}]</script></head><body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral bf-scrollbar"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 z-100"><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl bg-neutral/25 dark:bg-neutral-800/25"></div><div class="relative m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32"><div class="main-menu flex items-center w-full gap-2 p-1 pl-0"><a href=/ class="text-base font-medium truncate min-w-0 shrink">Git Push and Run</a><div class="flex items-center ms-auto"><div class="hidden md:flex"><nav class="flex items-center gap-x-5 h-12"><a href=/posts/ class="flex items-center bf-icon-color-hover" aria-label=Blog title=Posts><span class="text-base font-medium break-normal">Blog
</span></a><a href=/about/ class="flex items-center bf-icon-color-hover" aria-label=About title=About><span class="text-base font-medium break-normal">About
</span></a><a href=/coaching/ class="flex items-center bf-icon-color-hover" aria-label=Coaching title=Coaching><span class="text-base font-medium break-normal">Coaching
</span></a><a href=https://github.com/manuelfedele target=_blank class="flex items-center bf-icon-color-hover" aria-label=github title><span><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span></a><div class="translation nested-menu"><button class="cursor-pointer flex items-center">
<span class=me-1><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M0 128C0 92.7 28.7 64 64 64H256h48 16H576c35.3.0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H320 304 256 64c-35.3.0-64-28.7-64-64V128zm320 0V384H576V128H320zM178.3 175.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1.1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1h73.6l8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4l-64-144zM160 233.2 179 276H141l19-42.8zM448 164c11 0 20 9 20 20v4h44 16c11 0 20 9 20 20s-9 20-20 20h-2l-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4.9.6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9L467 333.8c-4.5-2.7-8.8-5.5-13.1-8.5-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8L410 286.1c-7.8-7.8-7.8-20.5.0-28.3s20.5-7.8 28.3.0l14.6 14.6.5.5c12.4-13.1 22.5-28.3 29.8-45H448 376c-11 0-20-9-20-20s9-20 20-20h52v-4c0-11 9-20 20-20z"/></svg></span>
</span><span class="text-sm font-medium bf-icon-color-hover" title="Clean Package Design in Go: Single Responsibility and Package Cohesion">EN</span></button><ul class=menuhide><li class="rounded-xl backdrop-blur shadow-2xl p-2 flex flex-col gap-1"><a href=/posts/the-single-responsibility-principle/ class="flex items-center bf-icon-color-hover px-3 py-1"><span class="text-sm font-sm" title="Clean Package Design in Go: Single Responsibility and Package Cohesion">EN
</span></a><a href=/it/posts/the-single-responsibility-principle/ class="flex items-center bf-icon-color-hover px-3 py-1"><span class="text-sm font-sm" title="Design di package pulito in Go: Singola responsabilità e coesione">IT</span></a></li></ul></div><button id=search-button aria-label=Search class="text-base bf-icon-color-hover" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button></nav></div><div class="flex md:hidden"><div class="flex items-center h-14 gap-4"><button id=search-button-mobile aria-label=Search class="flex items-center justify-center bf-icon-color-hover" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<input type=checkbox id=mobile-menu-toggle autocomplete=off class="hidden peer">
<label for=mobile-menu-toggle class="flex items-center justify-center cursor-pointer bf-icon-color-hover"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></label><div role=dialog aria-modal=true style=scrollbar-gutter:stable class="fixed inset-0 z-50 invisible overflow-y-auto px-6 py-20 opacity-0 transition-[opacity,visibility] duration-300 peer-checked:visible peer-checked:opacity-100 bg-neutral-50/97 dark:bg-neutral-900/99
bf-scrollbar"><label for=mobile-menu-toggle class="fixed end-8 top-5 flex items-center justify-center z-50 h-12 w-12 cursor-pointer select-none rounded-full bf-icon-color-hover border bf-border-color bf-border-color-hover bg-neutral-50 dark:bg-neutral-900"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></label><nav class="mx-auto max-w-md space-y-6"><div class=px-2><a href=/posts/ aria-label=Blog class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=Posts class="text-2xl font-bold tracking-tight">Blog</span></a></div><div class=px-2><a href=/about/ aria-label=About class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=About class="text-2xl font-bold tracking-tight">About</span></a></div><div class=px-2><a href=/coaching/ aria-label=Coaching class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=Coaching class="text-2xl font-bold tracking-tight">Coaching</span></a></div><div class=px-2><a href=https://github.com/manuelfedele aria-label=github target=_blank class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span class="flex items-center justify-center h-8 w-8 text-2xl"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span><span title class="text-2xl font-bold tracking-tight"></span></a></div><div class="flex flex-wrap items-center [&_span]:text-2xl [&_.translation_button_.icon]:text-4xl! [&_.translation_button_span]:text-base! [&_.translation_.menuhide_span]:text-sm! gap-x-6 ps-2 mt-8 pt-8 border-t bf-border-color"><div class="translation nested-menu"><button class="cursor-pointer flex items-center">
<span class=me-1><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M0 128C0 92.7 28.7 64 64 64H256h48 16H576c35.3.0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H320 304 256 64c-35.3.0-64-28.7-64-64V128zm320 0V384H576V128H320zM178.3 175.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1.1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1h73.6l8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4l-64-144zM160 233.2 179 276H141l19-42.8zM448 164c11 0 20 9 20 20v4h44 16c11 0 20 9 20 20s-9 20-20 20h-2l-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4.9.6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9L467 333.8c-4.5-2.7-8.8-5.5-13.1-8.5-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8L410 286.1c-7.8-7.8-7.8-20.5.0-28.3s20.5-7.8 28.3.0l14.6 14.6.5.5c12.4-13.1 22.5-28.3 29.8-45H448 376c-11 0-20-9-20-20s9-20 20-20h52v-4c0-11 9-20 20-20z"/></svg></span>
</span><span class="text-sm font-medium bf-icon-color-hover" title="Clean Package Design in Go: Single Responsibility and Package Cohesion">EN</span></button><ul class=menuhide><li class="rounded-xl backdrop-blur shadow-2xl p-2 flex flex-col gap-1"><a href=/posts/the-single-responsibility-principle/ class="flex items-center bf-icon-color-hover px-3 py-1"><span class="text-sm font-sm" title="Clean Package Design in Go: Single Responsibility and Package Cohesion">EN
</span></a><a href=/it/posts/the-single-responsibility-principle/ class="flex items-center bf-icon-color-hover px-3 py-1"><span class="text-sm font-sm" title="Design di package pulito in Go: Singola responsabilità e coesione">IT</span></a></li></ul></div></div></nav></div></div></div></div></div><script>(function(){var t,n,e=document.querySelector(".main-menu");if(!e)return;t=window.location.pathname,n=e.querySelectorAll('a[href="'+t+'"]'),n.forEach(function(e){var t=e.querySelectorAll("span");t.forEach(function(e){e.classList.add("active")})})})()</script></div></div><script type=text/javascript src=/js/background-blur.min.00a57c73ea12f2cab2980c3c3d649e89f6d82f190f74bbe2b67f2f5e39ab7d032ece47086400ca05396758aace13299da49aca43ea643d2625e62c506267a169.js integrity="sha512-AKV8c+oS8sqymAw8PWSeifbYLxkPdLvitn8vXjmrfQMuzkcIZADKBTlnWKrOEymdpJrKQ+pkPSYl5ixQYmehaQ==" data-blur-id=menu-blur></script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"><img id=background-image src="https://images.unsplash.com/photo-1617791160505-6f00504e3519?w=1200&amp;q=85" role=presentation loading=eager decoding=async fetchpriority=high class="absolute inset-0 w-full h-full object-cover"><div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div><div class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-xl bg-neutral-100/75 dark:bg-neutral-800/60"></div><script type=text/javascript src=/js/background-blur.min.00a57c73ea12f2cab2980c3c3d649e89f6d82f190f74bbe2b67f2f5e39ab7d032ece47086400ca05396758aace13299da49aca43ea643d2625e62c506267a169.js integrity="sha512-AKV8c+oS8sqymAw8PWSeifbYLxkPdLvitn8vXjmrfQMuzkcIZADKBTlnWKrOEymdpJrKQ+pkPSYl5ixQYmehaQ==" data-blur-id=background-blur data-image-id=background-image data-image-url="https://images.unsplash.com/photo-1617791160505-6f00504e3519?w=1200&amp;q=85"></script><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Clean Package Design in Go: Single Responsibility and Package Cohesion</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2023-03-21T15:10:03+01:00>21 March 2023</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">8 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/tags/golang/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Golang
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/design-patterns/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Design Patterns
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/architecture/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Architecture</span></span></a></div></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ms-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs"><div class="toc ps-5 print:hidden lg:sticky lg:top-[140px]"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain bf-scrollbar rounded-lg -ms-5 ps-5 pe-2 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#the-srp-violation-the-god-service>The SRP Violation: The God Service</a></li><li><a href=#the-correct-split-repository-notification-orchestrator>The Correct Split: Repository, Notification, Orchestrator</a></li><li><a href=#package-cohesion-what-goes-where>Package Cohesion: What Goes Where</a></li><li><a href=#the-exported-surface-rule>The Exported Surface Rule</a></li><li><a href=#when-srp-becomes-over-engineering>When SRP Becomes Over-Engineering</a></li><li><a href=#the-real-go-srp-heuristic-one-reason-to-change>The Real Go SRP Heuristic: One Reason to Change</a></li><li><a href=#interface-based-dependency-injection-as-the-enabler>Interface-Based Dependency Injection as the Enabler</a></li><li><a href=#common-mistakes>Common Mistakes</a></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#the-srp-violation-the-god-service>The SRP Violation: The God Service</a></li><li><a href=#the-correct-split-repository-notification-orchestrator>The Correct Split: Repository, Notification, Orchestrator</a></li><li><a href=#package-cohesion-what-goes-where>Package Cohesion: What Goes Where</a></li><li><a href=#the-exported-surface-rule>The Exported Surface Rule</a></li><li><a href=#when-srp-becomes-over-engineering>When SRP Becomes Over-Engineering</a></li><li><a href=#the-real-go-srp-heuristic-one-reason-to-change>The Real Go SRP Heuristic: One Reason to Change</a></li><li><a href=#interface-based-dependency-injection-as-the-enabler>Interface-Based Dependency Injection as the Enabler</a></li><li><a href=#common-mistakes>Common Mistakes</a></li></ul></nav></div></details><script>(function(){"use strict";const s=.33,o="#TableOfContents",i=".anchor",a='a[href^="#"]',r="li ul",c="active";let t=!1;function l(e,n){const o=window.scrollY+window.innerHeight*n,i=[...document.querySelectorAll('#TableOfContents a[href^="#"]')],s=new Set(i.map(e=>e.getAttribute("href").substring(1)));if(t)for(let t=0;t<e.length;t++){const n=e[t];if(!s.has(n.id))continue;const o=n.getBoundingClientRect().top+window.scrollY;if(Math.abs(window.scrollY-o)<100)return n.id}for(let t=e.length-1;t>=0;t--){const n=e[t].getBoundingClientRect().top+window.scrollY;if(n<=o&&s.has(e[t].id))return e[t].id}return e.find(e=>s.has(e.id))?.id||""}function e({toc:e,anchors:t,links:n,scrollOffset:s,collapseInactive:o}){const i=l(t,s);if(!i)return;if(n.forEach(e=>{const t=e.getAttribute("href")===`#${i}`;if(e.classList.toggle(c,t),o){const n=e.closest("li")?.querySelector("ul");n&&(n.style.display=t?"":"none")}}),o){const n=e.querySelector(`a[href="#${CSS.escape(i)}"]`);let t=n;for(;t&&t!==e;)t.tagName==="UL"&&(t.style.display=""),t.tagName==="LI"&&t.querySelector("ul")?.style.setProperty("display",""),t=t.parentElement}}function n(){const n=document.querySelector(o);if(!n)return;const l=!0,u=[...document.querySelectorAll(i)],d=[...n.querySelectorAll(a)];l&&n.querySelectorAll(r).forEach(e=>e.style.display="none"),d.forEach(e=>{e.addEventListener("click",()=>{t=!0})});const c={toc:n,anchors:u,links:d,scrollOffset:s,collapseInactive:l};window.addEventListener("scroll",()=>e(c),{passive:!0}),window.addEventListener("hashchange",()=>e(c),{passive:!0}),e(c)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",n):n()})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><div class="lead text-neutral-500 dark:text-neutral-400 !mb-9 text-xl">SRP in Go is about package boundaries and exported surfaces, not just splitting methods into files. When a package has one reason to change, you can test it in isolation, swap implementations behind an interface, and reason about its behavior without reading the rest of the codebase.</div><p>The Single Responsibility Principle (SRP) is often stated as &ldquo;a class should have one reason to change.&rdquo; In Go, there are no classes, but the principle applies with equal force to packages and to the exported types within them. Getting it wrong produces a God service: one package that knows about the database, email, HTTP, and business logic all at once. Getting it right produces a codebase where changing the email provider does not require touching the database layer.</p><h2 class="relative group">The SRP Violation: The God Service<div id=the-srp-violation-the-god-service class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#the-srp-violation-the-god-service aria-label=Anchor>#</a></span></h2><p>Here is a realistic example of what a violated SRP looks like in Go. This is a <code>UserService</code> that has accumulated too many responsibilities:</p><div class=highlight-wrapper><div class=codeblock-title>user/service.go (BEFORE -- violation)</div><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>package</span> user
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>import</span> <span style=color:#eceff4>(</span>
</span></span><span style=display:flex><span>    <span style=color:#a3be8c>&#34;database/sql&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a3be8c>&#34;encoding/json&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a3be8c>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a3be8c>&#34;net/http&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a3be8c>&#34;net/smtp&#34;</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>type</span> UserService <span style=color:#81a1c1;font-weight:700>struct</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    db <span style=color:#81a1c1>*</span>sql<span style=color:#eceff4>.</span>DB
</span></span><span style=display:flex><span><span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic>// CreateUser inserts a user AND sends a welcome email AND logs over HTTP.</span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic>// Three reasons to change: DB schema, email provider, logging endpoint.</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>func</span> <span style=color:#eceff4>(</span>s <span style=color:#81a1c1>*</span>UserService<span style=color:#eceff4>)</span> <span style=color:#88c0d0>CreateUser</span><span style=color:#eceff4>(</span>username<span style=color:#eceff4>,</span> email <span style=color:#81a1c1>string</span><span style=color:#eceff4>)</span> <span style=color:#81a1c1>error</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    _<span style=color:#eceff4>,</span> err <span style=color:#81a1c1>:=</span> s<span style=color:#eceff4>.</span>db<span style=color:#eceff4>.</span><span style=color:#88c0d0>Exec</span><span style=color:#eceff4>(</span>
</span></span><span style=display:flex><span>        <span style=color:#a3be8c>&#34;INSERT INTO users (username, email) VALUES ($1, $2)&#34;</span><span style=color:#eceff4>,</span>
</span></span><span style=display:flex><span>        username<span style=color:#eceff4>,</span> email<span style=color:#eceff4>,</span>
</span></span><span style=display:flex><span>    <span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>    <span style=color:#81a1c1;font-weight:700>if</span> err <span style=color:#81a1c1>!=</span> <span style=color:#81a1c1;font-weight:700>nil</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>        <span style=color:#81a1c1;font-weight:700>return</span> fmt<span style=color:#eceff4>.</span><span style=color:#88c0d0>Errorf</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#34;insert user: %w&#34;</span><span style=color:#eceff4>,</span> err<span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>    <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#616e87;font-style:italic>// Responsibility 2: email</span>
</span></span><span style=display:flex><span>    auth <span style=color:#81a1c1>:=</span> smtp<span style=color:#eceff4>.</span><span style=color:#88c0d0>PlainAuth</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#34;&#34;</span><span style=color:#eceff4>,</span> <span style=color:#a3be8c>&#34;robot@example.com&#34;</span><span style=color:#eceff4>,</span> <span style=color:#a3be8c>&#34;secret&#34;</span><span style=color:#eceff4>,</span> <span style=color:#a3be8c>&#34;smtp.example.com&#34;</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>    msg <span style=color:#81a1c1>:=</span> <span style=color:#eceff4>[]</span><span style=color:#81a1c1>byte</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#34;Subject: Welcome\r\n\r\nWelcome to the platform, &#34;</span> <span style=color:#81a1c1>+</span> username<span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>    <span style=color:#81a1c1;font-weight:700>if</span> err <span style=color:#81a1c1>:=</span> smtp<span style=color:#eceff4>.</span><span style=color:#88c0d0>SendMail</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#34;smtp.example.com:587&#34;</span><span style=color:#eceff4>,</span> auth<span style=color:#eceff4>,</span> <span style=color:#a3be8c>&#34;robot@example.com&#34;</span><span style=color:#eceff4>,</span>
</span></span><span style=display:flex><span>        <span style=color:#eceff4>[]</span><span style=color:#81a1c1>string</span><span style=color:#eceff4>{</span>email<span style=color:#eceff4>},</span> msg<span style=color:#eceff4>);</span> err <span style=color:#81a1c1>!=</span> <span style=color:#81a1c1;font-weight:700>nil</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>        <span style=color:#81a1c1;font-weight:700>return</span> fmt<span style=color:#eceff4>.</span><span style=color:#88c0d0>Errorf</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#34;send welcome email: %w&#34;</span><span style=color:#eceff4>,</span> err<span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>    <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#616e87;font-style:italic>// Responsibility 3: audit log over HTTP</span>
</span></span><span style=display:flex><span>    payload<span style=color:#eceff4>,</span> _ <span style=color:#81a1c1>:=</span> json<span style=color:#eceff4>.</span><span style=color:#88c0d0>Marshal</span><span style=color:#eceff4>(</span><span style=color:#81a1c1;font-weight:700>map</span><span style=color:#eceff4>[</span><span style=color:#81a1c1>string</span><span style=color:#eceff4>]</span><span style=color:#81a1c1>string</span><span style=color:#eceff4>{</span><span style=color:#a3be8c>&#34;event&#34;</span><span style=color:#eceff4>:</span> <span style=color:#a3be8c>&#34;user.created&#34;</span><span style=color:#eceff4>,</span> <span style=color:#a3be8c>&#34;email&#34;</span><span style=color:#eceff4>:</span> email<span style=color:#eceff4>})</span>
</span></span><span style=display:flex><span>    _<span style=color:#eceff4>,</span> _ <span style=color:#eceff4>=</span> http<span style=color:#eceff4>.</span><span style=color:#88c0d0>Post</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#34;https://audit.internal/events&#34;</span><span style=color:#eceff4>,</span> <span style=color:#a3be8c>&#34;application/json&#34;</span><span style=color:#eceff4>,</span>
</span></span><span style=display:flex><span>        bytes<span style=color:#eceff4>.</span><span style=color:#88c0d0>NewReader</span><span style=color:#eceff4>(</span>payload<span style=color:#eceff4>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#81a1c1;font-weight:700>return</span> <span style=color:#81a1c1;font-weight:700>nil</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>}</span></span></span></code></pre></div></div><p>This function has three distinct reasons to change:</p><ol><li>The database schema changes (column names, table structure)</li><li>The email provider changes (SMTP to SendGrid, or email template changes)</li><li>The audit log destination or format changes</li></ol><p>Testing <code>CreateUser</code> requires a real database, a real SMTP server, and a real HTTP endpoint. A change to the audit log URL requires touching user creation code.</p><h2 class="relative group">The Correct Split: Repository, Notification, Orchestrator<div id=the-correct-split-repository-notification-orchestrator class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#the-correct-split-repository-notification-orchestrator aria-label=Anchor>#</a></span></h2><p>The fix is to extract each responsibility into its own type, each in its own package, and wire them together in a thin orchestration layer.</p><div class=highlight-wrapper><div class=codeblock-title>storage/user_repository.go</div><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>package</span> storage
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>import</span> <span style=color:#eceff4>(</span>
</span></span><span style=display:flex><span>    <span style=color:#a3be8c>&#34;context&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a3be8c>&#34;database/sql&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a3be8c>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>type</span> User <span style=color:#81a1c1;font-weight:700>struct</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    ID       <span style=color:#81a1c1>int64</span>
</span></span><span style=display:flex><span>    Username <span style=color:#81a1c1>string</span>
</span></span><span style=display:flex><span>    Email    <span style=color:#81a1c1>string</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>type</span> UserRepository <span style=color:#81a1c1;font-weight:700>struct</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    db <span style=color:#81a1c1>*</span>sql<span style=color:#eceff4>.</span>DB
</span></span><span style=display:flex><span><span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>func</span> <span style=color:#88c0d0>NewUserRepository</span><span style=color:#eceff4>(</span>db <span style=color:#81a1c1>*</span>sql<span style=color:#eceff4>.</span>DB<span style=color:#eceff4>)</span> <span style=color:#81a1c1>*</span>UserRepository <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    <span style=color:#81a1c1;font-weight:700>return</span> <span style=color:#81a1c1>&amp;</span>UserRepository<span style=color:#eceff4>{</span>db<span style=color:#eceff4>:</span> db<span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>func</span> <span style=color:#eceff4>(</span>r <span style=color:#81a1c1>*</span>UserRepository<span style=color:#eceff4>)</span> <span style=color:#88c0d0>Create</span><span style=color:#eceff4>(</span>ctx context<span style=color:#eceff4>.</span>Context<span style=color:#eceff4>,</span> username<span style=color:#eceff4>,</span> email <span style=color:#81a1c1>string</span><span style=color:#eceff4>)</span> <span style=color:#eceff4>(</span><span style=color:#81a1c1>*</span>User<span style=color:#eceff4>,</span> <span style=color:#81a1c1>error</span><span style=color:#eceff4>)</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    <span style=color:#81a1c1;font-weight:700>var</span> id <span style=color:#81a1c1>int64</span>
</span></span><span style=display:flex><span>    err <span style=color:#81a1c1>:=</span> r<span style=color:#eceff4>.</span>db<span style=color:#eceff4>.</span><span style=color:#88c0d0>QueryRowContext</span><span style=color:#eceff4>(</span>ctx<span style=color:#eceff4>,</span>
</span></span><span style=display:flex><span>        <span style=color:#a3be8c>&#34;INSERT INTO users (username, email) VALUES ($1, $2) RETURNING id&#34;</span><span style=color:#eceff4>,</span>
</span></span><span style=display:flex><span>        username<span style=color:#eceff4>,</span> email<span style=color:#eceff4>,</span>
</span></span><span style=display:flex><span>    <span style=color:#eceff4>).</span><span style=color:#88c0d0>Scan</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>&amp;</span>id<span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>    <span style=color:#81a1c1;font-weight:700>if</span> err <span style=color:#81a1c1>!=</span> <span style=color:#81a1c1;font-weight:700>nil</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>        <span style=color:#81a1c1;font-weight:700>return</span> <span style=color:#81a1c1;font-weight:700>nil</span><span style=color:#eceff4>,</span> fmt<span style=color:#eceff4>.</span><span style=color:#88c0d0>Errorf</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#34;create user: %w&#34;</span><span style=color:#eceff4>,</span> err<span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>    <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>    <span style=color:#81a1c1;font-weight:700>return</span> <span style=color:#81a1c1>&amp;</span>User<span style=color:#eceff4>{</span>ID<span style=color:#eceff4>:</span> id<span style=color:#eceff4>,</span> Username<span style=color:#eceff4>:</span> username<span style=color:#eceff4>,</span> Email<span style=color:#eceff4>:</span> email<span style=color:#eceff4>},</span> <span style=color:#81a1c1;font-weight:700>nil</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>}</span></span></span></code></pre></div></div><div class=highlight-wrapper><div class=codeblock-title>notification/service.go</div><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>package</span> notification
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>import</span> <span style=color:#eceff4>(</span>
</span></span><span style=display:flex><span>    <span style=color:#a3be8c>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a3be8c>&#34;net/smtp&#34;</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>type</span> SMTPConfig <span style=color:#81a1c1;font-weight:700>struct</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    Host     <span style=color:#81a1c1>string</span>
</span></span><span style=display:flex><span>    Port     <span style=color:#81a1c1>int</span>
</span></span><span style=display:flex><span>    Username <span style=color:#81a1c1>string</span>
</span></span><span style=display:flex><span>    Password <span style=color:#81a1c1>string</span>
</span></span><span style=display:flex><span>    From     <span style=color:#81a1c1>string</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>type</span> Service <span style=color:#81a1c1;font-weight:700>struct</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    cfg SMTPConfig
</span></span><span style=display:flex><span><span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>func</span> <span style=color:#88c0d0>NewService</span><span style=color:#eceff4>(</span>cfg SMTPConfig<span style=color:#eceff4>)</span> <span style=color:#81a1c1>*</span>Service <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    <span style=color:#81a1c1;font-weight:700>return</span> <span style=color:#81a1c1>&amp;</span>Service<span style=color:#eceff4>{</span>cfg<span style=color:#eceff4>:</span> cfg<span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>func</span> <span style=color:#eceff4>(</span>s <span style=color:#81a1c1>*</span>Service<span style=color:#eceff4>)</span> <span style=color:#88c0d0>SendWelcome</span><span style=color:#eceff4>(</span>toEmail<span style=color:#eceff4>,</span> username <span style=color:#81a1c1>string</span><span style=color:#eceff4>)</span> <span style=color:#81a1c1>error</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    addr <span style=color:#81a1c1>:=</span> fmt<span style=color:#eceff4>.</span><span style=color:#88c0d0>Sprintf</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#34;%s:%d&#34;</span><span style=color:#eceff4>,</span> s<span style=color:#eceff4>.</span>cfg<span style=color:#eceff4>.</span>Host<span style=color:#eceff4>,</span> s<span style=color:#eceff4>.</span>cfg<span style=color:#eceff4>.</span>Port<span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>    auth <span style=color:#81a1c1>:=</span> smtp<span style=color:#eceff4>.</span><span style=color:#88c0d0>PlainAuth</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#34;&#34;</span><span style=color:#eceff4>,</span> s<span style=color:#eceff4>.</span>cfg<span style=color:#eceff4>.</span>Username<span style=color:#eceff4>,</span> s<span style=color:#eceff4>.</span>cfg<span style=color:#eceff4>.</span>Password<span style=color:#eceff4>,</span> s<span style=color:#eceff4>.</span>cfg<span style=color:#eceff4>.</span>Host<span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>    msg <span style=color:#81a1c1>:=</span> <span style=color:#eceff4>[]</span><span style=color:#81a1c1>byte</span><span style=color:#eceff4>(</span>fmt<span style=color:#eceff4>.</span><span style=color:#88c0d0>Sprintf</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#34;Subject: Welcome\r\n\r\nWelcome, %s!&#34;</span><span style=color:#eceff4>,</span> username<span style=color:#eceff4>))</span>
</span></span><span style=display:flex><span>    <span style=color:#81a1c1;font-weight:700>if</span> err <span style=color:#81a1c1>:=</span> smtp<span style=color:#eceff4>.</span><span style=color:#88c0d0>SendMail</span><span style=color:#eceff4>(</span>addr<span style=color:#eceff4>,</span> auth<span style=color:#eceff4>,</span> s<span style=color:#eceff4>.</span>cfg<span style=color:#eceff4>.</span>From<span style=color:#eceff4>,</span> <span style=color:#eceff4>[]</span><span style=color:#81a1c1>string</span><span style=color:#eceff4>{</span>toEmail<span style=color:#eceff4>},</span> msg<span style=color:#eceff4>);</span> err <span style=color:#81a1c1>!=</span> <span style=color:#81a1c1;font-weight:700>nil</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>        <span style=color:#81a1c1;font-weight:700>return</span> fmt<span style=color:#eceff4>.</span><span style=color:#88c0d0>Errorf</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#34;send welcome email to %s: %w&#34;</span><span style=color:#eceff4>,</span> toEmail<span style=color:#eceff4>,</span> err<span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>    <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>    <span style=color:#81a1c1;font-weight:700>return</span> <span style=color:#81a1c1;font-weight:700>nil</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>}</span></span></span></code></pre></div></div><div class=highlight-wrapper><div class=codeblock-title>user/service.go (AFTER -- orchestration only)</div><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>package</span> user
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>import</span> <span style=color:#eceff4>(</span>
</span></span><span style=display:flex><span>    <span style=color:#a3be8c>&#34;context&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a3be8c>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a3be8c>&#34;example.com/app/notification&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a3be8c>&#34;example.com/app/storage&#34;</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic>// Notifier is the interface this package requires. It does not care about SMTP.</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>type</span> Notifier <span style=color:#81a1c1;font-weight:700>interface</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    <span style=color:#88c0d0>SendWelcome</span><span style=color:#eceff4>(</span>email<span style=color:#eceff4>,</span> username <span style=color:#81a1c1>string</span><span style=color:#eceff4>)</span> <span style=color:#81a1c1>error</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic>// Storer is the interface this package requires. It does not care about SQL.</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>type</span> Storer <span style=color:#81a1c1;font-weight:700>interface</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    <span style=color:#88c0d0>Create</span><span style=color:#eceff4>(</span>ctx context<span style=color:#eceff4>.</span>Context<span style=color:#eceff4>,</span> username<span style=color:#eceff4>,</span> email <span style=color:#81a1c1>string</span><span style=color:#eceff4>)</span> <span style=color:#eceff4>(</span><span style=color:#81a1c1>*</span>storage<span style=color:#eceff4>.</span>User<span style=color:#eceff4>,</span> <span style=color:#81a1c1>error</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>type</span> Service <span style=color:#81a1c1;font-weight:700>struct</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    store    Storer
</span></span><span style=display:flex><span>    notifier Notifier
</span></span><span style=display:flex><span><span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>func</span> <span style=color:#88c0d0>NewService</span><span style=color:#eceff4>(</span>store Storer<span style=color:#eceff4>,</span> notifier Notifier<span style=color:#eceff4>)</span> <span style=color:#81a1c1>*</span>Service <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    <span style=color:#81a1c1;font-weight:700>return</span> <span style=color:#81a1c1>&amp;</span>Service<span style=color:#eceff4>{</span>store<span style=color:#eceff4>:</span> store<span style=color:#eceff4>,</span> notifier<span style=color:#eceff4>:</span> notifier<span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>func</span> <span style=color:#eceff4>(</span>s <span style=color:#81a1c1>*</span>Service<span style=color:#eceff4>)</span> <span style=color:#88c0d0>Register</span><span style=color:#eceff4>(</span>ctx context<span style=color:#eceff4>.</span>Context<span style=color:#eceff4>,</span> username<span style=color:#eceff4>,</span> email <span style=color:#81a1c1>string</span><span style=color:#eceff4>)</span> <span style=color:#81a1c1>error</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    user<span style=color:#eceff4>,</span> err <span style=color:#81a1c1>:=</span> s<span style=color:#eceff4>.</span>store<span style=color:#eceff4>.</span><span style=color:#88c0d0>Create</span><span style=color:#eceff4>(</span>ctx<span style=color:#eceff4>,</span> username<span style=color:#eceff4>,</span> email<span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>    <span style=color:#81a1c1;font-weight:700>if</span> err <span style=color:#81a1c1>!=</span> <span style=color:#81a1c1;font-weight:700>nil</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>        <span style=color:#81a1c1;font-weight:700>return</span> fmt<span style=color:#eceff4>.</span><span style=color:#88c0d0>Errorf</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#34;register: %w&#34;</span><span style=color:#eceff4>,</span> err<span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>    <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>    <span style=color:#81a1c1;font-weight:700>if</span> err <span style=color:#81a1c1>:=</span> s<span style=color:#eceff4>.</span>notifier<span style=color:#eceff4>.</span><span style=color:#88c0d0>SendWelcome</span><span style=color:#eceff4>(</span>user<span style=color:#eceff4>.</span>Email<span style=color:#eceff4>,</span> user<span style=color:#eceff4>.</span>Username<span style=color:#eceff4>);</span> err <span style=color:#81a1c1>!=</span> <span style=color:#81a1c1;font-weight:700>nil</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>        <span style=color:#616e87;font-style:italic>// Non-fatal: user is created, notification is best-effort.</span>
</span></span><span style=display:flex><span>        <span style=color:#616e87;font-style:italic>// Log the error but do not roll back.</span>
</span></span><span style=display:flex><span>        <span style=color:#81a1c1;font-weight:700>return</span> fmt<span style=color:#eceff4>.</span><span style=color:#88c0d0>Errorf</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#34;register: send welcome: %w&#34;</span><span style=color:#eceff4>,</span> err<span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>    <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>    <span style=color:#81a1c1;font-weight:700>return</span> <span style=color:#81a1c1;font-weight:700>nil</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>}</span></span></span></code></pre></div></div><p>Now <code>UserService</code> has one reason to change: the registration business logic. Changing SMTP is a <code>notification</code> problem. Changing the database schema is a <code>storage</code> problem.</p><h2 class="relative group">Package Cohesion: What Goes Where<div id=package-cohesion-what-goes-where class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#package-cohesion-what-goes-where aria-label=Anchor>#</a></span></h2><pre class="not-prose mermaid">
flowchart LR
    subgraph Before ["Before (God Service)"]
        GS[user.UserService\nDB + Email + HTTP + Logic]
    end

    subgraph After ["After (Decomposed)"]
        US[user.Service\norchestration only]
        UR[storage.UserRepository\nSQL only]
        NS[notification.Service\nSMTP only]
        US -->|Storer interface| UR
        US -->|Notifier interface| NS
    end
</pre><p>The decomposed structure gives you:</p><ul><li><strong><code>storage</code></strong>: everything that talks to the database. One reason to change: the persistence mechanism.</li><li><strong><code>notification</code></strong>: everything that sends messages to users. One reason to change: the notification channel or template.</li><li><strong><code>user</code></strong>: orchestration of domain operations. One reason to change: the registration (or other user lifecycle) business rules.</li></ul><h2 class="relative group">The Exported Surface Rule<div id=the-exported-surface-rule class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#the-exported-surface-rule aria-label=Anchor>#</a></span></h2><p>Only export what consumers need. If a type is an implementation detail, keep it unexported.</p><div class=highlight-wrapper><div class=codeblock-title>storage/user_repository.go (exported surface)</div><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#616e87;font-style:italic>// Exported: consumers need to call NewUserRepository and use UserRepository.</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>type</span> UserRepository <span style=color:#81a1c1;font-weight:700>struct</span> <span style=color:#eceff4>{</span> <span style=color:#616e87;font-style:italic>/* ... */</span> <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>func</span> <span style=color:#88c0d0>NewUserRepository</span><span style=color:#eceff4>(</span>db <span style=color:#81a1c1>*</span>sql<span style=color:#eceff4>.</span>DB<span style=color:#eceff4>)</span> <span style=color:#81a1c1>*</span>UserRepository <span style=color:#eceff4>{</span> <span style=color:#616e87;font-style:italic>/* ... */</span> <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>func</span> <span style=color:#eceff4>(</span>r <span style=color:#81a1c1>*</span>UserRepository<span style=color:#eceff4>)</span> <span style=color:#88c0d0>Create</span><span style=color:#eceff4>(</span>ctx context<span style=color:#eceff4>.</span>Context<span style=color:#eceff4>,</span> username<span style=color:#eceff4>,</span> email <span style=color:#81a1c1>string</span><span style=color:#eceff4>)</span> <span style=color:#eceff4>(</span><span style=color:#81a1c1>*</span>User<span style=color:#eceff4>,</span> <span style=color:#81a1c1>error</span><span style=color:#eceff4>)</span> <span style=color:#eceff4>{</span> <span style=color:#616e87;font-style:italic>/* ... */</span> <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic>// Unexported: consumers do not need to know how the query is built.</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>func</span> <span style=color:#eceff4>(</span>r <span style=color:#81a1c1>*</span>UserRepository<span style=color:#eceff4>)</span> <span style=color:#88c0d0>buildInsertQuery</span><span style=color:#eceff4>()</span> <span style=color:#81a1c1>string</span> <span style=color:#eceff4>{</span> <span style=color:#616e87;font-style:italic>/* ... */</span> <span style=color:#eceff4>}</span></span></span></code></pre></div></div><p>If a consumer imports <code>storage</code> and needs to mock it, they implement the <code>Storer</code> interface from the <code>user</code> package &ndash; they never need to depend on the unexported internals of <code>storage</code>.</p><h2 class="relative group">When SRP Becomes Over-Engineering<div id=when-srp-becomes-over-engineering class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#when-srp-becomes-over-engineering aria-label=Anchor>#</a></span></h2><p>Not every 20-line struct needs its own package. SRP is a tool for managing change, not a mandate for maximum file count.</p><div class="admonition relative overflow-hidden rounded-lg border-l-4 my-3 px-4 py-3 shadow-sm" data-type=note><div class="flex items-center gap-2 font-semibold text-inherit"><div class="flex shrink-0 h-5 w-5 items-center justify-center text-lg"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6.0.0 114.6.0 256s114.6 256 256 256 256-114.6 256-256S397.4.0 256 0zm0 128c17.67.0 32 14.33 32 32 0 17.67-14.33 32-32 32s-32-14.3-32-32 14.3-32 32-32zm40 256h-80c-13.2.0-24-10.7-24-24s10.75-24 24-24h16v-64h-8c-13.25.0-24-10.75-24-24s10.8-24 24-24h32c13.25.0 24 10.75 24 24v88h16c13.25.0 24 10.75 24 24s-10.7 24-24 24z"/></svg></span></div><div class=grow>Note</div></div><div class="admonition-content mt-3 text-base leading-relaxed text-inherit"><p>If a function legitimately does two things that always change together, splitting them is ceremony, not engineering. The heuristic is: &ldquo;would a change to this responsibility require me to open files in another package?&rdquo; If yes, split. If not, keep them together.</p></div></div><p>A <code>config</code> package that reads environment variables and builds database connection strings is fine. The fact that it touches two concerns (env vars and DB config) is acceptable because they change together (when you change the DB, you change the env var names too).</p><h2 class="relative group">The Real Go SRP Heuristic: One Reason to Change<div id=the-real-go-srp-heuristic-one-reason-to-change class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#the-real-go-srp-heuristic-one-reason-to-change aria-label=Anchor>#</a></span></h2><p>Go standard library packages are a good reference. <code>net/http</code> handles HTTP. <code>database/sql</code> handles SQL. <code>encoding/json</code> handles JSON encoding. Each one has a clearly scoped surface and a single axis of change.</p><p>Apply the same lens to your own packages: if you can describe a package in one sentence without the word &ldquo;and&rdquo;, the SRP is probably satisfied.</p><div class="admonition relative overflow-hidden rounded-lg border-l-4 my-3 px-4 py-3 shadow-sm" data-type=tip><div class="flex items-center gap-2 font-semibold text-inherit"><div class="flex shrink-0 h-5 w-5 items-center justify-center text-lg"><span class="relative block icon"><svg viewBox="0 0 384 512"><path fill="currentColor" d="M112.1 454.3c0 6.297 1.816 12.44 5.284 17.69l17.14 25.69c5.25 7.875 17.17 14.28 26.64 14.28h61.67c9.438.0 21.36-6.401 26.61-14.28l17.08-25.68c2.938-4.438 5.348-12.37 5.348-17.7L272 415.1H112L112.1 454.3zM191.4.0132C89.44.3257 16 82.97 16 175.1c0 44.38 16.44 84.84 43.56 115.8 16.53 18.84 42.34 58.23 52.22 91.45.0313.25.0938.5166.125.7823h160.2c.0313-.2656.0938-.5166.125-.7823 9.875-33.22 35.69-72.61 52.22-91.45C351.6 260.8 368 220.4 368 175.1 368 78.61 288.9-.2837 191.4.0132zM192 96.01c-44.13.0-80 35.89-80 79.1.0 9.69-7.2 16.89-16 16.89S80 184.8 80 176c0-61.76 50.25-111.1 112-111.1 8.844.0 16 7.159 16 16S200.8 96.01 192 96.01z"/></svg></span></div><div class=grow>Tip</div></div><div class="admonition-content mt-3 text-base leading-relaxed text-inherit"><p>The <code>utils</code> or <code>helpers</code> package is almost always an SRP violation waiting to happen. When you find yourself creating one, ask what the common thread is. If there is none, the functions belong in the packages that use them, not in a shared catch-all.</p></div></div><h2 class="relative group">Interface-Based Dependency Injection as the Enabler<div id=interface-based-dependency-injection-as-the-enabler class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#interface-based-dependency-injection-as-the-enabler aria-label=Anchor>#</a></span></h2><p>The mechanism that makes SRP practical in Go is interface-based dependency injection. Define the interface in the package that consumes it, not in the package that implements it.</p><div class=highlight-wrapper><div class=codeblock-title>user/service.go (interfaces at the consumer)</div><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#616e87;font-style:italic>// These interfaces live in the user package, not in storage or notification.</span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic>// The user package defines the behavior it needs; storage and notification</span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic>// implement it without knowing about the user package.</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>type</span> Storer <span style=color:#81a1c1;font-weight:700>interface</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    <span style=color:#88c0d0>Create</span><span style=color:#eceff4>(</span>ctx context<span style=color:#eceff4>.</span>Context<span style=color:#eceff4>,</span> username<span style=color:#eceff4>,</span> email <span style=color:#81a1c1>string</span><span style=color:#eceff4>)</span> <span style=color:#eceff4>(</span><span style=color:#81a1c1>*</span>storage<span style=color:#eceff4>.</span>User<span style=color:#eceff4>,</span> <span style=color:#81a1c1>error</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>type</span> Notifier <span style=color:#81a1c1;font-weight:700>interface</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    <span style=color:#88c0d0>SendWelcome</span><span style=color:#eceff4>(</span>email<span style=color:#eceff4>,</span> username <span style=color:#81a1c1>string</span><span style=color:#eceff4>)</span> <span style=color:#81a1c1>error</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>}</span></span></span></code></pre></div></div><p>This inversion means <code>storage</code> does not import <code>user</code>, so there are no circular dependencies. And in tests, you replace both with simple stubs:</p><div class=highlight-wrapper><div class=codeblock-title>user/service_test.go</div><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>package</span> user_test
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>import</span> <span style=color:#eceff4>(</span>
</span></span><span style=display:flex><span>    <span style=color:#a3be8c>&#34;context&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a3be8c>&#34;testing&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a3be8c>&#34;example.com/app/storage&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a3be8c>&#34;example.com/app/user&#34;</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>type</span> stubStorer <span style=color:#81a1c1;font-weight:700>struct</span><span style=color:#eceff4>{</span> user <span style=color:#81a1c1>*</span>storage<span style=color:#eceff4>.</span>User <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>func</span> <span style=color:#eceff4>(</span>s <span style=color:#81a1c1>*</span>stubStorer<span style=color:#eceff4>)</span> <span style=color:#88c0d0>Create</span><span style=color:#eceff4>(</span>_ context<span style=color:#eceff4>.</span>Context<span style=color:#eceff4>,</span> username<span style=color:#eceff4>,</span> email <span style=color:#81a1c1>string</span><span style=color:#eceff4>)</span> <span style=color:#eceff4>(</span><span style=color:#81a1c1>*</span>storage<span style=color:#eceff4>.</span>User<span style=color:#eceff4>,</span> <span style=color:#81a1c1>error</span><span style=color:#eceff4>)</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    <span style=color:#81a1c1;font-weight:700>return</span> <span style=color:#81a1c1>&amp;</span>storage<span style=color:#eceff4>.</span>User<span style=color:#eceff4>{</span>ID<span style=color:#eceff4>:</span> <span style=color:#b48ead>1</span><span style=color:#eceff4>,</span> Username<span style=color:#eceff4>:</span> username<span style=color:#eceff4>,</span> Email<span style=color:#eceff4>:</span> email<span style=color:#eceff4>},</span> <span style=color:#81a1c1;font-weight:700>nil</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>type</span> stubNotifier <span style=color:#81a1c1;font-weight:700>struct</span><span style=color:#eceff4>{</span> called <span style=color:#81a1c1>bool</span> <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>func</span> <span style=color:#eceff4>(</span>n <span style=color:#81a1c1>*</span>stubNotifier<span style=color:#eceff4>)</span> <span style=color:#88c0d0>SendWelcome</span><span style=color:#eceff4>(</span>_<span style=color:#eceff4>,</span> _ <span style=color:#81a1c1>string</span><span style=color:#eceff4>)</span> <span style=color:#81a1c1>error</span> <span style=color:#eceff4>{</span> n<span style=color:#eceff4>.</span>called <span style=color:#eceff4>=</span> <span style=color:#81a1c1;font-weight:700>true</span><span style=color:#eceff4>;</span> <span style=color:#81a1c1;font-weight:700>return</span> <span style=color:#81a1c1;font-weight:700>nil</span> <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#81a1c1;font-weight:700>func</span> <span style=color:#88c0d0>TestRegister_SendsWelcome</span><span style=color:#eceff4>(</span>t <span style=color:#81a1c1>*</span>testing<span style=color:#eceff4>.</span>T<span style=color:#eceff4>)</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    notifier <span style=color:#81a1c1>:=</span> <span style=color:#81a1c1>&amp;</span>stubNotifier<span style=color:#eceff4>{}</span>
</span></span><span style=display:flex><span>    svc <span style=color:#81a1c1>:=</span> user<span style=color:#eceff4>.</span><span style=color:#88c0d0>NewService</span><span style=color:#eceff4>(</span><span style=color:#81a1c1>&amp;</span>stubStorer<span style=color:#eceff4>{},</span> notifier<span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#81a1c1;font-weight:700>if</span> err <span style=color:#81a1c1>:=</span> svc<span style=color:#eceff4>.</span><span style=color:#88c0d0>Register</span><span style=color:#eceff4>(</span>context<span style=color:#eceff4>.</span><span style=color:#88c0d0>Background</span><span style=color:#eceff4>(),</span> <span style=color:#a3be8c>&#34;alice&#34;</span><span style=color:#eceff4>,</span> <span style=color:#a3be8c>&#34;alice@example.com&#34;</span><span style=color:#eceff4>);</span> err <span style=color:#81a1c1>!=</span> <span style=color:#81a1c1;font-weight:700>nil</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>        t<span style=color:#eceff4>.</span><span style=color:#88c0d0>Fatalf</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#34;unexpected error: %v&#34;</span><span style=color:#eceff4>,</span> err<span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>    <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>    <span style=color:#81a1c1;font-weight:700>if</span> <span style=color:#eceff4>!</span>notifier<span style=color:#eceff4>.</span>called <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>        t<span style=color:#eceff4>.</span><span style=color:#88c0d0>Fatal</span><span style=color:#eceff4>(</span><span style=color:#a3be8c>&#34;expected welcome notification to be sent&#34;</span><span style=color:#eceff4>)</span>
</span></span><span style=display:flex><span>    <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>}</span></span></span></code></pre></div></div><p>No database. No SMTP server. No HTTP calls. Pure unit test of the business logic.</p><h2 class="relative group">Common Mistakes<div id=common-mistakes class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#common-mistakes aria-label=Anchor>#</a></span></h2><div id=accordion-c327d8ba987e8fa35771426c3f61cd2c class="border border-neutral-200 dark:border-neutral-700 rounded-lg overflow-hidden" data-accordion=collapse data-accordion-separated=false><details class=border-none data-accordion-item open><summary class="flex w-full cursor-pointer items-center justify-between gap-4 px-4 py-3 text-left text-lg font-semibold text-neutral-900 dark:text-neutral-100"><span class="flex items-center gap-2"><span>God service anti-pattern</span>
</span><span><span class="relative block icon"><svg viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></summary><div class="px-4 pb-4 text-neutral-700 dark:text-neutral-300">A service struct with fields for a DB connection, an HTTP client, an SMTP client, and a Redis client is doing too much. Each dependency signals a responsibility. When you have four dependencies, you likely have four responsibilities that should be split across packages.</div></details><details class=border-none data-accordion-item><summary class="flex w-full cursor-pointer items-center justify-between gap-4 px-4 py-3 text-left text-lg font-semibold text-neutral-900 dark:text-neutral-100"><span class="flex items-center gap-2"><span>Package per struct</span>
</span><span><span class="relative block icon"><svg viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></summary><div class="px-4 pb-4 text-neutral-700 dark:text-neutral-300">Going too far in the other direction: one struct per package. This creates import chains, forces you to export everything, and eliminates the cohesion benefits of keeping related types together. The right unit is a set of related types that change together for the same reason.</div></details><details class=border-none data-accordion-item><summary class="flex w-full cursor-pointer items-center justify-between gap-4 px-4 py-3 text-left text-lg font-semibold text-neutral-900 dark:text-neutral-100"><span class="flex items-center gap-2"><span>Shared utils packages</span>
</span><span><span class="relative block icon"><svg viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></summary><div class="px-4 pb-4 text-neutral-700 dark:text-neutral-300"><code>utils</code>, <code>helpers</code>, <code>common</code>, and <code>shared</code> packages are magnets for unrelated code. When a function ends up in <code>utils</code>, it usually means it belongs in the package that uses it, or it is genuinely cross-cutting (like a retry helper) and deserves its own focused package like <code>retry</code> or <code>backoff</code>.</div></details><details class=border-none data-accordion-item><summary class="flex w-full cursor-pointer items-center justify-between gap-4 px-4 py-3 text-left text-lg font-semibold text-neutral-900 dark:text-neutral-100"><span class="flex items-center gap-2"><span>Circular imports from poor SRP</span>
</span><span><span class="relative block icon"><svg viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></summary><div class="px-4 pb-4 text-neutral-700 dark:text-neutral-300">If package A imports B and B imports A, Go will refuse to compile. This is almost always caused by poor responsibility decomposition: two packages that are actually one responsibility, or a third package that should own the shared type. Interfaces defined at the consumer (as shown above) are the standard solution.</div></details></div><style>#accordion-c327d8ba987e8fa35771426c3f61cd2c>details+details{border-top:1px solid rgb(var(--color-neutral-200))}.dark #accordion-c327d8ba987e8fa35771426c3f61cd2c>details+details{border-top-color:rgb(var(--color-neutral-700))}</style><script>(()=>{const e=document.getElementById("accordion-c327d8ba987e8fa35771426c3f61cd2c");if(!e)return;const t=e.querySelectorAll("details[data-accordion-item]");t.forEach(e=>{e.addEventListener("toggle",()=>{if(!e.open)return;t.forEach(t=>{t!==e&&t.removeAttribute("open")})})})})()</script><hr><p>If you want to go deeper on any of this, I offer 1:1 coaching sessions for engineers working on AI integration, cloud architecture, and platform engineering. <a href=https://calendly.com/manuelfedele/60min target=_blank rel=noreferrer>Book a session</a> (50 EUR / 60 min) or reach out at <a href=mailto:manuel.fedele+website@gmail.com>manuel.fedele+website@gmail.com</a>.</p></div><h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2><section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3"><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src="https://images.unsplash.com/photo-1518770660439-4636190af475?w=1200&amp;q=85" role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/posts/implement-desing-patterns-with-golang/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>Design Patterns in Go: Idiomatic Implementations</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2023-02-21T13:16:06+01:00>21 February 2023</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">9 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/tags/design-patterns/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Design Patterns
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/golang/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Golang</span></span></a></div></div></div><div class="px-6 pt-4 pb-2"></div></article><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src="https://images.unsplash.com/photo-1620641788421-7a1c342ea42e?w=1200&amp;q=85" role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/posts/how-to-use-interfaces-in-golang/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>Go Interfaces in Practice: Polymorphism, Composition, and Testing</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2022-12-11T19:04:27+01:00>11 December 2022</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">8 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/tags/golang/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Golang
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/design-patterns/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Design Patterns</span></span></a></div></div></div><div class="px-6 pt-4 pb-2"></div></article><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src="https://images.unsplash.com/photo-1592609931041-40265b692757?w=1200&amp;q=85" role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/posts/implement-factory-design-pattern-golang/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>The Factory Pattern in Go: Dependency Inversion and Testable Services</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2022-12-11T18:57:13+01:00>11 December 2022</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">6 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/tags/golang/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Golang
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/design-patterns/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Design Patterns
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/solid/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Solid
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/testing/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Testing</span></span></a></div></div></div><div class="px-6 pt-4 pb-2"></div></article><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src="https://images.unsplash.com/photo-1636953056323-9c09fdd74fa6?w=1200&amp;q=85" role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/posts/nats-messaging-with-golang/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>NATS Messaging in Go: Core, JetStream, and Production Patterns</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2023-02-13T18:57:15+01:00>13 February 2023</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">9 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/tags/golang/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Golang
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/nats/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Nats
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/messaging/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Messaging
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/jetstream/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Jetstream</span></span></a></div></div></div><div class="px-6 pt-4 pb-2"></div></article></section></div></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span class="flex flex-col"><a class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/posts/schedule-github-action-with-cron/><span class=leading-6><span class="inline-block rtl:rotate-180">&larr;</span>&ensp;Scheduled Automation with GitHub Actions: Real DevOps Use Cases
</span></a><span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2023-03-12T15:03:40+01:00>12 March 2023</time>
</span></span><span class="flex flex-col items-end"><a class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/posts/aws-opensearch-as-monitoring-tool/><span class=leading-6>Shipping Lambda Logs to OpenSearch Across AWS Accounts with Terraform&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
</span></a><span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2023-07-12T08:42:00+02:00>12 July 2023</time></span></span></div></div></footer></article><div id=scroll-to-top class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200"><a href=#the-top class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2026
Manuel Fedele</p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://manuelfedele.github.io/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>