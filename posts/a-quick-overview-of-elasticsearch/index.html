<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=false><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>Elasticsearch in Practice: Indexing, Searching, and Relevance Scoring &#183; Git Push and Run</title><meta name=title content="Elasticsearch in Practice: Indexing, Searching, and Relevance Scoring &#183; Git Push and Run"><meta name=description content="Software Engineer and Cloud Architect writing about Go, Python, AWS, and AI automation."><meta name=keywords content="elasticsearch,search,databases,backend,"><link rel=canonical href=https://manuelfedele.github.io/posts/a-quick-overview-of-elasticsearch/><meta name=author content="Manuel Fedele"><link href=https://github.com/manuelfedele rel=me><link href=https://linkedin.com/in/manuel-fedele rel=me><meta property="og:url" content="https://manuelfedele.github.io/posts/a-quick-overview-of-elasticsearch/"><meta property="og:site_name" content="Git Push and Run"><meta property="og:title" content="Elasticsearch in Practice: Indexing, Searching, and Relevance Scoring"><meta property="og:description" content="Elasticsearch is not just a database with a search box. It is a distributed relevance engine built on inverted indexes, and understanding that distinction changes how you design schemas, queries, and aggregations. I have run Elasticsearch in production for log analytics, product search, and document retrieval pipelines. The same mistakes appear every time a team treats it like a relational database. This post covers what you actually need to know: mappings, query semantics, relevance scoring, and aggregations as they really work."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-01-13T17:24:25+01:00"><meta property="article:modified_time" content="2023-01-13T17:24:25+01:00"><meta property="article:tag" content="Elasticsearch"><meta property="article:tag" content="Search"><meta property="article:tag" content="Databases"><meta property="article:tag" content="Backend"><meta name=twitter:card content="summary"><meta name=twitter:title content="Elasticsearch in Practice: Indexing, Searching, and Relevance Scoring"><meta name=twitter:description content="Elasticsearch is not just a database with a search box. It is a distributed relevance engine built on inverted indexes, and understanding that distinction changes how you design schemas, queries, and aggregations. I have run Elasticsearch in production for log analytics, product search, and document retrieval pipelines. The same mistakes appear every time a team treats it like a relational database. This post covers what you actually need to know: mappings, query semantics, relevance scoring, and aggregations as they really work."><link type=text/css rel=stylesheet href=/css/main.bundle.min.726dfbf42bcd66e35e2d7258d72fe8fe77509ff76d153e2b46cdbae9c3af9620653459f0119a72d2af4a9b4bc446652d244ad58743d0290e5d8e09e3983b98e5.css integrity="sha512-cm379CvNZuNeLXJY1y/o/ndQn/dtFT4rRs266cOvliBlNFnwEZpy0q9Km0vERmUtJErVh0PQKQ5djgnjmDuY5Q=="><script type=text/javascript src=/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js integrity="sha512-b0EXSzoFtoCCD+CMrb+l+3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.88278edec77139635e1ad294df5b32b7be9338191c5252d3f6f451ace5852d5f82390cccacedab9c64739d8e068b7e8502895cf8f951060c0368f9a73709fcb7.js integrity="sha512-iCeO3sdxOWNeGtKU31syt76TOBkcUlLT9vRRrOWFLV+COQzMrO2rnGRznY4Gi36FAolc+PlRBgwDaPmnNwn8tw==" data-copy=Copy data-copied=Copied></script><script src=/js/shortcodes/tabs.min.b9b8a6b2cf6c81163025e44a18c0ccce600efe2dfc29d2d11515fe41b8e1e8e00896759b9e55eab7032ab15d1bec124c32e8996685e563de84ad243eb61ec236.js integrity="sha512-ubimss9sgRYwJeRKGMDMzmAO/i38KdLRFRX+Qbjh6OAIlnWbnlXqtwMqsV0b7BJMMuiZZoXlY96ErSQ+th7CNg==" crossorigin=anonymous></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Elasticsearch in Practice: Indexing, Searching, and Relevance Scoring","headline":"Elasticsearch in Practice: Indexing, Searching, and Relevance Scoring","inLanguage":"en","url":"https://manuelfedele.github.io/posts/a-quick-overview-of-elasticsearch/","author":{"@type":"Person","name":"Manuel Fedele"},"copyrightYear":"2023","dateCreated":"2023-01-13T17:24:25\u002b01:00","datePublished":"2023-01-13T17:24:25\u002b01:00","dateModified":"2023-01-13T17:24:25\u002b01:00","keywords":["elasticsearch","search","databases","backend"],"mainEntityOfPage":"true","wordCount":"1575"}]</script></head><body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral bf-scrollbar"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 z-100"><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl bg-neutral/25 dark:bg-neutral-800/25"></div><div class="relative m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32"><div class="main-menu flex items-center w-full gap-2 p-1 pl-0"><a href=/ class="text-base font-medium truncate min-w-0 shrink">Git Push and Run</a><div class="flex items-center ms-auto"><div class="hidden md:flex"><nav class="flex items-center gap-x-5 h-12"><a href=/posts/ class="flex items-center bf-icon-color-hover" aria-label=Blog title=Posts><span class="text-base font-medium break-normal">Blog
</span></a><a href=/about/ class="flex items-center bf-icon-color-hover" aria-label=About title=About><span class="text-base font-medium break-normal">About
</span></a><a href=/coaching/ class="flex items-center bf-icon-color-hover" aria-label=Coaching title=Coaching><span class="text-base font-medium break-normal">Coaching
</span></a><a href=https://github.com/manuelfedele target=_blank class="flex items-center bf-icon-color-hover" aria-label=github title><span><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span></a><div class="translation nested-menu"><button class="cursor-pointer flex items-center">
<span class=me-1><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M0 128C0 92.7 28.7 64 64 64H256h48 16H576c35.3.0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H320 304 256 64c-35.3.0-64-28.7-64-64V128zm320 0V384H576V128H320zM178.3 175.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1.1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1h73.6l8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4l-64-144zM160 233.2 179 276H141l19-42.8zM448 164c11 0 20 9 20 20v4h44 16c11 0 20 9 20 20s-9 20-20 20h-2l-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4.9.6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9L467 333.8c-4.5-2.7-8.8-5.5-13.1-8.5-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8L410 286.1c-7.8-7.8-7.8-20.5.0-28.3s20.5-7.8 28.3.0l14.6 14.6.5.5c12.4-13.1 22.5-28.3 29.8-45H448 376c-11 0-20-9-20-20s9-20 20-20h52v-4c0-11 9-20 20-20z"/></svg></span>
</span><span class="text-sm font-medium bf-icon-color-hover" title="Elasticsearch in Practice: Indexing, Searching, and Relevance Scoring">EN</span></button><ul class=menuhide><li class="rounded-xl backdrop-blur shadow-2xl p-2 flex flex-col gap-1"><a href=/posts/a-quick-overview-of-elasticsearch/ class="flex items-center bf-icon-color-hover px-3 py-1"><span class="text-sm font-sm" title="Elasticsearch in Practice: Indexing, Searching, and Relevance Scoring">EN
</span></a><a href=/it/posts/a-quick-overview-of-elasticsearch/ class="flex items-center bf-icon-color-hover px-3 py-1"><span class="text-sm font-sm" title="Elasticsearch in pratica: Indicizzazione, ricerca e rilevanza">IT</span></a></li></ul></div><button id=search-button aria-label=Search class="text-base bf-icon-color-hover" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button></nav></div><div class="flex md:hidden"><div class="flex items-center h-14 gap-4"><button id=search-button-mobile aria-label=Search class="flex items-center justify-center bf-icon-color-hover" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<input type=checkbox id=mobile-menu-toggle autocomplete=off class="hidden peer">
<label for=mobile-menu-toggle class="flex items-center justify-center cursor-pointer bf-icon-color-hover"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></label><div role=dialog aria-modal=true style=scrollbar-gutter:stable class="fixed inset-0 z-50 invisible overflow-y-auto px-6 py-20 opacity-0 transition-[opacity,visibility] duration-300 peer-checked:visible peer-checked:opacity-100 bg-neutral-50/97 dark:bg-neutral-900/99
bf-scrollbar"><label for=mobile-menu-toggle class="fixed end-8 top-5 flex items-center justify-center z-50 h-12 w-12 cursor-pointer select-none rounded-full bf-icon-color-hover border bf-border-color bf-border-color-hover bg-neutral-50 dark:bg-neutral-900"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></label><nav class="mx-auto max-w-md space-y-6"><div class=px-2><a href=/posts/ aria-label=Blog class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=Posts class="text-2xl font-bold tracking-tight">Blog</span></a></div><div class=px-2><a href=/about/ aria-label=About class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=About class="text-2xl font-bold tracking-tight">About</span></a></div><div class=px-2><a href=/coaching/ aria-label=Coaching class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=Coaching class="text-2xl font-bold tracking-tight">Coaching</span></a></div><div class=px-2><a href=https://github.com/manuelfedele aria-label=github target=_blank class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span class="flex items-center justify-center h-8 w-8 text-2xl"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span><span title class="text-2xl font-bold tracking-tight"></span></a></div><div class="flex flex-wrap items-center [&_span]:text-2xl [&_.translation_button_.icon]:text-4xl! [&_.translation_button_span]:text-base! [&_.translation_.menuhide_span]:text-sm! gap-x-6 ps-2 mt-8 pt-8 border-t bf-border-color"><div class="translation nested-menu"><button class="cursor-pointer flex items-center">
<span class=me-1><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M0 128C0 92.7 28.7 64 64 64H256h48 16H576c35.3.0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H320 304 256 64c-35.3.0-64-28.7-64-64V128zm320 0V384H576V128H320zM178.3 175.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1.1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1h73.6l8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4l-64-144zM160 233.2 179 276H141l19-42.8zM448 164c11 0 20 9 20 20v4h44 16c11 0 20 9 20 20s-9 20-20 20h-2l-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4.9.6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9L467 333.8c-4.5-2.7-8.8-5.5-13.1-8.5-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8L410 286.1c-7.8-7.8-7.8-20.5.0-28.3s20.5-7.8 28.3.0l14.6 14.6.5.5c12.4-13.1 22.5-28.3 29.8-45H448 376c-11 0-20-9-20-20s9-20 20-20h52v-4c0-11 9-20 20-20z"/></svg></span>
</span><span class="text-sm font-medium bf-icon-color-hover" title="Elasticsearch in Practice: Indexing, Searching, and Relevance Scoring">EN</span></button><ul class=menuhide><li class="rounded-xl backdrop-blur shadow-2xl p-2 flex flex-col gap-1"><a href=/posts/a-quick-overview-of-elasticsearch/ class="flex items-center bf-icon-color-hover px-3 py-1"><span class="text-sm font-sm" title="Elasticsearch in Practice: Indexing, Searching, and Relevance Scoring">EN
</span></a><a href=/it/posts/a-quick-overview-of-elasticsearch/ class="flex items-center bf-icon-color-hover px-3 py-1"><span class="text-sm font-sm" title="Elasticsearch in pratica: Indicizzazione, ricerca e rilevanza">IT</span></a></li></ul></div></div></nav></div></div></div></div></div><script>(function(){var t,n,e=document.querySelector(".main-menu");if(!e)return;t=window.location.pathname,n=e.querySelectorAll('a[href="'+t+'"]'),n.forEach(function(e){var t=e.querySelectorAll("span");t.forEach(function(e){e.classList.add("active")})})})()</script></div></div><script type=text/javascript src=/js/background-blur.min.00a57c73ea12f2cab2980c3c3d649e89f6d82f190f74bbe2b67f2f5e39ab7d032ece47086400ca05396758aace13299da49aca43ea643d2625e62c506267a169.js integrity="sha512-AKV8c+oS8sqymAw8PWSeifbYLxkPdLvitn8vXjmrfQMuzkcIZADKBTlnWKrOEymdpJrKQ+pkPSYl5ixQYmehaQ==" data-blur-id=menu-blur></script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"><img id=background-image src="https://images.unsplash.com/photo-1551288049-bebda4e38f71?w=1200&amp;q=85" role=presentation loading=eager decoding=async fetchpriority=high class="absolute inset-0 w-full h-full object-cover"><div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div><div class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-xl bg-neutral-100/75 dark:bg-neutral-800/60"></div><script type=text/javascript src=/js/background-blur.min.00a57c73ea12f2cab2980c3c3d649e89f6d82f190f74bbe2b67f2f5e39ab7d032ece47086400ca05396758aace13299da49aca43ea643d2625e62c506267a169.js integrity="sha512-AKV8c+oS8sqymAw8PWSeifbYLxkPdLvitn8vXjmrfQMuzkcIZADKBTlnWKrOEymdpJrKQ+pkPSYl5ixQYmehaQ==" data-blur-id=background-blur data-image-id=background-image data-image-url="https://images.unsplash.com/photo-1551288049-bebda4e38f71?w=1200&amp;q=85"></script><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Elasticsearch in Practice: Indexing, Searching, and Relevance Scoring</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2023-01-13T17:24:25+01:00>13 January 2023</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">8 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/tags/elasticsearch/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Elasticsearch
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/search/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Search
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/databases/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Databases
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/backend/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Backend</span></span></a></div></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ms-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs"><div class="toc ps-5 print:hidden lg:sticky lg:top-[140px]"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain bf-scrollbar rounded-lg -ms-5 ps-5 pe-2 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#core-concepts-index-document-shard-replica>Core Concepts: Index, Document, Shard, Replica</a></li><li><a href=#index-mappings-explicit-vs-dynamic>Index Mappings: Explicit vs Dynamic</a></li><li><a href=#indexing-documents-put-vs-post-and-bulk-for-performance>Indexing Documents: PUT vs POST, and Bulk for Performance</a></li><li><a href=#match-query-bool-query-and-filter-vs-must>Match Query, Bool Query, and Filter vs Must</a></li><li><a href=#relevance-scoring-bm25-boost-and-explain>Relevance Scoring: BM25, Boost, and Explain</a></li><li><a href=#aggregations-query-time-analytics>Aggregations: Query-Time Analytics</a></li><li><a href=#index-templates-for-multi-index-patterns>Index Templates for Multi-Index Patterns</a></li><li><a href=#elasticsearch-vs-opensearch>Elasticsearch vs OpenSearch</a></li><li><a href=#common-mistakes>Common Mistakes</a></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#core-concepts-index-document-shard-replica>Core Concepts: Index, Document, Shard, Replica</a></li><li><a href=#index-mappings-explicit-vs-dynamic>Index Mappings: Explicit vs Dynamic</a></li><li><a href=#indexing-documents-put-vs-post-and-bulk-for-performance>Indexing Documents: PUT vs POST, and Bulk for Performance</a></li><li><a href=#match-query-bool-query-and-filter-vs-must>Match Query, Bool Query, and Filter vs Must</a></li><li><a href=#relevance-scoring-bm25-boost-and-explain>Relevance Scoring: BM25, Boost, and Explain</a></li><li><a href=#aggregations-query-time-analytics>Aggregations: Query-Time Analytics</a></li><li><a href=#index-templates-for-multi-index-patterns>Index Templates for Multi-Index Patterns</a></li><li><a href=#elasticsearch-vs-opensearch>Elasticsearch vs OpenSearch</a></li><li><a href=#common-mistakes>Common Mistakes</a></li></ul></nav></div></details><script>(function(){"use strict";const s=.33,o="#TableOfContents",i=".anchor",a='a[href^="#"]',r="li ul",c="active";let t=!1;function l(e,n){const o=window.scrollY+window.innerHeight*n,i=[...document.querySelectorAll('#TableOfContents a[href^="#"]')],s=new Set(i.map(e=>e.getAttribute("href").substring(1)));if(t)for(let t=0;t<e.length;t++){const n=e[t];if(!s.has(n.id))continue;const o=n.getBoundingClientRect().top+window.scrollY;if(Math.abs(window.scrollY-o)<100)return n.id}for(let t=e.length-1;t>=0;t--){const n=e[t].getBoundingClientRect().top+window.scrollY;if(n<=o&&s.has(e[t].id))return e[t].id}return e.find(e=>s.has(e.id))?.id||""}function e({toc:e,anchors:t,links:n,scrollOffset:s,collapseInactive:o}){const i=l(t,s);if(!i)return;if(n.forEach(e=>{const t=e.getAttribute("href")===`#${i}`;if(e.classList.toggle(c,t),o){const n=e.closest("li")?.querySelector("ul");n&&(n.style.display=t?"":"none")}}),o){const n=e.querySelector(`a[href="#${CSS.escape(i)}"]`);let t=n;for(;t&&t!==e;)t.tagName==="UL"&&(t.style.display=""),t.tagName==="LI"&&t.querySelector("ul")?.style.setProperty("display",""),t=t.parentElement}}function n(){const n=document.querySelector(o);if(!n)return;const l=!0,u=[...document.querySelectorAll(i)],d=[...n.querySelectorAll(a)];l&&n.querySelectorAll(r).forEach(e=>e.style.display="none"),d.forEach(e=>{e.addEventListener("click",()=>{t=!0})});const c={toc:n,anchors:u,links:d,scrollOffset:s,collapseInactive:l};window.addEventListener("scroll",()=>e(c),{passive:!0}),window.addEventListener("hashchange",()=>e(c),{passive:!0}),e(c)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",n):n()})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><div class="lead text-neutral-500 dark:text-neutral-400 !mb-9 text-xl">Elasticsearch is not just a database with a search box. It is a distributed relevance engine built on inverted indexes, and understanding that distinction changes how you design schemas, queries, and aggregations.</div><p>I have run Elasticsearch in production for log analytics, product search, and document retrieval pipelines. The same mistakes appear every time a team treats it like a relational database. This post covers what you actually need to know: mappings, query semantics, relevance scoring, and aggregations as they really work.</p><h2 class="relative group">Core Concepts: Index, Document, Shard, Replica<div id=core-concepts-index-document-shard-replica class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#core-concepts-index-document-shard-replica aria-label=Anchor>#</a></span></h2><p>An <strong>index</strong> is a logical namespace. A <strong>document</strong> is a JSON object stored in an index. Elasticsearch distributes documents across <strong>shards</strong> (horizontal partitions), and each shard can have one or more <strong>replicas</strong> for fault tolerance.</p><div class="admonition relative overflow-hidden rounded-lg border-l-4 my-3 px-4 py-3 shadow-sm" data-type=warning><div class="flex items-center gap-2 font-semibold text-inherit"><div class="flex shrink-0 h-5 w-5 items-center justify-center text-lg"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M506.3 417 293 53c-16.33-28-57.54-28-73.98.0l-213.2 364C-10.59 444.9 9.849 480 42.74 480h426.6c32.76.0 53.26-35 36.96-63zM232 168c0-13.25 10.75-24 24-24s24 10.8 24 24v128c0 13.25-10.75 24-23.1 24S232 309.3 232 296V168zm24 248c-17.36.0-31.44-14.08-31.44-31.44s14.07-31.44 31.44-31.44 31.44 14.08 31.44 31.44C287.4 401.9 273.4 416 256 416z"/></svg></span></div><div class=grow>Warning</div></div><div class="admonition-content mt-3 text-base leading-relaxed text-inherit"><p>Do not use Elasticsearch as your primary datastore. It does not support transactions, and its near-real-time consistency model (documents become searchable after a ~1-second refresh interval by default) means you can read your own write and not see it. Store authoritative data in PostgreSQL or another ACID store, and sync to Elasticsearch for search.</p></div></div><p>A typical cluster topology for production: 3 dedicated master nodes, N data nodes sized for your shard count and data volume. Avoid co-locating masters with data nodes in production.</p><h2 class="relative group">Index Mappings: Explicit vs Dynamic<div id=index-mappings-explicit-vs-dynamic class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#index-mappings-explicit-vs-dynamic aria-label=Anchor>#</a></span></h2><p>Elasticsearch can infer field types from the first document you index (dynamic mapping), but in production you should always define explicit mappings.</p><p>The most important field type decision is <strong><code>text</code> vs <code>keyword</code></strong>:</p><ul><li><code>text</code> fields are analyzed: the string is tokenized, lowercased, and stemmed. Use for full-text search.</li><li><code>keyword</code> fields are stored verbatim. Use for exact-match filtering, sorting, and aggregations.</li></ul><p>The analyzer pipeline for a <code>text</code> field is: <strong>character filters</strong> (strip HTML, normalize unicode) -> <strong>tokenizer</strong> (split on whitespace, punctuation) -> <strong>token filters</strong> (lowercase, stop words, stemming).</p><div class=highlight-wrapper><div class=codeblock-title>create-index.sh</div><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -X PUT <span style=color:#a3be8c>&#34;localhost:9200/products&#34;</span> <span style=color:#ebcb8b>\
</span></span></span><span style=display:flex><span><span style=color:#ebcb8b></span>  -H <span style=color:#a3be8c>&#34;Content-Type: application/json&#34;</span> <span style=color:#ebcb8b>\
</span></span></span><span style=display:flex><span><span style=color:#ebcb8b></span>  -u <span style=color:#a3be8c>&#34;elastic:changeme&#34;</span> <span style=color:#ebcb8b>\
</span></span></span><span style=display:flex><span><span style=color:#ebcb8b></span>  -d <span style=color:#a3be8c>&#39;{
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>    &#34;settings&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      &#34;number_of_shards&#34;: 3,
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      &#34;number_of_replicas&#34;: 1,
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      &#34;analysis&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        &#34;analyzer&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>          &#34;english_custom&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>            &#34;type&#34;: &#34;custom&#34;,
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>            &#34;tokenizer&#34;: &#34;standard&#34;,
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>            &#34;filter&#34;: [&#34;lowercase&#34;, &#34;english_stop&#34;, &#34;english_stemmer&#34;]
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>          }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        },
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        &#34;filter&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>          &#34;english_stop&#34;: { &#34;type&#34;: &#34;stop&#34;, &#34;stopwords&#34;: &#34;_english_&#34; },
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>          &#34;english_stemmer&#34;: { &#34;type&#34;: &#34;stemmer&#34;, &#34;language&#34;: &#34;english&#34; }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>    },
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>    &#34;mappings&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      &#34;properties&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        &#34;name&#34;:        { &#34;type&#34;: &#34;text&#34;,    &#34;analyzer&#34;: &#34;english_custom&#34; },
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        &#34;sku&#34;:         { &#34;type&#34;: &#34;keyword&#34; },
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        &#34;price&#34;:       { &#34;type&#34;: &#34;double&#34; },
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        &#34;category&#34;:    { &#34;type&#34;: &#34;keyword&#34; },
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        &#34;description&#34;: { &#34;type&#34;: &#34;text&#34;,    &#34;analyzer&#34;: &#34;english_custom&#34; },
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        &#34;created_at&#34;:  { &#34;type&#34;: &#34;date&#34;,    &#34;format&#34;: &#34;strict_date_optional_time&#34; },
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        &#34;in_stock&#34;:    { &#34;type&#34;: &#34;boolean&#34; }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>    }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>  }&#39;</span></span></span></code></pre></div></div><div class="admonition relative overflow-hidden rounded-lg border-l-4 my-3 px-4 py-3 shadow-sm" data-type=note><div class="flex items-center gap-2 font-semibold text-inherit"><div class="flex shrink-0 h-5 w-5 items-center justify-center text-lg"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6.0.0 114.6.0 256s114.6 256 256 256 256-114.6 256-256S397.4.0 256 0zm0 128c17.67.0 32 14.33 32 32 0 17.67-14.33 32-32 32s-32-14.3-32-32 14.3-32 32-32zm40 256h-80c-13.2.0-24-10.7-24-24s10.75-24 24-24h16v-64h-8c-13.25.0-24-10.75-24-24s10.8-24 24-24h32c13.25.0 24 10.75 24 24v88h16c13.25.0 24 10.75 24 24s-10.7 24-24 24z"/></svg></span></div><div class=grow>Note</div></div><div class="admonition-content mt-3 text-base leading-relaxed text-inherit"><p>Once an index exists, you cannot change the type of an existing field. You must reindex into a new index. Plan your mappings carefully before going to production, or use index aliases to hide the reindex operation from clients.</p></div></div><h2 class="relative group">Indexing Documents: PUT vs POST, and Bulk for Performance<div id=indexing-documents-put-vs-post-and-bulk-for-performance class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#indexing-documents-put-vs-post-and-bulk-for-performance aria-label=Anchor>#</a></span></h2><p>Use <code>PUT /&lt;index>/_doc/&lt;id></code> when you control the document ID (idempotent upsert). Use <code>POST /&lt;index>/_doc</code> when you want Elasticsearch to generate the ID.</p><p>For bulk ingest, always use the <code>_bulk</code> API. Sending individual documents over HTTP for large datasets is a significant performance bottleneck.</p><div class=highlight-wrapper><div class=codeblock-title>bulk-index.sh</div><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#616e87;font-style:italic># Each action line must be followed by the document line.</span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic># The blank line at the end is required.</span>
</span></span><span style=display:flex><span>curl -X POST <span style=color:#a3be8c>&#34;localhost:9200/_bulk&#34;</span> <span style=color:#ebcb8b>\
</span></span></span><span style=display:flex><span><span style=color:#ebcb8b></span>  -H <span style=color:#a3be8c>&#34;Content-Type: application/x-ndjson&#34;</span> <span style=color:#ebcb8b>\
</span></span></span><span style=display:flex><span><span style=color:#ebcb8b></span>  -u <span style=color:#a3be8c>&#34;elastic:changeme&#34;</span> <span style=color:#ebcb8b>\
</span></span></span><span style=display:flex><span><span style=color:#ebcb8b></span>  --data-binary <span style=color:#a3be8c>&#39;
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>{&#34;index&#34;: {&#34;_index&#34;: &#34;products&#34;, &#34;_id&#34;: &#34;1&#34;}}
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>{&#34;name&#34;: &#34;Widget Pro&#34;, &#34;sku&#34;: &#34;WGT-001&#34;, &#34;price&#34;: 29.99, &#34;category&#34;: &#34;widgets&#34;, &#34;in_stock&#34;: true}
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>{&#34;index&#34;: {&#34;_index&#34;: &#34;products&#34;, &#34;_id&#34;: &#34;2&#34;}}
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>{&#34;name&#34;: &#34;Gadget Max&#34;, &#34;sku&#34;: &#34;GDG-002&#34;, &#34;price&#34;: 49.99, &#34;category&#34;: &#34;gadgets&#34;, &#34;in_stock&#34;: false}
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>&#39;</span></span></span></code></pre></div></div><p>For high-throughput pipelines, tune <code>refresh_interval</code> to <code>30s</code> or <code>-1</code> during bulk loads, then set it back to <code>1s</code>. This avoids Lucene segment merges competing with ingest.</p><h2 class="relative group">Match Query, Bool Query, and Filter vs Must<div id=match-query-bool-query-and-filter-vs-must class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#match-query-bool-query-and-filter-vs-must aria-label=Anchor>#</a></span></h2><p>The <code>match</code> query performs full-text search: it analyzes the input and scores documents by relevance. The <code>bool</code> query composes multiple clauses:</p><ul><li><code>must</code>: document must match, contributes to score</li><li><code>filter</code>: document must match, does NOT contribute to score (cached)</li><li><code>should</code>: boosts score if matched, optional unless no <code>must</code> is present</li><li><code>must_not</code>: document must not match, no scoring</li></ul><div class=highlight-wrapper><div class=codeblock-title>bool-query.sh</div><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -X GET <span style=color:#a3be8c>&#34;localhost:9200/products/_search&#34;</span> <span style=color:#ebcb8b>\
</span></span></span><span style=display:flex><span><span style=color:#ebcb8b></span>  -H <span style=color:#a3be8c>&#34;Content-Type: application/json&#34;</span> <span style=color:#ebcb8b>\
</span></span></span><span style=display:flex><span><span style=color:#ebcb8b></span>  -u <span style=color:#a3be8c>&#34;elastic:changeme&#34;</span> <span style=color:#ebcb8b>\
</span></span></span><span style=display:flex><span><span style=color:#ebcb8b></span>  -d <span style=color:#a3be8c>&#39;{
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>    &#34;query&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      &#34;bool&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        &#34;must&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>          { &#34;match&#34;: { &#34;name&#34;: &#34;widget&#34; } }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        ],
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        &#34;filter&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>          { &#34;term&#34;:  { &#34;category&#34;: &#34;widgets&#34; } },
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>          { &#34;term&#34;:  { &#34;in_stock&#34;: true } },
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>          { &#34;range&#34;: { &#34;price&#34;: { &#34;lte&#34;: 50.0 } } }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        ]
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>    }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>  }&#39;</span></span></span></code></pre></div></div><div class="admonition relative overflow-hidden rounded-lg border-l-4 my-3 px-4 py-3 shadow-sm" data-type=tip><div class="flex items-center gap-2 font-semibold text-inherit"><div class="flex shrink-0 h-5 w-5 items-center justify-center text-lg"><span class="relative block icon"><svg viewBox="0 0 384 512"><path fill="currentColor" d="M112.1 454.3c0 6.297 1.816 12.44 5.284 17.69l17.14 25.69c5.25 7.875 17.17 14.28 26.64 14.28h61.67c9.438.0 21.36-6.401 26.61-14.28l17.08-25.68c2.938-4.438 5.348-12.37 5.348-17.7L272 415.1H112L112.1 454.3zM191.4.0132C89.44.3257 16 82.97 16 175.1c0 44.38 16.44 84.84 43.56 115.8 16.53 18.84 42.34 58.23 52.22 91.45.0313.25.0938.5166.125.7823h160.2c.0313-.2656.0938-.5166.125-.7823 9.875-33.22 35.69-72.61 52.22-91.45C351.6 260.8 368 220.4 368 175.1 368 78.61 288.9-.2837 191.4.0132zM192 96.01c-44.13.0-80 35.89-80 79.1.0 9.69-7.2 16.89-16 16.89S80 184.8 80 176c0-61.76 50.25-111.1 112-111.1 8.844.0 16 7.159 16 16S200.8 96.01 192 96.01z"/></svg></span></div><div class=grow>Tip</div></div><div class="admonition-content mt-3 text-base leading-relaxed text-inherit"><p>Use <code>filter</code> for structured criteria (category, price range, date range, boolean flags). Filter clauses are cached at the segment level and reused across queries, making repeated filtered searches much faster. Use <code>must</code> only for the free-text portion where relevance scoring matters.</p></div></div><h2 class="relative group">Relevance Scoring: BM25, Boost, and Explain<div id=relevance-scoring-bm25-boost-and-explain class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#relevance-scoring-bm25-boost-and-explain aria-label=Anchor>#</a></span></h2><p>Elasticsearch uses <strong>BM25</strong> (Best Match 25) as its default similarity function. BM25 scores a document based on:</p><ul><li><strong>Term frequency</strong>: how often the term appears in the field (with diminishing returns)</li><li><strong>Inverse document frequency</strong>: how rare the term is across the index</li><li><strong>Field length normalization</strong>: shorter fields with the same term get a higher score</li></ul><p>You can influence scoring with <code>boost</code>:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>  <span style=color:#81a1c1>&#34;query&#34;</span><span style=color:#eceff4>:</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>    <span style=color:#81a1c1>&#34;bool&#34;</span><span style=color:#eceff4>:</span> <span style=color:#eceff4>{</span>
</span></span><span style=display:flex><span>      <span style=color:#81a1c1>&#34;should&#34;</span><span style=color:#eceff4>:</span> <span style=color:#eceff4>[</span>
</span></span><span style=display:flex><span>        <span style=color:#eceff4>{</span> <span style=color:#81a1c1>&#34;match&#34;</span><span style=color:#eceff4>:</span> <span style=color:#eceff4>{</span> <span style=color:#81a1c1>&#34;name&#34;</span><span style=color:#eceff4>:</span>        <span style=color:#eceff4>{</span> <span style=color:#81a1c1>&#34;query&#34;</span><span style=color:#eceff4>:</span> <span style=color:#a3be8c>&#34;widget&#34;</span><span style=color:#eceff4>,</span> <span style=color:#81a1c1>&#34;boost&#34;</span><span style=color:#eceff4>:</span> <span style=color:#b48ead>3.0</span> <span style=color:#eceff4>}</span> <span style=color:#eceff4>}</span> <span style=color:#eceff4>},</span>
</span></span><span style=display:flex><span>        <span style=color:#eceff4>{</span> <span style=color:#81a1c1>&#34;match&#34;</span><span style=color:#eceff4>:</span> <span style=color:#eceff4>{</span> <span style=color:#81a1c1>&#34;description&#34;</span><span style=color:#eceff4>:</span> <span style=color:#eceff4>{</span> <span style=color:#81a1c1>&#34;query&#34;</span><span style=color:#eceff4>:</span> <span style=color:#a3be8c>&#34;widget&#34;</span><span style=color:#eceff4>,</span> <span style=color:#81a1c1>&#34;boost&#34;</span><span style=color:#eceff4>:</span> <span style=color:#b48ead>1.0</span> <span style=color:#eceff4>}</span> <span style=color:#eceff4>}</span> <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>      <span style=color:#eceff4>]</span>
</span></span><span style=display:flex><span>    <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span>  <span style=color:#eceff4>}</span>
</span></span><span style=display:flex><span><span style=color:#eceff4>}</span></span></span></code></pre></div></div><p>To debug why a document scored the way it did, add <code>"explain": true</code> to your query. The response includes a tree of score contributions for each matched document.</p><div class=highlight-wrapper><div class=codeblock-title>explain-query.sh</div><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -X GET <span style=color:#a3be8c>&#34;localhost:9200/products/_search&#34;</span> <span style=color:#ebcb8b>\
</span></span></span><span style=display:flex><span><span style=color:#ebcb8b></span>  -H <span style=color:#a3be8c>&#34;Content-Type: application/json&#34;</span> <span style=color:#ebcb8b>\
</span></span></span><span style=display:flex><span><span style=color:#ebcb8b></span>  -u <span style=color:#a3be8c>&#34;elastic:changeme&#34;</span> <span style=color:#ebcb8b>\
</span></span></span><span style=display:flex><span><span style=color:#ebcb8b></span>  -d <span style=color:#a3be8c>&#39;{
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>    &#34;explain&#34;: true,
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>    &#34;query&#34;: { &#34;match&#34;: { &#34;name&#34;: &#34;widget&#34; } }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>  }&#39;</span></span></span></code></pre></div></div><h2 class="relative group">Aggregations: Query-Time Analytics<div id=aggregations-query-time-analytics class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#aggregations-query-time-analytics aria-label=Anchor>#</a></span></h2><p>Aggregations are computed at <strong>query time</strong> on the result set. They are part of the search request body, not part of index creation. A common mistake is thinking you can bake aggregation results into the index structure at write time. You cannot.</p><div class=highlight-wrapper><div class=codeblock-title>aggregations.sh</div><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#616e87;font-style:italic># terms + date_histogram nested aggregation</span>
</span></span><span style=display:flex><span>curl -X GET <span style=color:#a3be8c>&#34;localhost:9200/products/_search&#34;</span> <span style=color:#ebcb8b>\
</span></span></span><span style=display:flex><span><span style=color:#ebcb8b></span>  -H <span style=color:#a3be8c>&#34;Content-Type: application/json&#34;</span> <span style=color:#ebcb8b>\
</span></span></span><span style=display:flex><span><span style=color:#ebcb8b></span>  -u <span style=color:#a3be8c>&#34;elastic:changeme&#34;</span> <span style=color:#ebcb8b>\
</span></span></span><span style=display:flex><span><span style=color:#ebcb8b></span>  -d <span style=color:#a3be8c>&#39;{
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>    &#34;size&#34;: 0,
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>    &#34;query&#34;: { &#34;term&#34;: { &#34;in_stock&#34;: true } },
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>    &#34;aggs&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      &#34;by_category&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        &#34;terms&#34;: { &#34;field&#34;: &#34;category&#34;, &#34;size&#34;: 10 },
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        &#34;aggs&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>          &#34;avg_price&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>            &#34;avg&#34;: { &#34;field&#34;: &#34;price&#34; }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>          }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      },
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      &#34;sales_over_time&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        &#34;date_histogram&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>          &#34;field&#34;: &#34;created_at&#34;,
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>          &#34;calendar_interval&#34;: &#34;month&#34;
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>    }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>  }&#39;</span></span></span></code></pre></div></div><p>Setting <code>"size": 0</code> tells Elasticsearch not to return hits, only aggregation results. This is a meaningful performance optimization for dashboards that only need aggregate counts.</p><h2 class="relative group">Index Templates for Multi-Index Patterns<div id=index-templates-for-multi-index-patterns class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#index-templates-for-multi-index-patterns aria-label=Anchor>#</a></span></h2><p>When you have time-series indices (<code>logs-2025-01</code>, <code>logs-2025-02</code>, etc.), use index templates to apply consistent mappings and settings automatically.</p><div class=highlight-wrapper><div class=codeblock-title>index-template.sh</div><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -X PUT <span style=color:#a3be8c>&#34;localhost:9200/_index_template/logs_template&#34;</span> <span style=color:#ebcb8b>\
</span></span></span><span style=display:flex><span><span style=color:#ebcb8b></span>  -H <span style=color:#a3be8c>&#34;Content-Type: application/json&#34;</span> <span style=color:#ebcb8b>\
</span></span></span><span style=display:flex><span><span style=color:#ebcb8b></span>  -u <span style=color:#a3be8c>&#34;elastic:changeme&#34;</span> <span style=color:#ebcb8b>\
</span></span></span><span style=display:flex><span><span style=color:#ebcb8b></span>  -d <span style=color:#a3be8c>&#39;{
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>    &#34;index_patterns&#34;: [&#34;logs-*&#34;],
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>    &#34;priority&#34;: 100,
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>    &#34;template&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      &#34;settings&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        &#34;number_of_shards&#34;: 1,
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        &#34;number_of_replicas&#34;: 1
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      },
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      &#34;mappings&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        &#34;properties&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>          &#34;timestamp&#34;: { &#34;type&#34;: &#34;date&#34; },
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>          &#34;level&#34;:     { &#34;type&#34;: &#34;keyword&#34; },
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>          &#34;service&#34;:   { &#34;type&#34;: &#34;keyword&#34; },
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>          &#34;message&#34;:   { &#34;type&#34;: &#34;text&#34; }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>    }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>  }&#39;</span></span></span></code></pre></div></div><p>Combine with <strong>ILM (Index Lifecycle Management)</strong> to roll over indices at a size or age threshold and delete old data automatically.</p><h2 class="relative group">Elasticsearch vs OpenSearch<div id=elasticsearch-vs-opensearch class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#elasticsearch-vs-opensearch aria-label=Anchor>#</a></span></h2><p>AWS forked Elasticsearch 7.10.2 in 2021 to create OpenSearch, after Elastic changed the license to SSPL. The APIs are highly compatible at the query level, but they diverge in:</p><div class="tab__container w-full"><div class=tab__nav role=tablist><div class="flex flex-wrap gap-1"><button class="tab__button px-3 py-2 text-sm font-semibold border-b-2 border-transparent rounded-t-md hover:bg-neutral-200 dark:hover:bg-neutral-700 tab--active" role=tab aria-selected=true data-tab-index=0 data-tab-label>
<span class="flex items-center gap-1"></span></button><button class="tab__button px-3 py-2 text-sm font-semibold border-b-2 border-transparent rounded-t-md hover:bg-neutral-200 dark:hover:bg-neutral-700" role=tab aria-selected=false data-tab-index=1 data-tab-label>
<span class="flex items-center gap-1"></span></button></div></div><div class="tab__content mt-4"><div class="tab__panel tab--active" data-tab-index=0><ul><li>You need the latest Lucene features (vector search with HNSW, ES|QL query language)</li><li>You are running on-premises or on a cloud that offers managed Elastic</li><li>You rely on Kibana or Elastic APM integrations</li><li>Your team has existing Elastic expertise</li></ul></div><div class=tab__panel data-tab-index=1><ul><li>You are deploying on AWS and want managed service without license concerns</li><li>You need to stay on a fully open-source (Apache 2.0) stack</li><li>You use AWS Cognito / IAM for access control (native OpenSearch Service integration)</li><li>Cost is a priority: OpenSearch Serverless scales to zero</li></ul></div></div></div><p>For new projects on AWS, OpenSearch is the pragmatic default. The operational overhead of self-managing Elasticsearch clusters rarely pays off.</p><h2 class="relative group">Common Mistakes<div id=common-mistakes class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#common-mistakes aria-label=Anchor>#</a></span></h2><div id=accordion-b52a3094290d27d49f6794a9fcd33279 class="border border-neutral-200 dark:border-neutral-700 rounded-lg overflow-hidden" data-accordion=collapse data-accordion-separated=false><details class=border-none data-accordion-item open><summary class="flex w-full cursor-pointer items-center justify-between gap-4 px-4 py-3 text-left text-lg font-semibold text-neutral-900 dark:text-neutral-100"><span class="flex items-center gap-2"><span>Using match where term is correct</span>
</span><span><span class="relative block icon"><svg viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></summary><div class="px-4 pb-4 text-neutral-700 dark:text-neutral-300"><code>match</code> analyzes the query string. If you run <code>match</code> on a <code>keyword</code> field with a value like <code>"widgets"</code>, you may get unexpected results because the analysis pipeline transforms the query. For exact-value matching on <code>keyword</code>, <code>boolean</code>, or <code>numeric</code> fields, always use <code>term</code> or <code>terms</code> inside a <code>filter</code> clause.</div></details><details class=border-none data-accordion-item><summary class="flex w-full cursor-pointer items-center justify-between gap-4 px-4 py-3 text-left text-lg font-semibold text-neutral-900 dark:text-neutral-100"><span class="flex items-center gap-2"><span>Dynamic mapping explosion</span>
</span><span><span class="relative block icon"><svg viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></summary><div class="px-4 pb-4 text-neutral-700 dark:text-neutral-300">If you index arbitrary JSON with unknown keys, dynamic mapping creates a new field for every unique key. This can balloon your mapping to thousands of fields, causing memory pressure on the cluster and degrading query performance. Either define explicit mappings or use <code>dynamic: "strict"</code> to reject unknown fields.</div></details><details class=border-none data-accordion-item><summary class="flex w-full cursor-pointer items-center justify-between gap-4 px-4 py-3 text-left text-lg font-semibold text-neutral-900 dark:text-neutral-100"><span class="flex items-center gap-2"><span>Not using filter for non-scoring criteria</span>
</span><span><span class="relative block icon"><svg viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></summary><div class="px-4 pb-4 text-neutral-700 dark:text-neutral-300">Putting range and term conditions in <code>must</code> instead of <code>filter</code> forces Elasticsearch to compute BM25 scores for every matching document, then discard them. Filter clauses are not scored and are cached. This is a 2-10x performance difference for common dashboard queries.</div></details><details class=border-none data-accordion-item><summary class="flex w-full cursor-pointer items-center justify-between gap-4 px-4 py-3 text-left text-lg font-semibold text-neutral-900 dark:text-neutral-100"><span class="flex items-center gap-2"><span>Storing large binary data in documents</span>
</span><span><span class="relative block icon"><svg viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></summary><div class="px-4 pb-4 text-neutral-700 dark:text-neutral-300">Elasticsearch is not an object store. Indexing large binary payloads (PDF content, base64-encoded images) in document fields bloats the index, slows replication, and kills heap utilization. Store binaries in S3 and keep only the extracted text and metadata in Elasticsearch.</div></details><details class=border-none data-accordion-item><summary class="flex w-full cursor-pointer items-center justify-between gap-4 px-4 py-3 text-left text-lg font-semibold text-neutral-900 dark:text-neutral-100"><span class="flex items-center gap-2"><span>Confusing aggregations with indexed data structures</span>
</span><span><span class="relative block icon"><svg viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></summary><div class="px-4 pb-4 text-neutral-700 dark:text-neutral-300">The original post on this blog placed <code>"aggs"</code> inside a <code>PUT</code> mapping body. That is invalid. Aggregations are query-time operations sent with <code>GET /&lt;index>/_search</code>. You cannot pre-aggregate at write time through the mapping API. If you need pre-aggregated data for performance, use transform jobs or roll-up indices.</div></details></div><style>#accordion-b52a3094290d27d49f6794a9fcd33279>details+details{border-top:1px solid rgb(var(--color-neutral-200))}.dark #accordion-b52a3094290d27d49f6794a9fcd33279>details+details{border-top-color:rgb(var(--color-neutral-700))}</style><script>(()=>{const e=document.getElementById("accordion-b52a3094290d27d49f6794a9fcd33279");if(!e)return;const t=e.querySelectorAll("details[data-accordion-item]");t.forEach(e=>{e.addEventListener("toggle",()=>{if(!e.open)return;t.forEach(t=>{t!==e&&t.removeAttribute("open")})})})})()</script><hr><p>If you want to go deeper on any of this, I offer 1:1 coaching sessions for engineers working on AI integration, cloud architecture, and platform engineering. <a href=https://calendly.com/manuelfedele/60min target=_blank rel=noreferrer>Book a session</a> (50 EUR / 60 min) or reach out at <a href=mailto:manuel.fedele+website@gmail.com>manuel.fedele+website@gmail.com</a>.</p></div><h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2><section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3"><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src="https://images.unsplash.com/photo-1655720828018-edd2daec9349?w=1200&amp;q=85" role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/posts/work-with-json-postgresql/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>PostgreSQL JSONB: Flexible Schema, Indexing, and When to Use It</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2022-12-19T18:20:30+01:00>19 December 2022</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">9 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/tags/postgresql/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">PostgreSQL
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/databases/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Databases
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/backend/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Backend</span></span></a></div></div></div><div class="px-6 pt-4 pb-2"></div></article><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src="https://images.unsplash.com/photo-1574169208507-84376144848b?w=1200&amp;q=85" role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/posts/what-does-yield-keyword-do-in-python/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>Python Generators and yield: Building Memory-Efficient Pipelines</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2022-12-29T10:19:25+01:00>29 December 2022</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">8 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/tags/python/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Python
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/performance/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Performance
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/backend/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Backend</span></span></a></div></div></div><div class="px-6 pt-4 pb-2"></div></article></section></div></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span class="flex flex-col"><a class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/posts/unit-testing-in-golang/><span class=leading-6><span class="inline-block rtl:rotate-180">&larr;</span>&ensp;Testing in Go: From Unit Tests to Mocks and Benchmarks
</span></a><span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2023-01-09T20:49:03+01:00>9 January 2023</time>
</span></span><span class="flex flex-col items-end"><a class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/posts/trading-with-alpaca-and-golang/><span class=leading-6>Algorithmic Trading with Alpaca and Go: Paper Trading and Real-Time Data&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
</span></a><span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2023-01-15T19:24:09+01:00>15 January 2023</time></span></span></div></div></footer></article><div id=scroll-to-top class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200"><a href=#the-top class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2026
Manuel Fedele</p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://manuelfedele.github.io/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>