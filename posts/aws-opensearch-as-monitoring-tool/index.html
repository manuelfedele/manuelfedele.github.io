<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=false><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>Aws Opensearch as Monitoring Tool &#183; Git Push and Run</title><meta name=title content="Aws Opensearch as Monitoring Tool &#183; Git Push and Run"><meta name=description content="Software Engineer and Cloud Architect writing about Go, Python, AWS, and AI automation."><meta name=keywords content="AWS,Opensearch,Monitoring,Elasticsearch,Logging,Kibana,Cloudwatch,Lambda,"><link rel=canonical href=https://manuelfedele.github.io/posts/aws-opensearch-as-monitoring-tool/><meta name=author content="Manuel Fedele"><link href=https://github.com/manuelfedele rel=me><link href=https://linkedin.com/in/manuel-fedele rel=me><meta property="og:url" content="https://manuelfedele.github.io/posts/aws-opensearch-as-monitoring-tool/"><meta property="og:site_name" content="Git Push and Run"><meta property="og:title" content="Aws Opensearch as Monitoring Tool"><meta property="og:description" content="In today’s distributed systems, logging and monitoring play a crucial role in detecting anomalies and ensuring system health. AWS Lambda and OpenSearch are often paired to deliver efficient, scalable logging solutions. However, complexities can arise when these resources live in… In today’s distributed systems, logging and monitoring play a crucial role in detecting anomalies and ensuring system health. AWS Lambda and OpenSearch are often paired to deliver efficient, scalable logging solutions. However, complexities can arise when these resources live in separate AWS accounts. This blog post will guide you through the process of sending AWS Lambda logs from Account A to an OpenSearch cluster in Account B using Terraform as the Infrastructure as Code (IAC) tool and GitLab for CI/CD pipelines."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-07-12T08:42:00+02:00"><meta property="article:modified_time" content="2023-07-12T08:42:00+02:00"><meta property="article:tag" content="AWS"><meta property="article:tag" content="Opensearch"><meta property="article:tag" content="Monitoring"><meta property="article:tag" content="Elasticsearch"><meta property="article:tag" content="Logging"><meta property="article:tag" content="Kibana"><meta name=twitter:card content="summary"><meta name=twitter:title content="Aws Opensearch as Monitoring Tool"><meta name=twitter:description content="In today’s distributed systems, logging and monitoring play a crucial role in detecting anomalies and ensuring system health. AWS Lambda and OpenSearch are often paired to deliver efficient, scalable logging solutions. However, complexities can arise when these resources live in… In today’s distributed systems, logging and monitoring play a crucial role in detecting anomalies and ensuring system health. AWS Lambda and OpenSearch are often paired to deliver efficient, scalable logging solutions. However, complexities can arise when these resources live in separate AWS accounts. This blog post will guide you through the process of sending AWS Lambda logs from Account A to an OpenSearch cluster in Account B using Terraform as the Infrastructure as Code (IAC) tool and GitLab for CI/CD pipelines."><link type=text/css rel=stylesheet href=/css/main.bundle.min.726dfbf42bcd66e35e2d7258d72fe8fe77509ff76d153e2b46cdbae9c3af9620653459f0119a72d2af4a9b4bc446652d244ad58743d0290e5d8e09e3983b98e5.css integrity="sha512-cm379CvNZuNeLXJY1y/o/ndQn/dtFT4rRs266cOvliBlNFnwEZpy0q9Km0vERmUtJErVh0PQKQ5djgnjmDuY5Q=="><script type=text/javascript src=/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js integrity="sha512-b0EXSzoFtoCCD+CMrb+l+3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.88278edec77139635e1ad294df5b32b7be9338191c5252d3f6f451ace5852d5f82390cccacedab9c64739d8e068b7e8502895cf8f951060c0368f9a73709fcb7.js integrity="sha512-iCeO3sdxOWNeGtKU31syt76TOBkcUlLT9vRRrOWFLV+COQzMrO2rnGRznY4Gi36FAolc+PlRBgwDaPmnNwn8tw==" data-copy=Copy data-copied=Copied></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Aws Opensearch as Monitoring Tool","headline":"Aws Opensearch as Monitoring Tool","inLanguage":"en","url":"https://manuelfedele.github.io/posts/aws-opensearch-as-monitoring-tool/","author":{"@type":"Person","name":"Manuel Fedele"},"copyrightYear":"2023","dateCreated":"2023-07-12T08:42:00\u002b02:00","datePublished":"2023-07-12T08:42:00\u002b02:00","dateModified":"2023-07-12T08:42:00\u002b02:00","keywords":["AWS","Opensearch","Monitoring","Elasticsearch","Logging","Kibana","Cloudwatch","Lambda"],"mainEntityOfPage":"true","wordCount":"917"}]</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-K9P1DJX238"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-K9P1DJX238")</script></head><body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral bf-scrollbar"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 z-100"><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl bg-neutral/25 dark:bg-neutral-800/25"></div><div class="relative m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32"><div class="main-menu flex items-center w-full gap-2 p-1 pl-0"><a href=/ class="text-base font-medium truncate min-w-0 shrink">Git Push and Run</a><div class="flex items-center ms-auto"><div class="hidden md:flex"><nav class="flex items-center gap-x-5 h-12"><a href=/posts/ class="flex items-center bf-icon-color-hover" aria-label=Blog title=Posts><span class="text-base font-medium break-normal">Blog
</span></a><a href=/about/ class="flex items-center bf-icon-color-hover" aria-label=About title=About><span class="text-base font-medium break-normal">About
</span></a><a href=https://github.com/manuelfedele target=_blank class="flex items-center bf-icon-color-hover" aria-label=github title><span><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><button id=search-button aria-label=Search class="text-base bf-icon-color-hover" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button></nav></div><div class="flex md:hidden"><div class="flex items-center h-14 gap-4"><button id=search-button-mobile aria-label=Search class="flex items-center justify-center bf-icon-color-hover" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<input type=checkbox id=mobile-menu-toggle autocomplete=off class="hidden peer">
<label for=mobile-menu-toggle class="flex items-center justify-center cursor-pointer bf-icon-color-hover"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></label><div role=dialog aria-modal=true style=scrollbar-gutter:stable class="fixed inset-0 z-50 invisible overflow-y-auto px-6 py-20 opacity-0 transition-[opacity,visibility] duration-300 peer-checked:visible peer-checked:opacity-100 bg-neutral-50/97 dark:bg-neutral-900/99
bf-scrollbar"><label for=mobile-menu-toggle class="fixed end-8 top-5 flex items-center justify-center z-50 h-12 w-12 cursor-pointer select-none rounded-full bf-icon-color-hover border bf-border-color bf-border-color-hover bg-neutral-50 dark:bg-neutral-900"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></label><nav class="mx-auto max-w-md space-y-6"><div class=px-2><a href=/posts/ aria-label=Blog class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=Posts class="text-2xl font-bold tracking-tight">Blog</span></a></div><div class=px-2><a href=/about/ aria-label=About class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=About class="text-2xl font-bold tracking-tight">About</span></a></div><div class=px-2><a href=https://github.com/manuelfedele aria-label=github target=_blank class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span class="flex items-center justify-center h-8 w-8 text-2xl"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span><span title class="text-2xl font-bold tracking-tight"></span></a></div></nav></div></div></div></div></div><script>(function(){var t,n,e=document.querySelector(".main-menu");if(!e)return;t=window.location.pathname,n=e.querySelectorAll('a[href="'+t+'"]'),n.forEach(function(e){var t=e.querySelectorAll("span");t.forEach(function(e){e.classList.add("active")})})})()</script></div></div><script type=text/javascript src=/js/background-blur.min.00a57c73ea12f2cab2980c3c3d649e89f6d82f190f74bbe2b67f2f5e39ab7d032ece47086400ca05396758aace13299da49aca43ea643d2625e62c506267a169.js integrity="sha512-AKV8c+oS8sqymAw8PWSeifbYLxkPdLvitn8vXjmrfQMuzkcIZADKBTlnWKrOEymdpJrKQ+pkPSYl5ixQYmehaQ==" data-blur-id=menu-blur></script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Aws Opensearch as Monitoring Tool</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2023-07-12T08:42:00+02:00>12 July 2023</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">5 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/tags/aws/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">AWS
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/opensearch/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Opensearch
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/monitoring/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Monitoring
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/elasticsearch/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Elasticsearch
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/logging/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Logging
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/kibana/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Kibana
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/cloudwatch/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Cloudwatch
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/lambda/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Lambda</span></span></a></div></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ms-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs"><div class="toc ps-5 print:hidden lg:sticky lg:top-[140px]"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain bf-scrollbar rounded-lg -ms-5 ps-5 pe-2 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#step-1-configuring-your-aws-accounts>Step 1: Configuring Your AWS Accounts</a></li><li><a href=#step-2-set-up-opensearch-in-account-b>Step 2: Set Up OpenSearch in Account B</a></li><li><a href=#step-3-setting-up-terraform>Step 3: Setting Up Terraform</a></li><li><a href=#step-4-establishing-trust-relationship>Step 4: Establishing Trust Relationship</a></li><li><a href=#step-5-configure-aws-lambda-to-send-logs>Step 5: Configure AWS Lambda to Send Logs</a></li><li><a href=#step-6-gitlab-cicd>Step 6: GitLab CI/CD</a></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#terraform-and-gitlab-cicd-configuration>Terraform and GitLab CI/CD Configuration</a><ul><li><a href=#terraform-configuration>Terraform Configuration</a></li></ul></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#step-1-configuring-your-aws-accounts>Step 1: Configuring Your AWS Accounts</a></li><li><a href=#step-2-set-up-opensearch-in-account-b>Step 2: Set Up OpenSearch in Account B</a></li><li><a href=#step-3-setting-up-terraform>Step 3: Setting Up Terraform</a></li><li><a href=#step-4-establishing-trust-relationship>Step 4: Establishing Trust Relationship</a></li><li><a href=#step-5-configure-aws-lambda-to-send-logs>Step 5: Configure AWS Lambda to Send Logs</a></li><li><a href=#step-6-gitlab-cicd>Step 6: GitLab CI/CD</a></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#terraform-and-gitlab-cicd-configuration>Terraform and GitLab CI/CD Configuration</a><ul><li><a href=#terraform-configuration>Terraform Configuration</a></li></ul></li></ul></nav></div></details><script>(function(){"use strict";const s=.33,o="#TableOfContents",i=".anchor",a='a[href^="#"]',r="li ul",c="active";let t=!1;function l(e,n){const o=window.scrollY+window.innerHeight*n,i=[...document.querySelectorAll('#TableOfContents a[href^="#"]')],s=new Set(i.map(e=>e.getAttribute("href").substring(1)));if(t)for(let t=0;t<e.length;t++){const n=e[t];if(!s.has(n.id))continue;const o=n.getBoundingClientRect().top+window.scrollY;if(Math.abs(window.scrollY-o)<100)return n.id}for(let t=e.length-1;t>=0;t--){const n=e[t].getBoundingClientRect().top+window.scrollY;if(n<=o&&s.has(e[t].id))return e[t].id}return e.find(e=>s.has(e.id))?.id||""}function e({toc:e,anchors:t,links:n,scrollOffset:s,collapseInactive:o}){const i=l(t,s);if(!i)return;if(n.forEach(e=>{const t=e.getAttribute("href")===`#${i}`;if(e.classList.toggle(c,t),o){const n=e.closest("li")?.querySelector("ul");n&&(n.style.display=t?"":"none")}}),o){const n=e.querySelector(`a[href="#${CSS.escape(i)}"]`);let t=n;for(;t&&t!==e;)t.tagName==="UL"&&(t.style.display=""),t.tagName==="LI"&&t.querySelector("ul")?.style.setProperty("display",""),t=t.parentElement}}function n(){const n=document.querySelector(o);if(!n)return;const l=!0,u=[...document.querySelectorAll(i)],d=[...n.querySelectorAll(a)];l&&n.querySelectorAll(r).forEach(e=>e.style.display="none"),d.forEach(e=>{e.addEventListener("click",()=>{t=!0})});const c={toc:n,anchors:u,links:d,scrollOffset:s,collapseInactive:l};window.addEventListener("scroll",()=>e(c),{passive:!0}),window.addEventListener("hashchange",()=>e(c),{passive:!0}),e(c)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",n):n()})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><div class="lead text-neutral-500 dark:text-neutral-400 !mb-9 text-xl">In today&rsquo;s distributed systems, logging and monitoring play a crucial role in detecting anomalies and ensuring system health. AWS Lambda and OpenSearch are often paired to deliver efficient, scalable logging solutions. However, complexities can arise when these resources live in&mldr;</div><p>In today&rsquo;s distributed systems, logging and monitoring play a crucial role in detecting anomalies and ensuring system health. AWS Lambda and OpenSearch are often paired to deliver efficient, scalable logging solutions. However, complexities can arise when these resources live in separate AWS accounts. This blog post will guide you through the process of sending AWS Lambda logs from Account A to an OpenSearch cluster in Account B using Terraform as the Infrastructure as Code (IAC) tool and GitLab for CI/CD pipelines.</p><h2 class="relative group">Prerequisites<div id=prerequisites class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#prerequisites aria-label=Anchor>#</a></span></h2><ol><li>Two AWS accounts (Account A for AWS Lambda and Account B for OpenSearch)</li><li>A GitLab account with runners provisioned on AWS for CI/CD pipelines</li><li>Terraform installed on your system</li><li>Basic understanding of AWS Lambda, OpenSearch, AWS IAM, GitLab, and Terraform</li></ol><h2 class="relative group">Step 1: Configuring Your AWS Accounts<div id=step-1-configuring-your-aws-accounts class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#step-1-configuring-your-aws-accounts aria-label=Anchor>#</a></span></h2><p>Before proceeding, ensure that both AWS accounts are correctly set up, and you have the necessary access permissions. We will also need an IAM role in Account B with the necessary permissions to access the OpenSearch cluster.</p><p>In Account A, create an AWS Lambda function. Be sure to attach the necessary IAM role and policy, enabling the function to create and write logs to AWS CloudWatch.</p><h2 class="relative group">Step 2: Set Up OpenSearch in Account B<div id=step-2-set-up-opensearch-in-account-b class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#step-2-set-up-opensearch-in-account-b aria-label=Anchor>#</a></span></h2><p>Next, in Account B, set up an OpenSearch cluster. The cluster should be correctly configured to receive logs from an external account. In addition, you should create an IAM role that allows the Log Stream from Account A to write to this cluster.</p><h2 class="relative group">Step 3: Setting Up Terraform<div id=step-3-setting-up-terraform class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#step-3-setting-up-terraform aria-label=Anchor>#</a></span></h2><p>Terraform is a powerful tool for managing infrastructure as code. With Terraform, you can define and provide data center infrastructure using a declarative configuration language.</p><p>Create a new Terraform project and define your AWS resources, including your Lambda function and OpenSearch cluster. Be sure to use the provider alias feature of Terraform to manage resources in multiple AWS accounts.</p><p>Remember to include the necessary resource blocks, such as <code>aws_lambda_function</code> and <code>aws_elasticsearch_domain</code>, depending on your requirements.</p><h2 class="relative group">Step 4: Establishing Trust Relationship<div id=step-4-establishing-trust-relationship class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#step-4-establishing-trust-relationship aria-label=Anchor>#</a></span></h2><p>Establish a trust relationship between Account A (Lambda) and Account B (OpenSearch) using an IAM role in Account B. This role should have a trust policy that allows Account A to assume it, and a permissions policy that allows writing to OpenSearch. Use the &lsquo;aws_iam_role&rsquo; and &lsquo;aws_iam_role_policy&rsquo; Terraform resources to create this.</p><h2 class="relative group">Step 5: Configure AWS Lambda to Send Logs<div id=step-5-configure-aws-lambda-to-send-logs class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#step-5-configure-aws-lambda-to-send-logs aria-label=Anchor>#</a></span></h2><p>With the trust relationship set up, configure your Lambda function in Account A to send logs to CloudWatch Logs. From there, use a CloudWatch Logs subscription filter to redirect these logs to the OpenSearch cluster in Account B.</p><p>The subscription filter should use the ARN of the IAM role in Account B, allowing it to forward logs across accounts.</p><h2 class="relative group">Step 6: GitLab CI/CD<div id=step-6-gitlab-cicd class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#step-6-gitlab-cicd aria-label=Anchor>#</a></span></h2><p>The final step involves integrating our setup with GitLab&rsquo;s CI/CD. We will create a pipeline that uses AWS-provisioned runners to apply our Terraform configuration, creating or updating our infrastructure.</p><p>In your GitLab repository, define a <code>.gitlab-ci.yml</code> file that describes the stages of your pipeline, including steps for &ldquo;init&rdquo;, &ldquo;validate&rdquo;, &ldquo;plan&rdquo;, and &ldquo;apply&rdquo;. Your runners will execute these steps to deploy your infrastructure.</p><h2 class="relative group">Conclusion<div id=conclusion class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#conclusion aria-label=Anchor>#</a></span></h2><p>This post has covered a high-level guide on shipping AWS Lambda logs from one AWS account to an OpenSearch cluster in another. By integrating AWS services, Terraform, and GitLab, you can create a seamless logging solution that spans across multiple AWS accounts. Remember that while this setup works, it&rsquo;s crucial to tailor it to your organization&rsquo;s needs, considering factors like security, scale, and compliance. Happy logging!</p><h2 class="relative group">Terraform and GitLab CI/CD Configuration<div id=terraform-and-gitlab-cicd-configuration class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#terraform-and-gitlab-cicd-configuration aria-label=Anchor>#</a></span></h2><p>Below is a basic outline of Terraform and GitLab CI/CD configurations that facilitate the shipping of AWS Lambda logs from one AWS account to an OpenSearch cluster in another.</p><h3 class="relative group">Terraform Configuration<div id=terraform-configuration class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#terraform-configuration aria-label=Anchor>#</a></span></h3><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#616e87;font-style:italic># Account A - provider.tf</span>
</span></span><span style=display:flex><span>provider <span style=color:#a3be8c>&#34;aws&#34;</span> <span style=color:#81a1c1>{</span>
</span></span><span style=display:flex><span>  region  <span style=color:#81a1c1>=</span> <span style=color:#a3be8c>&#34;us-west-2&#34;</span>
</span></span><span style=display:flex><span>  profile <span style=color:#81a1c1>=</span> <span style=color:#a3be8c>&#34;accountA&#34;</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic># Account A - lambda.tf</span>
</span></span><span style=display:flex><span>resource <span style=color:#a3be8c>&#34;aws_lambda_function&#34;</span> <span style=color:#a3be8c>&#34;example&#34;</span> <span style=color:#81a1c1>{</span>
</span></span><span style=display:flex><span>  function_name <span style=color:#81a1c1>=</span> <span style=color:#a3be8c>&#34;example&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  filename         <span style=color:#81a1c1>=</span> <span style=color:#a3be8c>&#34;lambda_function_payload.zip&#34;</span>
</span></span><span style=display:flex><span>  source_code_hash <span style=color:#81a1c1>=</span> filebase64sha256<span style=color:#81a1c1>(</span><span style=color:#a3be8c>&#34;lambda_function_payload.zip&#34;</span><span style=color:#81a1c1>)</span>
</span></span><span style=display:flex><span>  handler          <span style=color:#81a1c1>=</span> <span style=color:#a3be8c>&#34;exports.test&#34;</span>
</span></span><span style=display:flex><span>  role             <span style=color:#81a1c1>=</span> aws_iam_role.lambda_exec.arn
</span></span><span style=display:flex><span>  runtime          <span style=color:#81a1c1>=</span> <span style=color:#a3be8c>&#34;nodejs12.x&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  publish <span style=color:#81a1c1>=</span> <span style=color:#81a1c1>true</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>resource <span style=color:#a3be8c>&#34;aws_iam_role&#34;</span> <span style=color:#a3be8c>&#34;lambda_exec&#34;</span> <span style=color:#81a1c1>{</span>
</span></span><span style=display:flex><span>  name <span style=color:#81a1c1>=</span> <span style=color:#a3be8c>&#34;lambda_exec_role&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  assume_role_policy <span style=color:#81a1c1>=</span> <span style=color:#a3be8c>&lt;&lt;EOF
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>{
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>  &#34;Version&#34;: &#34;2012-10-17&#34;,
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>  &#34;Statement&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>    {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      &#34;Action&#34;: &#34;sts:AssumeRole&#34;,
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      &#34;Principal&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        &#34;Service&#34;: &#34;lambda.amazonaws.com&#34;
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      },
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      &#34;Effect&#34;: &#34;Allow&#34;,
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      &#34;Sid&#34;: &#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>    }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>  ]
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>}
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>EOF</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>resource <span style=color:#a3be8c>&#34;aws_cloudwatch_log_group&#34;</span> <span style=color:#a3be8c>&#34;example&#34;</span> <span style=color:#81a1c1>{</span>
</span></span><span style=display:flex><span>  name              <span style=color:#81a1c1>=</span> <span style=color:#a3be8c>&#34;/aws/lambda/</span><span style=color:#a3be8c>${</span>aws_lambda_function<span style=color:#eceff4>.example.function_name</span><span style=color:#a3be8c>}</span><span style=color:#a3be8c>&#34;</span>
</span></span><span style=display:flex><span>  retention_in_days <span style=color:#81a1c1>=</span> <span style=color:#b48ead>14</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic># Account B - provider.tf</span>
</span></span><span style=display:flex><span>provider <span style=color:#a3be8c>&#34;aws&#34;</span> <span style=color:#81a1c1>{</span>
</span></span><span style=display:flex><span>  region  <span style=color:#81a1c1>=</span> <span style=color:#a3be8c>&#34;us-west-2&#34;</span>
</span></span><span style=display:flex><span>  profile <span style=color:#81a1c1>=</span> <span style=color:#a3be8c>&#34;accountB&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#81a1c1>alias</span>   <span style=color:#81a1c1>=</span> <span style=color:#a3be8c>&#34;accountB&#34;</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic># Account B - opensearch.tf</span>
</span></span><span style=display:flex><span>provider <span style=color:#a3be8c>&#34;aws&#34;</span> <span style=color:#81a1c1>{</span>
</span></span><span style=display:flex><span>  <span style=color:#81a1c1>alias</span>  <span style=color:#81a1c1>=</span> <span style=color:#a3be8c>&#34;accountB&#34;</span>
</span></span><span style=display:flex><span>  region <span style=color:#81a1c1>=</span> <span style=color:#a3be8c>&#34;us-west-2&#34;</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>resource <span style=color:#a3be8c>&#34;aws_elasticsearch_domain&#34;</span> <span style=color:#a3be8c>&#34;example&#34;</span> <span style=color:#81a1c1>{</span>
</span></span><span style=display:flex><span>  provider                  <span style=color:#81a1c1>=</span> aws.accountB
</span></span><span style=display:flex><span>  domain_name               <span style=color:#81a1c1>=</span> <span style=color:#a3be8c>&#34;example&#34;</span>
</span></span><span style=display:flex><span>  elasticsearch_version     <span style=color:#81a1c1>=</span> <span style=color:#a3be8c>&#34;7.1&#34;</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>resource <span style=color:#a3be8c>&#34;aws_iam_role&#34;</span> <span style=color:#a3be8c>&#34;cross_account_role&#34;</span> <span style=color:#81a1c1>{</span>
</span></span><span style=display:flex><span>  name <span style=color:#81a1c1>=</span> <span style=color:#a3be8c>&#34;cross_account_role&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  assume_role_policy <span style=color:#81a1c1>=</span> <span style=color:#a3be8c>&lt;&lt;POLICY
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>{
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>  &#34;Version&#34;: &#34;2012-10-17&#34;,
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>  &#34;Statement&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>    {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      &#34;Sid&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      &#34;Effect&#34;: &#34;Allow&#34;,
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      &#34;Principal&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        &#34;AWS&#34;: &#34;arn:aws:iam::&lt;AccountA_ID&gt;:root&#34;
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      },
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      &#34;Action&#34;: &#34;sts:AssumeRole&#34;
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>    }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>  ]
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>}
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>POLICY</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>resource <span style=color:#a3be8c>&#34;aws_iam_role_policy&#34;</span> <span style=color:#a3be8c>&#34;policy&#34;</span> <span style=color:#81a1c1>{</span>
</span></span><span style=display:flex><span>  name <span style=color:#81a1c1>=</span> <span style=color:#a3be8c>&#34;cross_account_policy&#34;</span>
</span></span><span style=display:flex><span>  role <span style=color:#81a1c1>=</span> aws_iam_role.cross_account_role.id
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  policy <span style=color:#81a1c1>=</span> <span style=color:#a3be8c>&lt;&lt;POLICY
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>{
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>  &#34;Version&#34;: &#34;2012-10-17&#34;,
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>  &#34;Statement&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>    {
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      &#34;Effect&#34;: &#34;Allow&#34;,
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      &#34;Action&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>        &#34;es:*&#34;
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      ],
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>      &#34;Resource&#34;: &#34;${aws_elasticsearch_domain.example.arn}/*&#34;
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>    }
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>  ]
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>}
</span></span></span><span style=display:flex><span><span style=color:#a3be8c>POLICY</span>
</span></span><span style=display:flex><span><span style=color:#81a1c1>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#616e87;font-style:italic># GitLab - .gitlab-ci.yml</span>
</span></span><span style=display:flex><span>stages:
</span></span><span style=display:flex><span>  - init
</span></span><span style=display:flex><span>  - validate
</span></span><span style=display:flex><span>  - plan
</span></span><span style=display:flex><span>  - apply
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>variables:
</span></span><span style=display:flex><span>  AWS_DEFAULT_REGION: <span style=color:#a3be8c>&#34;us-west-2&#34;</span>
</span></span><span style=display:flex><span>  AWS_ACCESS_KEY_ID: <span style=color:#a3be8c>&#34;&lt;access_key&gt;&#34;</span>
</span></span><span style=display:flex><span>  AWS_SECRET_ACCESS_KEY: <span style=color:#a3be8c>&#34;&lt;secret_key&gt;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>init:
</span></span><span style=display:flex><span>  stage: init
</span></span><span style=display:flex><span>  script:
</span></span><span style=display:flex><span>    - terraform init
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>validate:
</span></span><span style=display:flex><span>  stage: validate
</span></span><span style=display:flex><span>  script:
</span></span><span style=display:flex><span>    - terraform validate
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plan:
</span></span><span style=display:flex><span>  stage: plan
</span></span><span style=display:flex><span>  script:
</span></span><span style=display:flex><span>    - terraform plan
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>apply:
</span></span><span style=display:flex><span>  stage: apply
</span></span><span style=display:flex><span>  script:
</span></span><span style=display:flex><span>    - terraform apply -auto-approve</span></span></code></pre></div></div></div></div></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span class="flex flex-col"><a class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/posts/the-single-responsibility-principle/><span class=leading-6><span class="inline-block rtl:rotate-180">&larr;</span>&ensp;The Single Responsibility Principle
</span></a><span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2023-03-21T15:10:03+01:00>21 March 2023</time>
</span></span><span class="flex flex-col items-end"><a class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/posts/clipboard-watch-remove-accidentally-typed-passwords/><span class=leading-6>Clipboard Watch Remove Accidentally Typed Passwords&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
</span></a><span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2023-11-26T11:29:46+01:00>26 November 2023</time></span></span></div></div></footer></article><div id=scroll-to-top class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200"><a href=#the-top class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2026
Manuel Fedele</p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://manuelfedele.github.io/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>