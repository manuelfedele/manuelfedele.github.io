<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator | Git Push and Run</title><meta name=keywords content="AI,python,django,react,AWS,GitLab,LLM,DevOps,SRE,architecture"><meta name=description content="Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator
What if your on-call engineer never slept, had instant access to every repository and every AWS account, and could trace a production issue from DNS to database in under a minute?
That&rsquo;s the question that led me to build TARS, an AI-powered SRE assistant that autonomously investigates infrastructure issues by combining LLM reasoning with deep integrations into GitLab and AWS. Named after the robot from Interstellar (because every good internal tool needs a movie reference), TARS is a full-stack application where engineers interact with an AI agent through a chat interface. The agent doesn&rsquo;t just answer questions. It investigates. It clones repos, greps code, reads CloudWatch logs, traces DNS chains, inspects ECS services, and synthesizes findings into structured reports."><meta name=author content><link rel=canonical href=https://manuelfedele.github.io/posts/building-ai-sre-assistant-from-scratch/><link crossorigin=anonymous href=/assets/css/stylesheet.c2189e7d36d72767de292f8b9d897e4a464aa5bc7eb692cda50064f5eb9eeece.css integrity="sha256-whiefTbXJ2feKS+LnYl+SkZKpbx+tpLNpQBk9eue7s4=" rel="preload stylesheet" as=style><link rel=icon href=https://manuelfedele.github.io/img/favicon.png><link rel=icon type=image/png sizes=16x16 href=https://manuelfedele.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://manuelfedele.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://manuelfedele.github.io/img/apple-touch-icon-144-precomposed.png><link rel=mask-icon href=https://manuelfedele.github.io/img/favicon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://manuelfedele.github.io/posts/building-ai-sre-assistant-from-scratch/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta name=google-site-verification content="bNHRtbwz1iqFFQ60i1jOBm2U7WHWMc8LgejU7wLaDSs"><script async src="https://www.googletagmanager.com/gtag/js?id=G-K9P1DJX238"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-K9P1DJX238")}</script><meta property="og:url" content="https://manuelfedele.github.io/posts/building-ai-sre-assistant-from-scratch/"><meta property="og:site_name" content="Git Push and Run"><meta property="og:title" content="Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator"><meta property="og:description" content="Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator What if your on-call engineer never slept, had instant access to every repository and every AWS account, and could trace a production issue from DNS to database in under a minute?
That’s the question that led me to build TARS, an AI-powered SRE assistant that autonomously investigates infrastructure issues by combining LLM reasoning with deep integrations into GitLab and AWS. Named after the robot from Interstellar (because every good internal tool needs a movie reference), TARS is a full-stack application where engineers interact with an AI agent through a chat interface. The agent doesn’t just answer questions. It investigates. It clones repos, greps code, reads CloudWatch logs, traces DNS chains, inspects ECS services, and synthesizes findings into structured reports."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-02-22T09:30:00+01:00"><meta property="article:modified_time" content="2026-02-22T09:30:00+01:00"><meta property="article:tag" content="AI"><meta property="article:tag" content="Python"><meta property="article:tag" content="Django"><meta property="article:tag" content="React"><meta property="article:tag" content="AWS"><meta property="article:tag" content="GitLab"><meta property="og:image" content="https://manuelfedele.github.io/img/card-pillow.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://manuelfedele.github.io/img/card-pillow.jpg"><meta name=twitter:title content="Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator"><meta name=twitter:description content="Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator
What if your on-call engineer never slept, had instant access to every repository and every AWS account, and could trace a production issue from DNS to database in under a minute?
That&rsquo;s the question that led me to build TARS, an AI-powered SRE assistant that autonomously investigates infrastructure issues by combining LLM reasoning with deep integrations into GitLab and AWS. Named after the robot from Interstellar (because every good internal tool needs a movie reference), TARS is a full-stack application where engineers interact with an AI agent through a chat interface. The agent doesn&rsquo;t just answer questions. It investigates. It clones repos, greps code, reads CloudWatch logs, traces DNS chains, inspects ECS services, and synthesizes findings into structured reports."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://manuelfedele.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator","item":"https://manuelfedele.github.io/posts/building-ai-sre-assistant-from-scratch/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator","name":"Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator","description":"Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator What if your on-call engineer never slept, had instant access to every repository and every AWS account, and could trace a production issue from DNS to database in under a minute?\nThat\u0026rsquo;s the question that led me to build TARS, an AI-powered SRE assistant that autonomously investigates infrastructure issues by combining LLM reasoning with deep integrations into GitLab and AWS. Named after the robot from Interstellar (because every good internal tool needs a movie reference), TARS is a full-stack application where engineers interact with an AI agent through a chat interface. The agent doesn\u0026rsquo;t just answer questions. It investigates. It clones repos, greps code, reads CloudWatch logs, traces DNS chains, inspects ECS services, and synthesizes findings into structured reports.\n","keywords":["AI","python","django","react","AWS","GitLab","LLM","DevOps","SRE","architecture"],"articleBody":"Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator What if your on-call engineer never slept, had instant access to every repository and every AWS account, and could trace a production issue from DNS to database in under a minute?\nThat’s the question that led me to build TARS, an AI-powered SRE assistant that autonomously investigates infrastructure issues by combining LLM reasoning with deep integrations into GitLab and AWS. Named after the robot from Interstellar (because every good internal tool needs a movie reference), TARS is a full-stack application where engineers interact with an AI agent through a chat interface. The agent doesn’t just answer questions. It investigates. It clones repos, greps code, reads CloudWatch logs, traces DNS chains, inspects ECS services, and synthesizes findings into structured reports.\nIn this post I’ll walk through every layer of the architecture: the authentication system, the agent framework, the tool registry, the streaming infrastructure, the frontend, and the deployment patterns that make it all work in production.\nThe TARS login screen. Microsoft Entra ID SSO provides zero-friction authentication for the engineering team.\nTable of Contents The Problem Architecture Overview Tech Stack Authentication: Four Layers Deep The Agent System Tool Registry: 30+ Specialized Tools Sub-Agent Architecture Security Model Streaming Infrastructure The Frontend KPI Dashboard Memory and Context Management Database Design Deployment Lessons Learned The Problem Platform teams at scale face a recurring challenge: investigating production issues requires correlating information across multiple systems. A typical investigation might look like:\nSomeone reports a 503 error on a service You check the ALB target group health Targets are unhealthy, so you check the ECS service ECS shows a deployment in progress, so you check the task definition The image tag points to a commit, so you check GitLab The last MR changed a health check endpoint, so you read the code The code has a bug in the new health check, so you check CloudWatch logs to confirm Logs confirm the error, you write up the finding Each step requires switching context, authenticating to a different system, navigating a different UI, and mentally correlating the results. For an experienced engineer, this takes 15-30 minutes. For a junior engineer, it can take hours, and they might miss steps entirely.\nTARS automates this entire workflow. You type “investigate the 503 errors on service X” and the agent autonomously:\nFinds the service in GitLab Reads the repository structure and configuration Identifies the AWS account and region Checks ALB target health, ECS service status, and recent deployments Reads CloudWatch logs for error patterns Checks recent MRs and commits for relevant changes Correlates all findings and presents a structured report The key insight is that SRE investigation is largely procedural. The steps follow patterns. What makes a good SRE isn’t memorizing those patterns, it’s knowing which patterns to apply and how to interpret the results. That’s exactly what LLMs excel at.\nArchitecture Overview TARS is a monolith deployed as a single container. The architecture is intentionally simple:\nVPN -\u003e Internal ALB (HTTPS/443, TLS 1.3) | v ECS Fargate (port 8080) | v Nginx (port 8080) / \\ /assets/* /api/* (static SPA) (reverse proxy) | v Uvicorn (port 8000) Django ASGI / | \\ PostgreSQL Redis AWS Bedrock (Aurora) (ElastiCache) (AgentCore Memory) The frontend is a React SPA served by Nginx. API requests are proxied to the Django backend running on Uvicorn with ASGI support (critical for SSE streaming). PostgreSQL stores users, sessions, chat history, and KPI snapshots. Redis caches AWS credentials, GitLab API responses, and computed dashboard data. AWS Bedrock AgentCore provides persistent memory across sessions.\nWhy a monolith? Because the operational complexity of a microservice architecture is not justified when you have a single team, a single deployment target, and a single user-facing application. The monolith deploys in seconds, has one set of logs to check, and one service to monitor. If it ever needs to be split, the code is modular enough to extract services later.\nTech Stack Backend:\nPython 3.12+ with Django 6.0 Async support via adrf (async Django REST Framework) Uvicorn as the ASGI server strands-agents for the AI agent framework httpx for async HTTP clients msal for Microsoft Entra ID OAuth2 requests-ntlm for ADFS/SAML corporate auth pyotp for TOTP generation Fernet encryption for credential storage Frontend:\nReact 19 with TypeScript 5 Vite 7 as the build tool Tailwind CSS 3 for styling Radix UI for accessible primitives Framer Motion for animations Recharts for data visualization React Hook Form + Zod for form validation SSE (Server-Sent Events) for real-time streaming Infrastructure:\nAWS ECS Fargate (Spot + On-Demand) Aurora PostgreSQL Serverless v2 ElastiCache Redis Internal ALB with WAF Terraform for IaC Docker multi-stage build (Node 20 Alpine + Python 3.13 slim) Authentication: Four Layers Deep Authentication in TARS isn’t just about identifying the user. It’s about establishing trust chains across four distinct systems: the application itself, GitLab, AWS (via corporate SAML federation), and the LLM Gateway (via Keycloak). Each layer serves a different purpose, and each requires its own credential management.\nLayer 1: Microsoft Entra ID (User Identity) The primary authentication uses OAuth2 Authorization Code flow with PKCE:\n# Simplified OAuth2 PKCE flow class AuthCallbackView(APIView): async def post(self, request): code = request.data[\"code\"] code_verifier = request.data[\"code_verifier\"] # Exchange authorization code for tokens msal_app = ConfidentialClientApplication( client_id=settings.ENTRA_CLIENT_ID, authority=f\"https://login.microsoftonline.com/{settings.ENTRA_TENANT_ID}\", client_credential=settings.ENTRA_CLIENT_SECRET, ) result = msal_app.acquire_token_by_authorization_code( code=code, scopes=[\"User.Read\"], redirect_uri=settings.ENTRA_REDIRECT_URI, code_verifier=code_verifier, ) # Validate the ID token signature against Microsoft JWKS id_token = validate_and_decode_token(result[\"id_token\"]) # Create or update user user, _ = await User.objects.aupdate_or_create( entra_id=id_token[\"oid\"], defaults={\"display_name\": id_token[\"name\"]}, ) # Create session with sliding window expiry session = await UserSession.objects.acreate( user=user, expires_at=now() + timedelta(hours=24), ) # Set HttpOnly, Secure, SameSite=Strict cookie response = Response({\"user\": UserSerializer(user).data}) response.set_cookie( \"session_id\", session.token, httponly=True, secure=True, samesite=\"Strict\", max_age=86400, ) return response The PKCE flow prevents authorization code interception attacks. The session cookie is HttpOnly (no JavaScript access), Secure (HTTPS only), and SameSite=Strict (no CSRF). Session expiry uses a sliding window: each authenticated request extends the session, but only if at least 300 seconds have passed since the last extension (to avoid hammering the database on every request).\nLayer 2: GitLab (Repository Access) Users configure their GitLab personal access token in the Settings page. The token is encrypted with Fernet symmetric encryption before storage:\nclass EncryptedCharField(models.CharField): \"\"\"Transparently encrypts/decrypts field values using Fernet.\"\"\" def __init__(self, *args, **kwargs): self.fernet = Fernet(settings.FIELD_ENCRYPTION_KEY) super().__init__(*args, **kwargs) def get_prep_value(self, value): if value: return self.fernet.encrypt(value.encode()).decode() return value def from_db_value(self, value, expression, connection): if value: return self.fernet.decrypt(value.encode()).decode() return value The encryption key is derived from DJANGO_SECRET_KEY and stored in AWS Secrets Manager. This means even if the database is compromised, the tokens are unreadable without the application secret.\nLayer 3: AWS SAML Federation (Infrastructure Access) This is the most complex authentication layer. Engineers need access to 100+ AWS accounts, each with multiple roles. Rather than managing individual IAM users, TARS authenticates via the corporate SAML federation chain:\nUser credentials -\u003e Corporate ADFS (NTLM) -\u003e SAML assertion -\u003e Keycloak (SAML relay + OTP) -\u003e AWS SAML response -\u003e STS AssumeRoleWithSAML -\u003e Temporary credentials The AWS authentication settings. Users provide corporate credentials and an optional OTP secret for automatic re-authentication.\nclass AWSSAMLAuthenticator: \"\"\"Authenticates to AWS via corporate SAML federation.\"\"\" async def authenticate(self, username, password, otp=None): # Step 1: Authenticate against corporate ADFS session = requests.Session() session.auth = HttpNtlmAuth( f\"CORP\\\\{username}\", password ) adfs_response = session.get( ADFS_URL, params={\"loginToRp\": KEYCLOAK_ENTITY_ID}, ) # Step 2: Extract SAML assertion from ADFS response saml_assertion = self._extract_saml(adfs_response.text) # Step 3: Submit SAML to Keycloak with OTP kc_response = session.post( KEYCLOAK_SAML_ENDPOINT, data={ \"SAMLResponse\": saml_assertion, \"otp\": otp or pyotp.TOTP(otp_secret).now(), }, ) # Step 4: Extract AWS roles from final SAML response aws_saml = self._extract_aws_saml(kc_response.text) roles = self._parse_aws_roles(aws_saml) # Step 5: Assume each role via STS credentials = {} sts = boto3.client(\"sts\") for role_arn, provider_arn in roles: creds = sts.assume_role_with_saml( RoleArn=role_arn, PrincipalArn=provider_arn, SAMLAssertion=aws_saml, ) credentials[role_arn] = creds[\"Credentials\"] # Cache credentials in Redis with TTL await self._cache_credentials(credentials) return {\"accounts\": len(set(r.split(\":\")[4] for r, _ in roles)), \"roles\": len(roles)} When the OTP secret is configured, TARS can automatically re-authenticate when credentials expire, making the AWS access seamless. The temporary credentials are cached in Redis with a TTL matching their STS expiration. The agent can then assume different roles on demand to investigate resources across any AWS account.\nLayer 4: Keycloak (LLM Gateway Access) The credentials settings page. Each integration has its own encrypted credential store.\nThe LLM Gateway that provides access to GPT models requires Keycloak authentication. Users configure their Keycloak credentials, and TARS obtains OAuth2 tokens on their behalf:\nasync def get_llm_gateway_token(user_settings): token_data = { \"grant_type\": \"password\", \"client_id\": LLM_GW_CLIENT_ID, \"username\": user_settings.keycloak_username, \"password\": user_settings.keycloak_password, } async with httpx.AsyncClient() as client: response = await client.post( f\"{KEYCLOAK_URL}/realms/{REALM}/protocol/openid-connect/token\", data=token_data, ) return response.json()[\"access_token\"] GitLab configuration. The base URL is configurable because different teams may use different GitLab instances.\nThe Agent System The heart of TARS is the agent, built on the strands-agents framework. Each user request creates a fresh agent instance with the user’s credentials injected via Python’s contextvars:\nfrom strands import Agent from strands.models.openai import OpenAIModel from strands.tools import ConcurrentToolExecutor from strands.conversation import SlidingWindowConversationManager def build_agent(user, user_settings, session_id): # Configure the LLM model = OpenAIModel( model_id=\"gpt-5.1\", client_args={ \"base_url\": LLM_GATEWAY_URL, \"api_key\": get_gateway_token(user_settings), }, params={\"temperature\": 0.0}, ) # Build tool list based on user's configured integrations tools = [] if user_settings.gitlab_token: tools.extend(GITLAB_TOOLS) if has_aws_credentials(user): tools.extend(AWS_TOOLS) tools.extend(CORE_TOOLS) # think, plan, http, repo_grep # Configure memory memory = SafeAgentCoreMemorySessionManager( namespaces={ \"preferences\": f\"/preferences/{user.id}\", \"facts\": f\"/facts/{user.id}\", \"summaries\": f\"/summaries/{user.id}/{session_id}\", } ) return Agent( model=model, tools=tools, tool_executor=ConcurrentToolExecutor(), conversation_manager=SlidingWindowConversationManager( window_size=40, ), session_manager=memory, system_prompt=SYSTEM_PROMPT, ) The System Prompt The system prompt is over 8,000 words and establishes the agent’s behavioral framework. Some key directives:\nAutonomous investigation, not advice:\n“You are TARS, a senior SRE debugger and platform analyst. When asked to investigate, you investigate. You don’t suggest what the user should check. You check it yourself.”\nContext-first mandate:\n“When a service name is mentioned, ALWAYS call gather_context() before any analysis. Never reason about a service without first discovering its actual configuration.”\nZero-hallucination enforcement:\n“Never reference AWS resources, GitLab projects, or configuration details that you have not discovered via tool calls in this conversation. If you haven’t checked it, you don’t know it.”\nMulti-signal verification:\n“Never conclude ’nothing found’ or ’everything looks fine’ without checking at least two independent signals. If CloudWatch shows no errors, also check ECS events and ALB metrics.”\nTool intent transparency:\n“Before each tool call, emit a single short sentence explaining what you’re checking and why. This helps the user follow your investigation.”\nThese constraints transform a general-purpose LLM into a focused investigation agent. The temperature is set to 0.0 because SRE investigation requires determinism, not creativity. You want the agent to follow the same investigation procedures every time.\nTool Registry: 30+ Specialized Tools TARS has access to over 30 tools, each designed for a specific investigation task. The tools are not generic wrappers. They encode domain knowledge about how to query each system effectively.\nAWS Tools (Read-Only) Each AWS service gets its own tool with smart defaults and domain-specific parameter handling:\n@tool def aws_ecs( action: str, parameters: dict, account_id: str | None = None, region: str = \"eu-central-1\", ) -\u003e dict: \"\"\"Query AWS ECS resources. Common actions: - describe_services: Get service details (cluster, serviceName required) - describe_tasks: Get task details (cluster, tasks required) - list_services: List services in a cluster - describe_task_definition: Get task definition details - list_task_definitions: List task definition families The tool automatically: - Resolves the correct AWS account credentials from the SAML cache - Adds 'eu-central-1' as default region if not specified - Handles pagination for list operations - Truncates large responses to prevent context overflow \"\"\" # Validate action is read-only if not action.startswith((\"describe_\", \"list_\", \"get_\")): return {\"error\": f\"Action '{action}' is not allowed (read-only)\"} # Get cached credentials for the target account credentials = get_cached_aws_credentials(account_id) client = boto3.client( \"ecs\", region_name=region, aws_access_key_id=credentials[\"AccessKeyId\"], aws_secret_access_key=credentials[\"SecretAccessKey\"], aws_session_token=credentials[\"SessionToken\"], ) method = getattr(client, action) response = method(**parameters) return truncate_response(response, max_chars=12000) There are specialized tools for ECS, CloudWatch, Lambda, RDS, S3, ElastiCache, ELB, API Gateway, Route53, Step Functions, networking (VPCs, subnets, security groups), and a generic aws tool that can call any AWS service.\nGitLab Tools GitLab tools go beyond simple API wrappers. The gitlab_search_group tool auto-paginates across results and searches at the group level (not just single repos):\n@tool def gitlab_search_group( group_id: int, scope: str, search: str, max_pages: int = 3, ) -\u003e list[dict]: \"\"\"Search across all repositories in a GitLab group. Scopes: projects, issues, merge_requests, blobs (code), commits, notes Auto-paginates up to max_pages to collect comprehensive results. Useful for finding which repositories contain specific code patterns, configuration references, or AWS account IDs. \"\"\" results = [] page = 1 while page \u003c= max_pages: response = gitlab_api( f\"/groups/{group_id}/search\", params={\"scope\": scope, \"search\": search, \"page\": page, \"per_page\": 20}, ) if not response: break results.extend(response) page += 1 return results The repo_grep Tool This is one of the most powerful tools. It clones a repository locally (shallow, sparse, cached) and provides grep, find, tree, and file read operations via subprocess:\n@tool def repo_grep( project_id: int, ref: str = \"master\", action: str = \"grep\", pattern: str | None = None, path: str | None = None, ) -\u003e str: \"\"\"Clone a GitLab repo locally and search its contents. Actions: - grep: Search file contents for a pattern (regex supported) - find: Find files matching a name pattern - tree: Show directory structure - read_file: Read a specific file's contents Repos are cached in /tmp for the session duration. Shallow clones keep disk usage minimal. \"\"\" repo_dir = clone_or_cache(project_id, ref) if action == \"grep\": result = subprocess.run( [\"grep\", \"-rn\", \"--include=*.py\", \"--include=*.tf\", \"--include=*.yml\", \"--include=*.yaml\", \"--include=*.json\", pattern, repo_dir], capture_output=True, text=True, timeout=30, ) return truncate(result.stdout, 12000) # ... other actions This allows the agent to do deep code analysis that isn’t possible through GitLab’s search API alone. It can trace function call chains, read configuration files, check Terraform variables, and find secrets that shouldn’t be committed.\nSub-Agent Architecture Complex investigations often require parallel work streams. TARS uses a sub-agent pattern where the main agent can spawn autonomous child agents that run to completion with their own tool sets:\n@tool def gather_context(service_name: str) -\u003e dict: \"\"\"Autonomously discover everything about a service. This sub-agent: 1. Searches GitLab for the service repository 2. Reads the repo structure (Dockerfile, terraform/, .gitlab-ci.yml) 3. Extracts AWS account, region, and cluster information 4. Returns a structured context object Always call this before investigating any service. \"\"\" sub_agent = Agent( model=model, tools=[gitlab, gitlab_get_file, gitlab_list_tree, gitlab_search_group], system_prompt=GATHER_CONTEXT_PROMPT, ) result = sub_agent( f\"Find and analyze the service '{service_name}'. \" f\"Return the GitLab project ID, AWS account, region, \" f\"cluster name, and key configuration details.\" ) return parse_context(result) @tool def investigate_infrastructure(context: dict, symptoms: str) -\u003e dict: \"\"\"Autonomously investigate AWS infrastructure for issues. Uses the context from gather_context() to check: - ECS service health, deployment status, task failures - ALB target health, request metrics, error rates - CloudWatch logs for error patterns - Recent configuration changes \"\"\" sub_agent = Agent( model=model, tools=[aws_ecs, aws_cloudwatch, aws_elb, aws_networking], system_prompt=INVESTIGATE_INFRA_PROMPT, ) return sub_agent( f\"Context: {json.dumps(context)}\\n\" f\"Symptoms: {symptoms}\\n\" f\"Investigate the infrastructure and report findings.\" ) @tool def investigate_code(context: dict, hypothesis: str) -\u003e dict: \"\"\"Autonomously investigate code for issues. Traces code paths, reads recent changes, checks for common patterns that could cause the reported symptoms. \"\"\" sub_agent = Agent( model=model, tools=[gitlab_get_file, gitlab_list_tree, repo_grep, gitlab_search_group], system_prompt=INVESTIGATE_CODE_PROMPT, ) return sub_agent( f\"Context: {json.dumps(context)}\\n\" f\"Hypothesis: {hypothesis}\\n\" f\"Investigate the code and report findings.\" ) Sub-agent progress is forwarded to the main response stream via a shared asyncio.Queue. The frontend renders sub-agent tool calls as nested activity items, so the user can see exactly what each sub-agent is doing in real time.\nSecurity Model An AI agent with access to 100+ AWS accounts and every GitLab repository needs serious guardrails. TARS implements security at three levels:\nLevel 1: Tool Policy Classification Every tool call is classified before execution:\nclass ToolPolicy: SAFE = \"safe\" # Read-only operations ELEVATED = \"elevated\" # Write operations (require confirmation) BLOCKED = \"blocked\" # Destructive operations (never allowed) def classify(self, tool_name, parameters): # All AWS write operations are blocked if tool_name.startswith(\"aws_\"): action = parameters.get(\"action\", \"\") if action.startswith((\"create_\", \"delete_\", \"update_\", \"put_\", \"modify_\", \"remove_\", \"terminate_\")): return self.BLOCKED # GitLab writes are elevated (branch-safe only) if tool_name in (\"gitlab_commit_file\", \"gitlab_create_branch\", \"gitlab_create_merge_request\"): return self.ELEVATED # GitLab generic tool blocks non-GET methods if tool_name == \"gitlab\": if parameters.get(\"method\", \"GET\") != \"GET\": return self.BLOCKED return self.SAFE Level 2: Branch Protection GitLab write tools enforce branch safety:\n@tool def gitlab_commit_file(project_id, branch, file_path, content, commit_message): \"\"\"Commit a file to a GitLab repository. SAFETY: Commits to main/master are rejected. Only feature branches are allowed. \"\"\" if branch.lower() in (\"main\", \"master\", \"release\", \"pre-release\"): return {\"error\": f\"Direct commits to '{branch}' are blocked. \" f\"Create a feature branch first.\"} # ... proceed with commit Level 3: Network Safety The HTTP tool includes SSRF protection:\ndef validate_url(url): \"\"\"Prevent SSRF by blocking requests to private IP ranges.\"\"\" parsed = urlparse(url) ip = socket.gethostbyname(parsed.hostname) private_ranges = [ ipaddress.ip_network(\"10.0.0.0/8\"), ipaddress.ip_network(\"172.16.0.0/12\"), ipaddress.ip_network(\"192.168.0.0/16\"), ipaddress.ip_network(\"169.254.0.0/16\"), ] addr = ipaddress.ip_address(ip) for network in private_ranges: if addr in network: raise SecurityError(f\"Requests to private IP {ip} are blocked\") Level 4: Output Sanitization Tool output is truncated to 12,000 characters to prevent context overflow attacks where a malicious response could fill the context window with adversarial content. Secret values detected in tool output are redacted before being shown to the user.\nStreaming Infrastructure Real-time streaming is essential for an investigation agent. Investigations can take 30-60 seconds as the agent makes multiple tool calls. Without streaming, the user would stare at a loading spinner with no visibility into what’s happening.\nTARS uses Server-Sent Events (SSE) with Django’s async StreamingHttpResponse:\nclass ChatStreamView(APIView): async def post(self, request): message = request.data[\"message\"] session_id = request.data.get(\"session_id\") agent = build_agent(request.user, request.user_settings, session_id) async def event_stream(): queue = asyncio.Queue() # Run agent in background task task = asyncio.create_task( run_agent(agent, message, queue) ) while True: event = await queue.get() if event[\"type\"] == \"done\": yield format_sse(event) break if event[\"type\"] == \"text_delta\": yield format_sse(event) if event[\"type\"] == \"tool_start\": yield format_sse({ \"type\": \"tool_start\", \"tool\": event[\"tool_name\"], \"input\": event[\"input_params\"], }) if event[\"type\"] == \"tool_end\": yield format_sse({ \"type\": \"tool_end\", \"tool\": event[\"tool_name\"], \"output\": truncate(event[\"output\"], 500), }) if event[\"type\"] == \"reasoning\": yield format_sse({ \"type\": \"reasoning\", \"text\": event[\"text\"], }) await task response = StreamingHttpResponse( event_stream(), content_type=\"text/event-stream\", ) response[\"Cache-Control\"] = \"no-cache\" response[\"X-Accel-Buffering\"] = \"no\" # Disable Nginx buffering return response def format_sse(data): return f\"data: {json.dumps(data)}\\n\\n\" The X-Accel-Buffering: no header is critical. Without it, Nginx buffers the SSE stream and delivers it in chunks, destroying the real-time experience. The ALB is configured with sticky sessions (1-hour cookie) to ensure SSE connections aren’t load-balanced mid-stream.\nThe Frontend The frontend is built with React 19 and follows a feature-based architecture:\nsrc/ features/ auth/ # OAuth2 PKCE, session management chat/ # Chat UI, SSE streaming, sessions kpi/ # Developer productivity dashboard memory/ # Agent memory viewer/manager admin/ # User management, system settings common/ # Layout, sidebar, shared components The useChat Hook The core of the chat feature is a custom React hook that manages the SSE connection, parses streaming events, and tracks tool invocations including nested sub-agent calls:\nfunction useChat() { const [messages, setMessages] = useState\u003cMessage[]\u003e([]); const [isStreaming, setIsStreaming] = useState(false); const [activeTools, setActiveTools] = useState\u003cToolCall[]\u003e([]); const sendMessage = useCallback(async (content: string) =\u003e { setIsStreaming(true); const response = await fetch(\"/api/chat/stream\", { method: \"POST\", headers: { \"Content-Type\": \"application/json\" }, body: JSON.stringify({ message: content, session_id: sessionId }), credentials: \"include\", }); const reader = response.body!.getReader(); const decoder = new TextDecoder(); let buffer = \"\"; while (true) { const { done, value } = await reader.read(); if (done) break; buffer += decoder.decode(value, { stream: true }); const lines = buffer.split(\"\\n\\n\"); buffer = lines.pop() || \"\"; for (const line of lines) { if (!line.startsWith(\"data: \")) continue; const event = JSON.parse(line.slice(6)); switch (event.type) { case \"text_delta\": appendToCurrentMessage(event.text); break; case \"tool_start\": addActiveToolCall(event); break; case \"tool_end\": resolveToolCall(event); break; case \"reasoning\": setReasoningText(event.text); break; } } } setIsStreaming(false); }, [sessionId]); return { messages, sendMessage, isStreaming, activeTools }; } Design Language The UI uses a dark theme with glass morphism effects, consistent with modern developer tools:\n.glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.1); } The deep purple/navy gradient background, subtle transparency, and smooth Framer Motion transitions create a polished, professional interface that engineers enjoy using. The login screen (shown at the top of this article) sets the tone immediately.\nActivity Sidebar During streaming, an activity sidebar shows every tool invocation in real time:\n\u003e Gathering context for \"payment-service\"... \u003e gitlab_search_group: searching for payment-service \u003e gitlab_list_tree: reading repository structure \u003e gitlab_get_file: reading terraform/locals.tf \u003e Investigating infrastructure... \u003e aws_ecs: describe_services on cluster payments-qual \u003e aws_cloudwatch: get_log_events for /ecs/payment-service \u003e aws_elb: describe_target_health for payment-tg Sub-agent tool calls are nested under their parent, making the investigation flow transparent to the user.\nKPI Dashboard Beyond SRE investigation, TARS includes a developer productivity dashboard that computes metrics from GitLab data:\nCommit frequency by day/week/month Code volume (lines added/removed) MR activity (opened, merged, review time) Review metrics (comments given/received) Repository engagement (contribution distribution) The caching strategy is multi-layered to minimize GitLab API calls:\nRaw GitLab data: 15-minute Redis cache Computed dashboard metrics: 1-hour Redis cache PostgreSQL snapshots: 4-hour persistent cache Data is fetched in fixed time buckets (15, 31, 91 days) regardless of what the user requests. If a user asks for “last 7 days” of data, the system fetches the 15-day bucket and filters client-side. This maximizes cache hit rates because different users requesting different time ranges all hit the same cached bucket.\nMemory and Context Management TARS uses AWS Bedrock AgentCore for persistent memory across sessions. Three memory strategies are active:\nUser Preferences: How the user likes responses formatted, which accounts they frequently investigate, preferred output verbosity Semantic Facts: Discovered facts about the infrastructure (e.g., “payment-service runs on cluster X in account Y”) Session Summaries: Compressed summaries of past conversations for continuity The conversation manager uses a sliding window of 40 messages. When the window fills, older messages are summarized and stored in the summaries namespace. This means the agent can reference context from days-old conversations without consuming the full context window.\nUsers can view and manage their memory records through a dedicated Memory page, with ownership verification preventing cross-user data access.\nDatabase Design The schema is intentionally minimal:\nUser (UUID pk) ├── entra_id (unique, Entra ID SSO link) ├── display_name └── role (user/admin) UserSettings (one-to-one with User) ├── keycloak_username / keycloak_password (encrypted) ├── gitlab_token (encrypted) / gitlab_base_url ├── corpgen_username / corpgen_password (encrypted) └── aws_otp_secret (encrypted) UserSession (token pk) ├── user (FK) └── expires_at (sliding window) ChatSession ├── user (FK) ├── title (auto-generated) └── output_mode (brief/standard/detailed) Message ├── session (FK) ├── role (user/assistant/system) ├── content (text) └── metrics (JSON: duration, tokens) ToolInvocation ├── message (FK) ├── tool_name, input_params, output, status └── timing (started_at, completed_at) ChatShare ├── session (FK) ├── token (unique, time-limited) └── message_count_snapshot DeveloperKPISnapshot ├── user (FK) ├── period, granularity ├── metrics (JSON) └── expires_at (4-hour TTL) All sensitive fields use EncryptedCharField. KPI snapshots auto-expire after 4 hours. Chat shares have a 30-day TTL.\nDeployment TARS deploys to ECS Fargate with Terraform:\nresource \"aws_ecs_service\" \"tars\" { name = \"tars\" cluster = aws_ecs_cluster.tars.id task_definition = aws_ecs_task_definition.tars.arn desired_count = 2 capacity_provider_strategy { capacity_provider = \"FARGATE_SPOT\" weight = 100 base = 1 } capacity_provider_strategy { capacity_provider = \"FARGATE\" weight = 1 } deployment_circuit_breaker { enable = true rollback = true } } resource \"aws_ecs_task_definition\" \"tars\" { family = \"tars\" requires_compatibilities = [\"FARGATE\"] network_mode = \"awsvpc\" cpu = 1024 # 1 vCPU memory = 2048 # 2 GB runtime_platform { operating_system_family = \"LINUX\" cpu_architecture = \"ARM64\" } container_definitions = jsonencode([{ name = \"tars\" image = \"${aws_ecr_repository.tars.repository_url}:latest\" portMappings = [{ containerPort = 8080 protocol = \"tcp\" }] secrets = [ { name = \"DJANGO_SECRET_KEY\", valueFrom = aws_secretsmanager_secret.django.arn }, { name = \"DATABASE_URL\", valueFrom = aws_secretsmanager_secret.db.arn }, { name = \"REDIS_URL\", valueFrom = aws_secretsmanager_secret.redis.arn }, # ... more secrets ] }]) } The multi-stage Dockerfile keeps the image small:\n# Stage 1: Build frontend FROM node:20-alpine AS frontend WORKDIR /app/frontend COPY frontend/package*.json ./ RUN npm ci COPY frontend/ ./ RUN npm run build # Stage 2: Production FROM python:3.13-slim WORKDIR /app # Install Python dependencies COPY backend/requirements.txt ./ RUN pip install --no-cache-dir -r requirements.txt # Copy backend COPY backend/ ./ # Copy built frontend + Nginx config COPY --from=frontend /app/frontend/dist /app/static/frontend COPY nginx.conf /etc/nginx/nginx.conf # Nginx serves static + proxies to Uvicorn EXPOSE 8080 CMD [\"supervisord\", \"-c\", \"supervisord.conf\"] Lessons Learned After building and operating TARS, here are the patterns that proved most valuable:\n1. Temperature 0.0 for investigation agents. SRE investigation requires determinism. You want the agent to follow the same procedures consistently. Creative responses are a liability when debugging production.\n2. Sub-agents are essential for complex investigations. A single agent trying to search GitLab, read code, check AWS, and analyze logs will lose track of its investigation plan. Sub-agents with focused tool sets produce much better results.\n3. Streaming is not optional. Investigations take 30-60 seconds. Without real-time streaming of tool calls and reasoning, users don’t trust the system. Seeing the agent’s thought process builds confidence in the results.\n4. Tool output truncation prevents context collapse. A single CloudWatch get_log_events call can return megabytes of data. Without aggressive truncation (12,000 chars), the context window fills with log noise and the agent loses track of its investigation.\n5. Read-only by default, always. An AI agent that can modify infrastructure is a liability. TARS is read-only for AWS by design. The only write operations allowed are creating GitLab branches, committing to non-protected branches, and creating merge requests. This means the worst-case scenario is an unwanted MR, which is trivially reversible.\n6. Per-user credentials, never shared. Each user authenticates with their own GitLab token and AWS SAML credentials. This means every action the agent takes is auditable to the individual user. If the agent reads a file in GitLab, it shows up in that user’s access log.\n7. The system prompt is the product. 80% of the agent’s quality comes from the system prompt, not the model or the tools. Investing weeks in crafting precise behavioral constraints, investigation procedures, and output formatting rules pays off enormously.\n8. Cache aggressively, but at the right granularity. The KPI dashboard’s fixed-bucket caching strategy (fetch 15/31/91 day buckets regardless of user request) improved cache hit rates from ~20% to ~85%. The key insight is that the most expensive operation (GitLab API calls) should be cached at a coarser granularity than what the user sees.\nWhat’s Next The natural evolution is expanding TARS from investigation to remediation. Today it tells you what’s wrong. Tomorrow it could:\nCreate a hotfix branch with the correct code change Open an MR with the fix, tagged for urgent review Draft the incident report based on its investigation findings Suggest runbook updates based on novel failure modes it discovers The foundation is already there. The tool policy system supports ELEVATED operations. The branch protection ensures writes are safe. The main challenge is building the right human-in-the-loop confirmation flow so the agent proposes changes but never applies them autonomously.\nThat’s the endgame: an AI SRE that investigates like your best engineer, communicates like your best technical writer, and never needs to sleep.\nReferences Strands Agents SDK Django Async Views Server-Sent Events (MDN) PKCE OAuth2 Flow AWS STS AssumeRoleWithSAML Radix UI The Elm Architecture ","wordCount":"4501","inLanguage":"en","image":"https://manuelfedele.github.io/img/card-pillow.jpg","datePublished":"2026-02-22T09:30:00+01:00","dateModified":"2026-02-22T09:30:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://manuelfedele.github.io/posts/building-ai-sre-assistant-from-scratch/"},"publisher":{"@type":"Organization","name":"Git Push and Run","logo":{"@type":"ImageObject","url":"https://manuelfedele.github.io/img/favicon.png"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://manuelfedele.github.io/ accesskey=h title="Git Push and Run (Alt + H)"><img src=https://manuelfedele.github.io/img/apple-touch-icon-144-precomposed.png alt aria-label=logo height=25>Git Push and Run</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://manuelfedele.github.io/ title=Home><span>Home</span></a></li><li><a href=https://manuelfedele.github.io/search/ title=Search><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://manuelfedele.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://manuelfedele.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator</h1><div class=post-meta><span title='2026-02-22 09:30:00 +0100 +0100'>February 22, 2026</span>&nbsp;·&nbsp;<span>22 min</span>&nbsp;·&nbsp;<span>4501 words</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#table-of-contents>Table of Contents</a></li><li><a href=#the-problem>The Problem</a></li><li><a href=#architecture-overview>Architecture Overview</a></li><li><a href=#tech-stack>Tech Stack</a></li><li><a href=#authentication-four-layers-deep>Authentication: Four Layers Deep</a><ul><li><a href=#layer-1-microsoft-entra-id-user-identity>Layer 1: Microsoft Entra ID (User Identity)</a></li><li><a href=#layer-2-gitlab-repository-access>Layer 2: GitLab (Repository Access)</a></li><li><a href=#layer-3-aws-saml-federation-infrastructure-access>Layer 3: AWS SAML Federation (Infrastructure Access)</a></li><li><a href=#layer-4-keycloak-llm-gateway-access>Layer 4: Keycloak (LLM Gateway Access)</a></li></ul></li><li><a href=#the-agent-system>The Agent System</a><ul><li><a href=#the-system-prompt>The System Prompt</a></li></ul></li><li><a href=#tool-registry-30-specialized-tools>Tool Registry: 30+ Specialized Tools</a><ul><li><a href=#aws-tools-read-only>AWS Tools (Read-Only)</a></li><li><a href=#gitlab-tools>GitLab Tools</a></li><li><a href=#the-repo_grep-tool>The repo_grep Tool</a></li></ul></li><li><a href=#sub-agent-architecture>Sub-Agent Architecture</a></li><li><a href=#security-model>Security Model</a><ul><li><a href=#level-1-tool-policy-classification>Level 1: Tool Policy Classification</a></li><li><a href=#level-2-branch-protection>Level 2: Branch Protection</a></li><li><a href=#level-3-network-safety>Level 3: Network Safety</a></li><li><a href=#level-4-output-sanitization>Level 4: Output Sanitization</a></li></ul></li><li><a href=#streaming-infrastructure>Streaming Infrastructure</a></li><li><a href=#the-frontend>The Frontend</a><ul><li><a href=#the-usechat-hook>The useChat Hook</a></li><li><a href=#design-language>Design Language</a></li><li><a href=#activity-sidebar>Activity Sidebar</a></li></ul></li><li><a href=#kpi-dashboard>KPI Dashboard</a></li><li><a href=#memory-and-context-management>Memory and Context Management</a></li><li><a href=#database-design>Database Design</a></li><li><a href=#deployment>Deployment</a></li><li><a href=#lessons-learned>Lessons Learned</a></li><li><a href=#whats-next>What&rsquo;s Next</a></li><li><a href=#references>References</a></li></ul></nav></div></details></div><div class=post-content><h1 id=building-an-ai-sre-assistant-from-scratch-architecture-of-an-autonomous-infrastructure-investigator>Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator<a hidden class=anchor aria-hidden=true href=#building-an-ai-sre-assistant-from-scratch-architecture-of-an-autonomous-infrastructure-investigator>#</a></h1><p>What if your on-call engineer never slept, had instant access to every repository and every AWS account, and could trace a production issue from DNS to database in under a minute?</p><p>That&rsquo;s the question that led me to build TARS, an AI-powered SRE assistant that autonomously investigates infrastructure issues by combining LLM reasoning with deep integrations into GitLab and AWS. Named after the robot from Interstellar (because every good internal tool needs a movie reference), TARS is a full-stack application where engineers interact with an AI agent through a chat interface. The agent doesn&rsquo;t just answer questions. It investigates. It clones repos, greps code, reads CloudWatch logs, traces DNS chains, inspects ECS services, and synthesizes findings into structured reports.</p><p>In this post I&rsquo;ll walk through every layer of the architecture: the authentication system, the agent framework, the tool registry, the streaming infrastructure, the frontend, and the deployment patterns that make it all work in production.</p><p><img alt="TARS Login Screen" loading=lazy src=/img/tars/login.png>
<em>The TARS login screen. Microsoft Entra ID SSO provides zero-friction authentication for the engineering team.</em></p><hr><h2 id=table-of-contents>Table of Contents<a hidden class=anchor aria-hidden=true href=#table-of-contents>#</a></h2><ul><li><a href=#the-problem>The Problem</a></li><li><a href=#architecture-overview>Architecture Overview</a></li><li><a href=#tech-stack>Tech Stack</a></li><li><a href=#authentication-four-layers-deep>Authentication: Four Layers Deep</a></li><li><a href=#the-agent-system>The Agent System</a></li><li><a href=#tool-registry-30-specialized-tools>Tool Registry: 30+ Specialized Tools</a></li><li><a href=#sub-agent-architecture>Sub-Agent Architecture</a></li><li><a href=#security-model>Security Model</a></li><li><a href=#streaming-infrastructure>Streaming Infrastructure</a></li><li><a href=#the-frontend>The Frontend</a></li><li><a href=#kpi-dashboard>KPI Dashboard</a></li><li><a href=#memory-and-context-management>Memory and Context Management</a></li><li><a href=#database-design>Database Design</a></li><li><a href=#deployment>Deployment</a></li><li><a href=#lessons-learned>Lessons Learned</a></li></ul><hr><h2 id=the-problem>The Problem<a hidden class=anchor aria-hidden=true href=#the-problem>#</a></h2><p>Platform teams at scale face a recurring challenge: investigating production issues requires correlating information across multiple systems. A typical investigation might look like:</p><ol><li>Someone reports a 503 error on a service</li><li>You check the ALB target group health</li><li>Targets are unhealthy, so you check the ECS service</li><li>ECS shows a deployment in progress, so you check the task definition</li><li>The image tag points to a commit, so you check GitLab</li><li>The last MR changed a health check endpoint, so you read the code</li><li>The code has a bug in the new health check, so you check CloudWatch logs to confirm</li><li>Logs confirm the error, you write up the finding</li></ol><p>Each step requires switching context, authenticating to a different system, navigating a different UI, and mentally correlating the results. For an experienced engineer, this takes 15-30 minutes. For a junior engineer, it can take hours, and they might miss steps entirely.</p><p>TARS automates this entire workflow. You type &ldquo;investigate the 503 errors on service X&rdquo; and the agent autonomously:</p><ul><li>Finds the service in GitLab</li><li>Reads the repository structure and configuration</li><li>Identifies the AWS account and region</li><li>Checks ALB target health, ECS service status, and recent deployments</li><li>Reads CloudWatch logs for error patterns</li><li>Checks recent MRs and commits for relevant changes</li><li>Correlates all findings and presents a structured report</li></ul><p>The key insight is that SRE investigation is largely procedural. The steps follow patterns. What makes a good SRE isn&rsquo;t memorizing those patterns, it&rsquo;s knowing which patterns to apply and how to interpret the results. That&rsquo;s exactly what LLMs excel at.</p><hr><h2 id=architecture-overview>Architecture Overview<a hidden class=anchor aria-hidden=true href=#architecture-overview>#</a></h2><p>TARS is a monolith deployed as a single container. The architecture is intentionally simple:</p><pre tabindex=0><code>VPN -&gt; Internal ALB (HTTPS/443, TLS 1.3)
           |
           v
    ECS Fargate (port 8080)
           |
           v
    Nginx (port 8080)
    /              \
/assets/*         /api/*
(static SPA)      (reverse proxy)
                       |
                       v
               Uvicorn (port 8000)
               Django ASGI
              /     |      \
      PostgreSQL  Redis  AWS Bedrock
      (Aurora)  (ElastiCache) (AgentCore Memory)
</code></pre><p>The frontend is a React SPA served by Nginx. API requests are proxied to the Django backend running on Uvicorn with ASGI support (critical for SSE streaming). PostgreSQL stores users, sessions, chat history, and KPI snapshots. Redis caches AWS credentials, GitLab API responses, and computed dashboard data. AWS Bedrock AgentCore provides persistent memory across sessions.</p><p>Why a monolith? Because the operational complexity of a microservice architecture is not justified when you have a single team, a single deployment target, and a single user-facing application. The monolith deploys in seconds, has one set of logs to check, and one service to monitor. If it ever needs to be split, the code is modular enough to extract services later.</p><hr><h2 id=tech-stack>Tech Stack<a hidden class=anchor aria-hidden=true href=#tech-stack>#</a></h2><p><strong>Backend:</strong></p><ul><li>Python 3.12+ with Django 6.0</li><li>Async support via <code>adrf</code> (async Django REST Framework)</li><li>Uvicorn as the ASGI server</li><li><code>strands-agents</code> for the AI agent framework</li><li><code>httpx</code> for async HTTP clients</li><li><code>msal</code> for Microsoft Entra ID OAuth2</li><li><code>requests-ntlm</code> for ADFS/SAML corporate auth</li><li><code>pyotp</code> for TOTP generation</li><li>Fernet encryption for credential storage</li></ul><p><strong>Frontend:</strong></p><ul><li>React 19 with TypeScript 5</li><li>Vite 7 as the build tool</li><li>Tailwind CSS 3 for styling</li><li>Radix UI for accessible primitives</li><li>Framer Motion for animations</li><li>Recharts for data visualization</li><li>React Hook Form + Zod for form validation</li><li>SSE (Server-Sent Events) for real-time streaming</li></ul><p><strong>Infrastructure:</strong></p><ul><li>AWS ECS Fargate (Spot + On-Demand)</li><li>Aurora PostgreSQL Serverless v2</li><li>ElastiCache Redis</li><li>Internal ALB with WAF</li><li>Terraform for IaC</li><li>Docker multi-stage build (Node 20 Alpine + Python 3.13 slim)</li></ul><hr><h2 id=authentication-four-layers-deep>Authentication: Four Layers Deep<a hidden class=anchor aria-hidden=true href=#authentication-four-layers-deep>#</a></h2><p>Authentication in TARS isn&rsquo;t just about identifying the user. It&rsquo;s about establishing trust chains across four distinct systems: the application itself, GitLab, AWS (via corporate SAML federation), and the LLM Gateway (via Keycloak). Each layer serves a different purpose, and each requires its own credential management.</p><h3 id=layer-1-microsoft-entra-id-user-identity>Layer 1: Microsoft Entra ID (User Identity)<a hidden class=anchor aria-hidden=true href=#layer-1-microsoft-entra-id-user-identity>#</a></h3><p>The primary authentication uses OAuth2 Authorization Code flow with PKCE:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Simplified OAuth2 PKCE flow</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>AuthCallbackView</span><span class=p>(</span><span class=n>APIView</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>post</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>code</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&#34;code&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>code_verifier</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&#34;code_verifier&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Exchange authorization code for tokens</span>
</span></span><span class=line><span class=cl>        <span class=n>msal_app</span> <span class=o>=</span> <span class=n>ConfidentialClientApplication</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>client_id</span><span class=o>=</span><span class=n>settings</span><span class=o>.</span><span class=n>ENTRA_CLIENT_ID</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>authority</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;https://login.microsoftonline.com/</span><span class=si>{</span><span class=n>settings</span><span class=o>.</span><span class=n>ENTRA_TENANT_ID</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>client_credential</span><span class=o>=</span><span class=n>settings</span><span class=o>.</span><span class=n>ENTRA_CLIENT_SECRET</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=n>msal_app</span><span class=o>.</span><span class=n>acquire_token_by_authorization_code</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>code</span><span class=o>=</span><span class=n>code</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>scopes</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;User.Read&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>redirect_uri</span><span class=o>=</span><span class=n>settings</span><span class=o>.</span><span class=n>ENTRA_REDIRECT_URI</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>code_verifier</span><span class=o>=</span><span class=n>code_verifier</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Validate the ID token signature against Microsoft JWKS</span>
</span></span><span class=line><span class=cl>        <span class=n>id_token</span> <span class=o>=</span> <span class=n>validate_and_decode_token</span><span class=p>(</span><span class=n>result</span><span class=p>[</span><span class=s2>&#34;id_token&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Create or update user</span>
</span></span><span class=line><span class=cl>        <span class=n>user</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=k>await</span> <span class=n>User</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>aupdate_or_create</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>entra_id</span><span class=o>=</span><span class=n>id_token</span><span class=p>[</span><span class=s2>&#34;oid&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>defaults</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;display_name&#34;</span><span class=p>:</span> <span class=n>id_token</span><span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>]},</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Create session with sliding window expiry</span>
</span></span><span class=line><span class=cl>        <span class=n>session</span> <span class=o>=</span> <span class=k>await</span> <span class=n>UserSession</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>acreate</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>user</span><span class=o>=</span><span class=n>user</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>expires_at</span><span class=o>=</span><span class=n>now</span><span class=p>()</span> <span class=o>+</span> <span class=n>timedelta</span><span class=p>(</span><span class=n>hours</span><span class=o>=</span><span class=mi>24</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Set HttpOnly, Secure, SameSite=Strict cookie</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=n>Response</span><span class=p>({</span><span class=s2>&#34;user&#34;</span><span class=p>:</span> <span class=n>UserSerializer</span><span class=p>(</span><span class=n>user</span><span class=p>)</span><span class=o>.</span><span class=n>data</span><span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=o>.</span><span class=n>set_cookie</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;session_id&#34;</span><span class=p>,</span> <span class=n>session</span><span class=o>.</span><span class=n>token</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>httponly</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>secure</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>samesite</span><span class=o>=</span><span class=s2>&#34;Strict&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>max_age</span><span class=o>=</span><span class=mi>86400</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>response</span>
</span></span></code></pre></div><p>The PKCE flow prevents authorization code interception attacks. The session cookie is <code>HttpOnly</code> (no JavaScript access), <code>Secure</code> (HTTPS only), and <code>SameSite=Strict</code> (no CSRF). Session expiry uses a sliding window: each authenticated request extends the session, but only if at least 300 seconds have passed since the last extension (to avoid hammering the database on every request).</p><h3 id=layer-2-gitlab-repository-access>Layer 2: GitLab (Repository Access)<a hidden class=anchor aria-hidden=true href=#layer-2-gitlab-repository-access>#</a></h3><p>Users configure their GitLab personal access token in the Settings page. The token is encrypted with Fernet symmetric encryption before storage:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>EncryptedCharField</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Transparently encrypts/decrypts field values using Fernet.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>fernet</span> <span class=o>=</span> <span class=n>Fernet</span><span class=p>(</span><span class=n>settings</span><span class=o>.</span><span class=n>FIELD_ENCRYPTION_KEY</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_prep_value</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>value</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>fernet</span><span class=o>.</span><span class=n>encrypt</span><span class=p>(</span><span class=n>value</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>value</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>from_db_value</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>value</span><span class=p>,</span> <span class=n>expression</span><span class=p>,</span> <span class=n>connection</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>value</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>fernet</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>value</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>value</span>
</span></span></code></pre></div><p>The encryption key is derived from <code>DJANGO_SECRET_KEY</code> and stored in AWS Secrets Manager. This means even if the database is compromised, the tokens are unreadable without the application secret.</p><h3 id=layer-3-aws-saml-federation-infrastructure-access>Layer 3: AWS SAML Federation (Infrastructure Access)<a hidden class=anchor aria-hidden=true href=#layer-3-aws-saml-federation-infrastructure-access>#</a></h3><p>This is the most complex authentication layer. Engineers need access to 100+ AWS accounts, each with multiple roles. Rather than managing individual IAM users, TARS authenticates via the corporate SAML federation chain:</p><pre tabindex=0><code>User credentials -&gt; Corporate ADFS (NTLM) -&gt; SAML assertion
    -&gt; Keycloak (SAML relay + OTP) -&gt; AWS SAML response
    -&gt; STS AssumeRoleWithSAML -&gt; Temporary credentials
</code></pre><p><img alt="TARS AWS Settings" loading=lazy src=/img/tars/settings-aws.png>
<em>The AWS authentication settings. Users provide corporate credentials and an optional OTP secret for automatic re-authentication.</em></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>AWSSAMLAuthenticator</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Authenticates to AWS via corporate SAML federation.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>authenticate</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>username</span><span class=p>,</span> <span class=n>password</span><span class=p>,</span> <span class=n>otp</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Step 1: Authenticate against corporate ADFS</span>
</span></span><span class=line><span class=cl>        <span class=n>session</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>Session</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>session</span><span class=o>.</span><span class=n>auth</span> <span class=o>=</span> <span class=n>HttpNtlmAuth</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=sa>f</span><span class=s2>&#34;CORP</span><span class=se>\\</span><span class=si>{</span><span class=n>username</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>password</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>adfs_response</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>get</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>ADFS_URL</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>params</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;loginToRp&#34;</span><span class=p>:</span> <span class=n>KEYCLOAK_ENTITY_ID</span><span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Step 2: Extract SAML assertion from ADFS response</span>
</span></span><span class=line><span class=cl>        <span class=n>saml_assertion</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_extract_saml</span><span class=p>(</span><span class=n>adfs_response</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Step 3: Submit SAML to Keycloak with OTP</span>
</span></span><span class=line><span class=cl>        <span class=n>kc_response</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>post</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>KEYCLOAK_SAML_ENDPOINT</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>data</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;SAMLResponse&#34;</span><span class=p>:</span> <span class=n>saml_assertion</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;otp&#34;</span><span class=p>:</span> <span class=n>otp</span> <span class=ow>or</span> <span class=n>pyotp</span><span class=o>.</span><span class=n>TOTP</span><span class=p>(</span><span class=n>otp_secret</span><span class=p>)</span><span class=o>.</span><span class=n>now</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Step 4: Extract AWS roles from final SAML response</span>
</span></span><span class=line><span class=cl>        <span class=n>aws_saml</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_extract_aws_saml</span><span class=p>(</span><span class=n>kc_response</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>roles</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_parse_aws_roles</span><span class=p>(</span><span class=n>aws_saml</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Step 5: Assume each role via STS</span>
</span></span><span class=line><span class=cl>        <span class=n>credentials</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=n>sts</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>client</span><span class=p>(</span><span class=s2>&#34;sts&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>role_arn</span><span class=p>,</span> <span class=n>provider_arn</span> <span class=ow>in</span> <span class=n>roles</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>creds</span> <span class=o>=</span> <span class=n>sts</span><span class=o>.</span><span class=n>assume_role_with_saml</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>RoleArn</span><span class=o>=</span><span class=n>role_arn</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>PrincipalArn</span><span class=o>=</span><span class=n>provider_arn</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>SAMLAssertion</span><span class=o>=</span><span class=n>aws_saml</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>credentials</span><span class=p>[</span><span class=n>role_arn</span><span class=p>]</span> <span class=o>=</span> <span class=n>creds</span><span class=p>[</span><span class=s2>&#34;Credentials&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Cache credentials in Redis with TTL</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_cache_credentials</span><span class=p>(</span><span class=n>credentials</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;accounts&#34;</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;:&#34;</span><span class=p>)[</span><span class=mi>4</span><span class=p>]</span> <span class=k>for</span> <span class=n>r</span><span class=p>,</span> <span class=n>_</span> <span class=ow>in</span> <span class=n>roles</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;roles&#34;</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>roles</span><span class=p>)}</span>
</span></span></code></pre></div><p>When the OTP secret is configured, TARS can automatically re-authenticate when credentials expire, making the AWS access seamless. The temporary credentials are cached in Redis with a TTL matching their STS expiration. The agent can then assume different roles on demand to investigate resources across any AWS account.</p><h3 id=layer-4-keycloak-llm-gateway-access>Layer 4: Keycloak (LLM Gateway Access)<a hidden class=anchor aria-hidden=true href=#layer-4-keycloak-llm-gateway-access>#</a></h3><p><img alt="TARS Settings - Credentials" loading=lazy src=/img/tars/settings-credentials.png>
<em>The credentials settings page. Each integration has its own encrypted credential store.</em></p><p>The LLM Gateway that provides access to GPT models requires Keycloak authentication. Users configure their Keycloak credentials, and TARS obtains OAuth2 tokens on their behalf:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>get_llm_gateway_token</span><span class=p>(</span><span class=n>user_settings</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>token_data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;grant_type&#34;</span><span class=p>:</span> <span class=s2>&#34;password&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;client_id&#34;</span><span class=p>:</span> <span class=n>LLM_GW_CLIENT_ID</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;username&#34;</span><span class=p>:</span> <span class=n>user_settings</span><span class=o>.</span><span class=n>keycloak_username</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;password&#34;</span><span class=p>:</span> <span class=n>user_settings</span><span class=o>.</span><span class=n>keycloak_password</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>with</span> <span class=n>httpx</span><span class=o>.</span><span class=n>AsyncClient</span><span class=p>()</span> <span class=k>as</span> <span class=n>client</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=k>await</span> <span class=n>client</span><span class=o>.</span><span class=n>post</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>KEYCLOAK_URL</span><span class=si>}</span><span class=s2>/realms/</span><span class=si>{</span><span class=n>REALM</span><span class=si>}</span><span class=s2>/protocol/openid-connect/token&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>data</span><span class=o>=</span><span class=n>token_data</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()[</span><span class=s2>&#34;access_token&#34;</span><span class=p>]</span>
</span></span></code></pre></div><p><img alt="TARS Settings - GitLab" loading=lazy src=/img/tars/settings-gitlab.png>
<em>GitLab configuration. The base URL is configurable because different teams may use different GitLab instances.</em></p><hr><h2 id=the-agent-system>The Agent System<a hidden class=anchor aria-hidden=true href=#the-agent-system>#</a></h2><p>The heart of TARS is the agent, built on the <code>strands-agents</code> framework. Each user request creates a fresh agent instance with the user&rsquo;s credentials injected via Python&rsquo;s <code>contextvars</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>strands</span> <span class=kn>import</span> <span class=n>Agent</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>strands.models.openai</span> <span class=kn>import</span> <span class=n>OpenAIModel</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>strands.tools</span> <span class=kn>import</span> <span class=n>ConcurrentToolExecutor</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>strands.conversation</span> <span class=kn>import</span> <span class=n>SlidingWindowConversationManager</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>build_agent</span><span class=p>(</span><span class=n>user</span><span class=p>,</span> <span class=n>user_settings</span><span class=p>,</span> <span class=n>session_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># Configure the LLM</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span> <span class=o>=</span> <span class=n>OpenAIModel</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>model_id</span><span class=o>=</span><span class=s2>&#34;gpt-5.1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>client_args</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;base_url&#34;</span><span class=p>:</span> <span class=n>LLM_GATEWAY_URL</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;api_key&#34;</span><span class=p>:</span> <span class=n>get_gateway_token</span><span class=p>(</span><span class=n>user_settings</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=n>params</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;temperature&#34;</span><span class=p>:</span> <span class=mf>0.0</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Build tool list based on user&#39;s configured integrations</span>
</span></span><span class=line><span class=cl>    <span class=n>tools</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>user_settings</span><span class=o>.</span><span class=n>gitlab_token</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>tools</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>GITLAB_TOOLS</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>has_aws_credentials</span><span class=p>(</span><span class=n>user</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>tools</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>AWS_TOOLS</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>tools</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>CORE_TOOLS</span><span class=p>)</span>  <span class=c1># think, plan, http, repo_grep</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Configure memory</span>
</span></span><span class=line><span class=cl>    <span class=n>memory</span> <span class=o>=</span> <span class=n>SafeAgentCoreMemorySessionManager</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>namespaces</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;preferences&#34;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;/preferences/</span><span class=si>{</span><span class=n>user</span><span class=o>.</span><span class=n>id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;facts&#34;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;/facts/</span><span class=si>{</span><span class=n>user</span><span class=o>.</span><span class=n>id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;summaries&#34;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;/summaries/</span><span class=si>{</span><span class=n>user</span><span class=o>.</span><span class=n>id</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=n>session_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>Agent</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>model</span><span class=o>=</span><span class=n>model</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>tools</span><span class=o>=</span><span class=n>tools</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>tool_executor</span><span class=o>=</span><span class=n>ConcurrentToolExecutor</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=n>conversation_manager</span><span class=o>=</span><span class=n>SlidingWindowConversationManager</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>window_size</span><span class=o>=</span><span class=mi>40</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>session_manager</span><span class=o>=</span><span class=n>memory</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>system_prompt</span><span class=o>=</span><span class=n>SYSTEM_PROMPT</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span></code></pre></div><h3 id=the-system-prompt>The System Prompt<a hidden class=anchor aria-hidden=true href=#the-system-prompt>#</a></h3><p>The system prompt is over 8,000 words and establishes the agent&rsquo;s behavioral framework. Some key directives:</p><p><strong>Autonomous investigation, not advice:</strong></p><blockquote><p>&ldquo;You are TARS, a senior SRE debugger and platform analyst. When asked to investigate, you investigate. You don&rsquo;t suggest what the user should check. You check it yourself.&rdquo;</p></blockquote><p><strong>Context-first mandate:</strong></p><blockquote><p>&ldquo;When a service name is mentioned, ALWAYS call gather_context() before any analysis. Never reason about a service without first discovering its actual configuration.&rdquo;</p></blockquote><p><strong>Zero-hallucination enforcement:</strong></p><blockquote><p>&ldquo;Never reference AWS resources, GitLab projects, or configuration details that you have not discovered via tool calls in this conversation. If you haven&rsquo;t checked it, you don&rsquo;t know it.&rdquo;</p></blockquote><p><strong>Multi-signal verification:</strong></p><blockquote><p>&ldquo;Never conclude &rsquo;nothing found&rsquo; or &rsquo;everything looks fine&rsquo; without checking at least two independent signals. If CloudWatch shows no errors, also check ECS events and ALB metrics.&rdquo;</p></blockquote><p><strong>Tool intent transparency:</strong></p><blockquote><p>&ldquo;Before each tool call, emit a single short sentence explaining what you&rsquo;re checking and why. This helps the user follow your investigation.&rdquo;</p></blockquote><p>These constraints transform a general-purpose LLM into a focused investigation agent. The temperature is set to 0.0 because SRE investigation requires determinism, not creativity. You want the agent to follow the same investigation procedures every time.</p><hr><h2 id=tool-registry-30-specialized-tools>Tool Registry: 30+ Specialized Tools<a hidden class=anchor aria-hidden=true href=#tool-registry-30-specialized-tools>#</a></h2><p>TARS has access to over 30 tools, each designed for a specific investigation task. The tools are not generic wrappers. They encode domain knowledge about how to query each system effectively.</p><h3 id=aws-tools-read-only>AWS Tools (Read-Only)<a hidden class=anchor aria-hidden=true href=#aws-tools-read-only>#</a></h3><p>Each AWS service gets its own tool with smart defaults and domain-specific parameter handling:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@tool</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>aws_ecs</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>action</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>parameters</span><span class=p>:</span> <span class=nb>dict</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>account_id</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>region</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;eu-central-1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Query AWS ECS resources.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Common actions:
</span></span></span><span class=line><span class=cl><span class=s2>    - describe_services: Get service details (cluster, serviceName required)
</span></span></span><span class=line><span class=cl><span class=s2>    - describe_tasks: Get task details (cluster, tasks required)
</span></span></span><span class=line><span class=cl><span class=s2>    - list_services: List services in a cluster
</span></span></span><span class=line><span class=cl><span class=s2>    - describe_task_definition: Get task definition details
</span></span></span><span class=line><span class=cl><span class=s2>    - list_task_definitions: List task definition families
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    The tool automatically:
</span></span></span><span class=line><span class=cl><span class=s2>    - Resolves the correct AWS account credentials from the SAML cache
</span></span></span><span class=line><span class=cl><span class=s2>    - Adds &#39;eu-central-1&#39; as default region if not specified
</span></span></span><span class=line><span class=cl><span class=s2>    - Handles pagination for list operations
</span></span></span><span class=line><span class=cl><span class=s2>    - Truncates large responses to prevent context overflow
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># Validate action is read-only</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>action</span><span class=o>.</span><span class=n>startswith</span><span class=p>((</span><span class=s2>&#34;describe_&#34;</span><span class=p>,</span> <span class=s2>&#34;list_&#34;</span><span class=p>,</span> <span class=s2>&#34;get_&#34;</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;Action &#39;</span><span class=si>{</span><span class=n>action</span><span class=si>}</span><span class=s2>&#39; is not allowed (read-only)&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Get cached credentials for the target account</span>
</span></span><span class=line><span class=cl>    <span class=n>credentials</span> <span class=o>=</span> <span class=n>get_cached_aws_credentials</span><span class=p>(</span><span class=n>account_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>client</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>client</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;ecs&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>region_name</span><span class=o>=</span><span class=n>region</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>aws_access_key_id</span><span class=o>=</span><span class=n>credentials</span><span class=p>[</span><span class=s2>&#34;AccessKeyId&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>aws_secret_access_key</span><span class=o>=</span><span class=n>credentials</span><span class=p>[</span><span class=s2>&#34;SecretAccessKey&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>aws_session_token</span><span class=o>=</span><span class=n>credentials</span><span class=p>[</span><span class=s2>&#34;SessionToken&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>method</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>client</span><span class=p>,</span> <span class=n>action</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=n>method</span><span class=p>(</span><span class=o>**</span><span class=n>parameters</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>truncate_response</span><span class=p>(</span><span class=n>response</span><span class=p>,</span> <span class=n>max_chars</span><span class=o>=</span><span class=mi>12000</span><span class=p>)</span>
</span></span></code></pre></div><p>There are specialized tools for ECS, CloudWatch, Lambda, RDS, S3, ElastiCache, ELB, API Gateway, Route53, Step Functions, networking (VPCs, subnets, security groups), and a generic <code>aws</code> tool that can call any AWS service.</p><h3 id=gitlab-tools>GitLab Tools<a hidden class=anchor aria-hidden=true href=#gitlab-tools>#</a></h3><p>GitLab tools go beyond simple API wrappers. The <code>gitlab_search_group</code> tool auto-paginates across results and searches at the group level (not just single repos):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@tool</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>gitlab_search_group</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>group_id</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>scope</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>search</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>max_pages</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=nb>dict</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Search across all repositories in a GitLab group.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Scopes: projects, issues, merge_requests, blobs (code), commits, notes
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Auto-paginates up to max_pages to collect comprehensive results.
</span></span></span><span class=line><span class=cl><span class=s2>    Useful for finding which repositories contain specific code patterns,
</span></span></span><span class=line><span class=cl><span class=s2>    configuration references, or AWS account IDs.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>page</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>page</span> <span class=o>&lt;=</span> <span class=n>max_pages</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=n>gitlab_api</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=sa>f</span><span class=s2>&#34;/groups/</span><span class=si>{</span><span class=n>group_id</span><span class=si>}</span><span class=s2>/search&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>params</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;scope&#34;</span><span class=p>:</span> <span class=n>scope</span><span class=p>,</span> <span class=s2>&#34;search&#34;</span><span class=p>:</span> <span class=n>search</span><span class=p>,</span> <span class=s2>&#34;page&#34;</span><span class=p>:</span> <span class=n>page</span><span class=p>,</span> <span class=s2>&#34;per_page&#34;</span><span class=p>:</span> <span class=mi>20</span><span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>response</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>results</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>page</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>results</span>
</span></span></code></pre></div><h3 id=the-repo_grep-tool>The repo_grep Tool<a hidden class=anchor aria-hidden=true href=#the-repo_grep-tool>#</a></h3><p>This is one of the most powerful tools. It clones a repository locally (shallow, sparse, cached) and provides grep, find, tree, and file read operations via subprocess:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@tool</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>repo_grep</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>project_id</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>ref</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;master&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>action</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;grep&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>pattern</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>path</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Clone a GitLab repo locally and search its contents.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Actions:
</span></span></span><span class=line><span class=cl><span class=s2>    - grep: Search file contents for a pattern (regex supported)
</span></span></span><span class=line><span class=cl><span class=s2>    - find: Find files matching a name pattern
</span></span></span><span class=line><span class=cl><span class=s2>    - tree: Show directory structure
</span></span></span><span class=line><span class=cl><span class=s2>    - read_file: Read a specific file&#39;s contents
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Repos are cached in /tmp for the session duration.
</span></span></span><span class=line><span class=cl><span class=s2>    Shallow clones keep disk usage minimal.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>repo_dir</span> <span class=o>=</span> <span class=n>clone_or_cache</span><span class=p>(</span><span class=n>project_id</span><span class=p>,</span> <span class=n>ref</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>action</span> <span class=o>==</span> <span class=s2>&#34;grep&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=p>[</span><span class=s2>&#34;grep&#34;</span><span class=p>,</span> <span class=s2>&#34;-rn&#34;</span><span class=p>,</span> <span class=s2>&#34;--include=*.py&#34;</span><span class=p>,</span> <span class=s2>&#34;--include=*.tf&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=s2>&#34;--include=*.yml&#34;</span><span class=p>,</span> <span class=s2>&#34;--include=*.yaml&#34;</span><span class=p>,</span> <span class=s2>&#34;--include=*.json&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>pattern</span><span class=p>,</span> <span class=n>repo_dir</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>capture_output</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>text</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>timeout</span><span class=o>=</span><span class=mi>30</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>truncate</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>stdout</span><span class=p>,</span> <span class=mi>12000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># ... other actions</span>
</span></span></code></pre></div><p>This allows the agent to do deep code analysis that isn&rsquo;t possible through GitLab&rsquo;s search API alone. It can trace function call chains, read configuration files, check Terraform variables, and find secrets that shouldn&rsquo;t be committed.</p><hr><h2 id=sub-agent-architecture>Sub-Agent Architecture<a hidden class=anchor aria-hidden=true href=#sub-agent-architecture>#</a></h2><p>Complex investigations often require parallel work streams. TARS uses a sub-agent pattern where the main agent can spawn autonomous child agents that run to completion with their own tool sets:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@tool</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>gather_context</span><span class=p>(</span><span class=n>service_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Autonomously discover everything about a service.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    This sub-agent:
</span></span></span><span class=line><span class=cl><span class=s2>    1. Searches GitLab for the service repository
</span></span></span><span class=line><span class=cl><span class=s2>    2. Reads the repo structure (Dockerfile, terraform/, .gitlab-ci.yml)
</span></span></span><span class=line><span class=cl><span class=s2>    3. Extracts AWS account, region, and cluster information
</span></span></span><span class=line><span class=cl><span class=s2>    4. Returns a structured context object
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Always call this before investigating any service.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>sub_agent</span> <span class=o>=</span> <span class=n>Agent</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>model</span><span class=o>=</span><span class=n>model</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>tools</span><span class=o>=</span><span class=p>[</span><span class=n>gitlab</span><span class=p>,</span> <span class=n>gitlab_get_file</span><span class=p>,</span> <span class=n>gitlab_list_tree</span><span class=p>,</span> <span class=n>gitlab_search_group</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>system_prompt</span><span class=o>=</span><span class=n>GATHER_CONTEXT_PROMPT</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>sub_agent</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;Find and analyze the service &#39;</span><span class=si>{</span><span class=n>service_name</span><span class=si>}</span><span class=s2>&#39;. &#34;</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;Return the GitLab project ID, AWS account, region, &#34;</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;cluster name, and key configuration details.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>parse_context</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@tool</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>investigate_infrastructure</span><span class=p>(</span><span class=n>context</span><span class=p>:</span> <span class=nb>dict</span><span class=p>,</span> <span class=n>symptoms</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Autonomously investigate AWS infrastructure for issues.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Uses the context from gather_context() to check:
</span></span></span><span class=line><span class=cl><span class=s2>    - ECS service health, deployment status, task failures
</span></span></span><span class=line><span class=cl><span class=s2>    - ALB target health, request metrics, error rates
</span></span></span><span class=line><span class=cl><span class=s2>    - CloudWatch logs for error patterns
</span></span></span><span class=line><span class=cl><span class=s2>    - Recent configuration changes
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>sub_agent</span> <span class=o>=</span> <span class=n>Agent</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>model</span><span class=o>=</span><span class=n>model</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>tools</span><span class=o>=</span><span class=p>[</span><span class=n>aws_ecs</span><span class=p>,</span> <span class=n>aws_cloudwatch</span><span class=p>,</span> <span class=n>aws_elb</span><span class=p>,</span> <span class=n>aws_networking</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>system_prompt</span><span class=o>=</span><span class=n>INVESTIGATE_INFRA_PROMPT</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>sub_agent</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;Context: </span><span class=si>{</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>context</span><span class=p>)</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;Symptoms: </span><span class=si>{</span><span class=n>symptoms</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;Investigate the infrastructure and report findings.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@tool</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>investigate_code</span><span class=p>(</span><span class=n>context</span><span class=p>:</span> <span class=nb>dict</span><span class=p>,</span> <span class=n>hypothesis</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Autonomously investigate code for issues.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Traces code paths, reads recent changes, checks for
</span></span></span><span class=line><span class=cl><span class=s2>    common patterns that could cause the reported symptoms.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>sub_agent</span> <span class=o>=</span> <span class=n>Agent</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>model</span><span class=o>=</span><span class=n>model</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>tools</span><span class=o>=</span><span class=p>[</span><span class=n>gitlab_get_file</span><span class=p>,</span> <span class=n>gitlab_list_tree</span><span class=p>,</span> <span class=n>repo_grep</span><span class=p>,</span> <span class=n>gitlab_search_group</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>system_prompt</span><span class=o>=</span><span class=n>INVESTIGATE_CODE_PROMPT</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>sub_agent</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;Context: </span><span class=si>{</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>context</span><span class=p>)</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;Hypothesis: </span><span class=si>{</span><span class=n>hypothesis</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;Investigate the code and report findings.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span></code></pre></div><p>Sub-agent progress is forwarded to the main response stream via a shared <code>asyncio.Queue</code>. The frontend renders sub-agent tool calls as nested activity items, so the user can see exactly what each sub-agent is doing in real time.</p><hr><h2 id=security-model>Security Model<a hidden class=anchor aria-hidden=true href=#security-model>#</a></h2><p>An AI agent with access to 100+ AWS accounts and every GitLab repository needs serious guardrails. TARS implements security at three levels:</p><h3 id=level-1-tool-policy-classification>Level 1: Tool Policy Classification<a hidden class=anchor aria-hidden=true href=#level-1-tool-policy-classification>#</a></h3><p>Every tool call is classified before execution:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>ToolPolicy</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>SAFE</span> <span class=o>=</span> <span class=s2>&#34;safe&#34;</span>       <span class=c1># Read-only operations</span>
</span></span><span class=line><span class=cl>    <span class=n>ELEVATED</span> <span class=o>=</span> <span class=s2>&#34;elevated&#34;</span>  <span class=c1># Write operations (require confirmation)</span>
</span></span><span class=line><span class=cl>    <span class=n>BLOCKED</span> <span class=o>=</span> <span class=s2>&#34;blocked&#34;</span>    <span class=c1># Destructive operations (never allowed)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>classify</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>tool_name</span><span class=p>,</span> <span class=n>parameters</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># All AWS write operations are blocked</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>tool_name</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&#34;aws_&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>action</span> <span class=o>=</span> <span class=n>parameters</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;action&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>action</span><span class=o>.</span><span class=n>startswith</span><span class=p>((</span><span class=s2>&#34;create_&#34;</span><span class=p>,</span> <span class=s2>&#34;delete_&#34;</span><span class=p>,</span> <span class=s2>&#34;update_&#34;</span><span class=p>,</span> <span class=s2>&#34;put_&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                  <span class=s2>&#34;modify_&#34;</span><span class=p>,</span> <span class=s2>&#34;remove_&#34;</span><span class=p>,</span> <span class=s2>&#34;terminate_&#34;</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>BLOCKED</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># GitLab writes are elevated (branch-safe only)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>tool_name</span> <span class=ow>in</span> <span class=p>(</span><span class=s2>&#34;gitlab_commit_file&#34;</span><span class=p>,</span> <span class=s2>&#34;gitlab_create_branch&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                         <span class=s2>&#34;gitlab_create_merge_request&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>ELEVATED</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># GitLab generic tool blocks non-GET methods</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>tool_name</span> <span class=o>==</span> <span class=s2>&#34;gitlab&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>parameters</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;method&#34;</span><span class=p>,</span> <span class=s2>&#34;GET&#34;</span><span class=p>)</span> <span class=o>!=</span> <span class=s2>&#34;GET&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>BLOCKED</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>SAFE</span>
</span></span></code></pre></div><h3 id=level-2-branch-protection>Level 2: Branch Protection<a hidden class=anchor aria-hidden=true href=#level-2-branch-protection>#</a></h3><p>GitLab write tools enforce branch safety:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@tool</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>gitlab_commit_file</span><span class=p>(</span><span class=n>project_id</span><span class=p>,</span> <span class=n>branch</span><span class=p>,</span> <span class=n>file_path</span><span class=p>,</span> <span class=n>content</span><span class=p>,</span> <span class=n>commit_message</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Commit a file to a GitLab repository.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    SAFETY: Commits to main/master are rejected.
</span></span></span><span class=line><span class=cl><span class=s2>    Only feature branches are allowed.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>branch</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=ow>in</span> <span class=p>(</span><span class=s2>&#34;main&#34;</span><span class=p>,</span> <span class=s2>&#34;master&#34;</span><span class=p>,</span> <span class=s2>&#34;release&#34;</span><span class=p>,</span> <span class=s2>&#34;pre-release&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;Direct commits to &#39;</span><span class=si>{</span><span class=n>branch</span><span class=si>}</span><span class=s2>&#39; are blocked. &#34;</span>
</span></span><span class=line><span class=cl>                         <span class=sa>f</span><span class=s2>&#34;Create a feature branch first.&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># ... proceed with commit</span>
</span></span></code></pre></div><h3 id=level-3-network-safety>Level 3: Network Safety<a hidden class=anchor aria-hidden=true href=#level-3-network-safety>#</a></h3><p>The HTTP tool includes SSRF protection:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>validate_url</span><span class=p>(</span><span class=n>url</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Prevent SSRF by blocking requests to private IP ranges.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>parsed</span> <span class=o>=</span> <span class=n>urlparse</span><span class=p>(</span><span class=n>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ip</span> <span class=o>=</span> <span class=n>socket</span><span class=o>.</span><span class=n>gethostbyname</span><span class=p>(</span><span class=n>parsed</span><span class=o>.</span><span class=n>hostname</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>private_ranges</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=n>ipaddress</span><span class=o>.</span><span class=n>ip_network</span><span class=p>(</span><span class=s2>&#34;10.0.0.0/8&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>ipaddress</span><span class=o>.</span><span class=n>ip_network</span><span class=p>(</span><span class=s2>&#34;172.16.0.0/12&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>ipaddress</span><span class=o>.</span><span class=n>ip_network</span><span class=p>(</span><span class=s2>&#34;192.168.0.0/16&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>ipaddress</span><span class=o>.</span><span class=n>ip_network</span><span class=p>(</span><span class=s2>&#34;169.254.0.0/16&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>addr</span> <span class=o>=</span> <span class=n>ipaddress</span><span class=o>.</span><span class=n>ip_address</span><span class=p>(</span><span class=n>ip</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>network</span> <span class=ow>in</span> <span class=n>private_ranges</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>addr</span> <span class=ow>in</span> <span class=n>network</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=n>SecurityError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Requests to private IP </span><span class=si>{</span><span class=n>ip</span><span class=si>}</span><span class=s2> are blocked&#34;</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=level-4-output-sanitization>Level 4: Output Sanitization<a hidden class=anchor aria-hidden=true href=#level-4-output-sanitization>#</a></h3><p>Tool output is truncated to 12,000 characters to prevent context overflow attacks where a malicious response could fill the context window with adversarial content. Secret values detected in tool output are redacted before being shown to the user.</p><hr><h2 id=streaming-infrastructure>Streaming Infrastructure<a hidden class=anchor aria-hidden=true href=#streaming-infrastructure>#</a></h2><p>Real-time streaming is essential for an investigation agent. Investigations can take 30-60 seconds as the agent makes multiple tool calls. Without streaming, the user would stare at a loading spinner with no visibility into what&rsquo;s happening.</p><p>TARS uses Server-Sent Events (SSE) with Django&rsquo;s async <code>StreamingHttpResponse</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>ChatStreamView</span><span class=p>(</span><span class=n>APIView</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>post</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>message</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&#34;message&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>session_id</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;session_id&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>agent</span> <span class=o>=</span> <span class=n>build_agent</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=p>,</span> <span class=n>request</span><span class=o>.</span><span class=n>user_settings</span><span class=p>,</span> <span class=n>session_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>async</span> <span class=k>def</span> <span class=nf>event_stream</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>queue</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>Queue</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1># Run agent in background task</span>
</span></span><span class=line><span class=cl>            <span class=n>task</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>run_agent</span><span class=p>(</span><span class=n>agent</span><span class=p>,</span> <span class=n>message</span><span class=p>,</span> <span class=n>queue</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>event</span> <span class=o>=</span> <span class=k>await</span> <span class=n>queue</span><span class=o>.</span><span class=n>get</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>event</span><span class=p>[</span><span class=s2>&#34;type&#34;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;done&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>yield</span> <span class=n>format_sse</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>event</span><span class=p>[</span><span class=s2>&#34;type&#34;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;text_delta&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>yield</span> <span class=n>format_sse</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>event</span><span class=p>[</span><span class=s2>&#34;type&#34;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;tool_start&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>yield</span> <span class=n>format_sse</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;tool_start&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;tool&#34;</span><span class=p>:</span> <span class=n>event</span><span class=p>[</span><span class=s2>&#34;tool_name&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;input&#34;</span><span class=p>:</span> <span class=n>event</span><span class=p>[</span><span class=s2>&#34;input_params&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>event</span><span class=p>[</span><span class=s2>&#34;type&#34;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;tool_end&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>yield</span> <span class=n>format_sse</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;tool_end&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;tool&#34;</span><span class=p>:</span> <span class=n>event</span><span class=p>[</span><span class=s2>&#34;tool_name&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;output&#34;</span><span class=p>:</span> <span class=n>truncate</span><span class=p>(</span><span class=n>event</span><span class=p>[</span><span class=s2>&#34;output&#34;</span><span class=p>],</span> <span class=mi>500</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>event</span><span class=p>[</span><span class=s2>&#34;type&#34;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;reasoning&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>yield</span> <span class=n>format_sse</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;reasoning&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;text&#34;</span><span class=p>:</span> <span class=n>event</span><span class=p>[</span><span class=s2>&#34;text&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=n>task</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=n>StreamingHttpResponse</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>event_stream</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=n>content_type</span><span class=o>=</span><span class=s2>&#34;text/event-stream&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=p>[</span><span class=s2>&#34;Cache-Control&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;no-cache&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=p>[</span><span class=s2>&#34;X-Accel-Buffering&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;no&#34;</span>  <span class=c1># Disable Nginx buffering</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>response</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>format_sse</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;data: </span><span class=si>{</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>data</span><span class=p>)</span><span class=si>}</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span></code></pre></div><p>The <code>X-Accel-Buffering: no</code> header is critical. Without it, Nginx buffers the SSE stream and delivers it in chunks, destroying the real-time experience. The ALB is configured with sticky sessions (1-hour cookie) to ensure SSE connections aren&rsquo;t load-balanced mid-stream.</p><hr><h2 id=the-frontend>The Frontend<a hidden class=anchor aria-hidden=true href=#the-frontend>#</a></h2><p>The frontend is built with React 19 and follows a feature-based architecture:</p><pre tabindex=0><code>src/
  features/
    auth/       # OAuth2 PKCE, session management
    chat/       # Chat UI, SSE streaming, sessions
    kpi/        # Developer productivity dashboard
    memory/     # Agent memory viewer/manager
    admin/      # User management, system settings
    common/     # Layout, sidebar, shared components
</code></pre><h3 id=the-usechat-hook>The useChat Hook<a hidden class=anchor aria-hidden=true href=#the-usechat-hook>#</a></h3><p>The core of the chat feature is a custom React hook that manages the SSE connection, parses streaming events, and tracks tool invocations including nested sub-agent calls:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>useChat() {</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>messages</span><span class=p>,</span> <span class=nx>setMessages</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>&lt;</span><span class=nt>Message</span><span class=err>[]</span><span class=p>&gt;([]);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>isStreaming</span><span class=p>,</span> <span class=nx>setIsStreaming</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>activeTools</span><span class=p>,</span> <span class=nx>setActiveTools</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>&lt;</span><span class=nt>ToolCall</span><span class=err>[]</span><span class=p>&gt;([]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>sendMessage</span> <span class=o>=</span> <span class=nx>useCallback</span><span class=p>(</span><span class=kr>async</span> <span class=p>(</span><span class=nx>content</span>: <span class=kt>string</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>setIsStreaming</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=k>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=s2>&#34;/api/chat/stream&#34;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>method</span><span class=o>:</span> <span class=s2>&#34;POST&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>headers</span><span class=o>:</span> <span class=p>{</span> <span class=s2>&#34;Content-Type&#34;</span><span class=o>:</span> <span class=s2>&#34;application/json&#34;</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nx>body</span>: <span class=kt>JSON.stringify</span><span class=p>({</span> <span class=nx>message</span>: <span class=kt>content</span><span class=p>,</span> <span class=nx>session_id</span>: <span class=kt>sessionId</span> <span class=p>}),</span>
</span></span><span class=line><span class=cl>      <span class=nx>credentials</span><span class=o>:</span> <span class=s2>&#34;include&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>reader</span> <span class=o>=</span> <span class=nx>response</span><span class=p>.</span><span class=nx>body</span><span class=o>!</span><span class=p>.</span><span class=nx>getReader</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>decoder</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>TextDecoder</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>buffer</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=kc>true</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=p>{</span> <span class=nx>done</span><span class=p>,</span> <span class=nx>value</span> <span class=p>}</span> <span class=o>=</span> <span class=k>await</span> <span class=nx>reader</span><span class=p>.</span><span class=nx>read</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>done</span><span class=p>)</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=nx>buffer</span> <span class=o>+=</span> <span class=nx>decoder</span><span class=p>.</span><span class=nx>decode</span><span class=p>(</span><span class=nx>value</span><span class=p>,</span> <span class=p>{</span> <span class=nx>stream</span>: <span class=kt>true</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>lines</span> <span class=o>=</span> <span class=nx>buffer</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s2>&#34;\n\n&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>buffer</span> <span class=o>=</span> <span class=nx>lines</span><span class=p>.</span><span class=nx>pop</span><span class=p>()</span> <span class=o>||</span> <span class=s2>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>for</span> <span class=p>(</span><span class=kr>const</span> <span class=nx>line</span> <span class=k>of</span> <span class=nx>lines</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>line</span><span class=p>.</span><span class=nx>startsWith</span><span class=p>(</span><span class=s2>&#34;data: &#34;</span><span class=p>))</span> <span class=k>continue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>event</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>line</span><span class=p>.</span><span class=nx>slice</span><span class=p>(</span><span class=mi>6</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>switch</span> <span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=kr>type</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=k>case</span> <span class=s2>&#34;text_delta&#34;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>            <span class=nx>appendToCurrentMessage</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>text</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>          <span class=k>case</span> <span class=s2>&#34;tool_start&#34;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>            <span class=nx>addActiveToolCall</span><span class=p>(</span><span class=nx>event</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>          <span class=k>case</span> <span class=s2>&#34;tool_end&#34;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>            <span class=nx>resolveToolCall</span><span class=p>(</span><span class=nx>event</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>          <span class=k>case</span> <span class=s2>&#34;reasoning&#34;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>            <span class=nx>setReasoningText</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>text</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>setIsStreaming</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=p>[</span><span class=nx>sessionId</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>{</span> <span class=nx>messages</span><span class=p>,</span> <span class=nx>sendMessage</span><span class=p>,</span> <span class=nx>isStreaming</span><span class=p>,</span> <span class=nx>activeTools</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=design-language>Design Language<a hidden class=anchor aria-hidden=true href=#design-language>#</a></h3><p>The UI uses a dark theme with glass morphism effects, consistent with modern developer tools:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl><span class=p>.</span><span class=nc>glass</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>background</span><span class=p>:</span> <span class=nb>rgba</span><span class=p>(</span><span class=mi>255</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mf>0.05</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>backdrop-filter</span><span class=p>:</span> <span class=nb>blur</span><span class=p>(</span><span class=mi>12</span><span class=kt>px</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>border</span><span class=p>:</span> <span class=mi>1</span><span class=kt>px</span> <span class=kc>solid</span> <span class=nb>rgba</span><span class=p>(</span><span class=mi>255</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>The deep purple/navy gradient background, subtle transparency, and smooth Framer Motion transitions create a polished, professional interface that engineers enjoy using. The login screen (shown at the top of this article) sets the tone immediately.</p><h3 id=activity-sidebar>Activity Sidebar<a hidden class=anchor aria-hidden=true href=#activity-sidebar>#</a></h3><p>During streaming, an activity sidebar shows every tool invocation in real time:</p><pre tabindex=0><code>&gt; Gathering context for &#34;payment-service&#34;...
  &gt; gitlab_search_group: searching for payment-service
  &gt; gitlab_list_tree: reading repository structure
  &gt; gitlab_get_file: reading terraform/locals.tf

&gt; Investigating infrastructure...
  &gt; aws_ecs: describe_services on cluster payments-qual
  &gt; aws_cloudwatch: get_log_events for /ecs/payment-service
  &gt; aws_elb: describe_target_health for payment-tg
</code></pre><p>Sub-agent tool calls are nested under their parent, making the investigation flow transparent to the user.</p><hr><h2 id=kpi-dashboard>KPI Dashboard<a hidden class=anchor aria-hidden=true href=#kpi-dashboard>#</a></h2><p>Beyond SRE investigation, TARS includes a developer productivity dashboard that computes metrics from GitLab data:</p><ul><li><strong>Commit frequency</strong> by day/week/month</li><li><strong>Code volume</strong> (lines added/removed)</li><li><strong>MR activity</strong> (opened, merged, review time)</li><li><strong>Review metrics</strong> (comments given/received)</li><li><strong>Repository engagement</strong> (contribution distribution)</li></ul><p>The caching strategy is multi-layered to minimize GitLab API calls:</p><ol><li><strong>Raw GitLab data</strong>: 15-minute Redis cache</li><li><strong>Computed dashboard metrics</strong>: 1-hour Redis cache</li><li><strong>PostgreSQL snapshots</strong>: 4-hour persistent cache</li></ol><p>Data is fetched in fixed time buckets (15, 31, 91 days) regardless of what the user requests. If a user asks for &ldquo;last 7 days&rdquo; of data, the system fetches the 15-day bucket and filters client-side. This maximizes cache hit rates because different users requesting different time ranges all hit the same cached bucket.</p><hr><h2 id=memory-and-context-management>Memory and Context Management<a hidden class=anchor aria-hidden=true href=#memory-and-context-management>#</a></h2><p>TARS uses AWS Bedrock AgentCore for persistent memory across sessions. Three memory strategies are active:</p><ol><li><strong>User Preferences</strong>: How the user likes responses formatted, which accounts they frequently investigate, preferred output verbosity</li><li><strong>Semantic Facts</strong>: Discovered facts about the infrastructure (e.g., &ldquo;payment-service runs on cluster X in account Y&rdquo;)</li><li><strong>Session Summaries</strong>: Compressed summaries of past conversations for continuity</li></ol><p>The conversation manager uses a sliding window of 40 messages. When the window fills, older messages are summarized and stored in the summaries namespace. This means the agent can reference context from days-old conversations without consuming the full context window.</p><p>Users can view and manage their memory records through a dedicated Memory page, with ownership verification preventing cross-user data access.</p><hr><h2 id=database-design>Database Design<a hidden class=anchor aria-hidden=true href=#database-design>#</a></h2><p>The schema is intentionally minimal:</p><pre tabindex=0><code>User (UUID pk)
  ├── entra_id (unique, Entra ID SSO link)
  ├── display_name
  └── role (user/admin)

UserSettings (one-to-one with User)
  ├── keycloak_username / keycloak_password (encrypted)
  ├── gitlab_token (encrypted) / gitlab_base_url
  ├── corpgen_username / corpgen_password (encrypted)
  └── aws_otp_secret (encrypted)

UserSession (token pk)
  ├── user (FK)
  └── expires_at (sliding window)

ChatSession
  ├── user (FK)
  ├── title (auto-generated)
  └── output_mode (brief/standard/detailed)

Message
  ├── session (FK)
  ├── role (user/assistant/system)
  ├── content (text)
  └── metrics (JSON: duration, tokens)

ToolInvocation
  ├── message (FK)
  ├── tool_name, input_params, output, status
  └── timing (started_at, completed_at)

ChatShare
  ├── session (FK)
  ├── token (unique, time-limited)
  └── message_count_snapshot

DeveloperKPISnapshot
  ├── user (FK)
  ├── period, granularity
  ├── metrics (JSON)
  └── expires_at (4-hour TTL)
</code></pre><p>All sensitive fields use <code>EncryptedCharField</code>. KPI snapshots auto-expire after 4 hours. Chat shares have a 30-day TTL.</p><hr><h2 id=deployment>Deployment<a hidden class=anchor aria-hidden=true href=#deployment>#</a></h2><p>TARS deploys to ECS Fargate with Terraform:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-hcl data-lang=hcl><span class=line><span class=cl><span class=k>resource</span> <span class=s2>&#34;aws_ecs_service&#34; &#34;tars&#34;</span> {
</span></span><span class=line><span class=cl><span class=n>  name</span>            <span class=o>=</span> <span class=s2>&#34;tars&#34;</span>
</span></span><span class=line><span class=cl><span class=n>  cluster</span>         <span class=o>=</span> <span class=k>aws_ecs_cluster</span><span class=p>.</span><span class=k>tars</span><span class=p>.</span><span class=k>id</span>
</span></span><span class=line><span class=cl><span class=n>  task_definition</span> <span class=o>=</span> <span class=k>aws_ecs_task_definition</span><span class=p>.</span><span class=k>tars</span><span class=p>.</span><span class=k>arn</span>
</span></span><span class=line><span class=cl><span class=n>  desired_count</span>   <span class=o>=</span> <span class=m>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>capacity_provider_strategy</span> {
</span></span><span class=line><span class=cl><span class=n>    capacity_provider</span> <span class=o>=</span> <span class=s2>&#34;FARGATE_SPOT&#34;</span>
</span></span><span class=line><span class=cl><span class=n>    weight</span>            <span class=o>=</span> <span class=m>100</span>
</span></span><span class=line><span class=cl><span class=n>    base</span>              <span class=o>=</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>capacity_provider_strategy</span> {
</span></span><span class=line><span class=cl><span class=n>    capacity_provider</span> <span class=o>=</span> <span class=s2>&#34;FARGATE&#34;</span>
</span></span><span class=line><span class=cl><span class=n>    weight</span>            <span class=o>=</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>deployment_circuit_breaker</span> {
</span></span><span class=line><span class=cl><span class=n>    enable</span>   <span class=o>=</span> <span class=kt>true</span>
</span></span><span class=line><span class=cl><span class=n>    rollback</span> <span class=o>=</span> <span class=kt>true</span>
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>resource</span> <span class=s2>&#34;aws_ecs_task_definition&#34; &#34;tars&#34;</span> {
</span></span><span class=line><span class=cl><span class=n>  family</span>                   <span class=o>=</span> <span class=s2>&#34;tars&#34;</span>
</span></span><span class=line><span class=cl><span class=n>  requires_compatibilities</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;FARGATE&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>  network_mode</span>             <span class=o>=</span> <span class=s2>&#34;awsvpc&#34;</span>
</span></span><span class=line><span class=cl><span class=n>  cpu</span>                      <span class=o>=</span> <span class=m>1024</span><span class=c1>   # 1 vCPU
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>  memory</span>                   <span class=o>=</span> <span class=m>2048</span><span class=c1>   # 2 GB
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=k>runtime_platform</span> {
</span></span><span class=line><span class=cl><span class=n>    operating_system_family</span> <span class=o>=</span> <span class=s2>&#34;LINUX&#34;</span>
</span></span><span class=line><span class=cl><span class=n>    cpu_architecture</span>        <span class=o>=</span> <span class=s2>&#34;ARM64&#34;</span>
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>  container_definitions</span> <span class=o>=</span> <span class=k>jsonencode</span><span class=p>([</span>{
</span></span><span class=line><span class=cl><span class=n>    name</span>  <span class=o>=</span> <span class=s2>&#34;tars&#34;</span>
</span></span><span class=line><span class=cl><span class=n>    image</span> <span class=o>=</span> <span class=s2>&#34;${aws_ecr_repository.tars.repository_url}:latest&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>    portMappings</span> <span class=o>=</span> <span class=p>[</span>{
</span></span><span class=line><span class=cl><span class=n>      containerPort</span> <span class=o>=</span> <span class=m>8080</span>
</span></span><span class=line><span class=cl><span class=n>      protocol</span>      <span class=o>=</span> <span class=s2>&#34;tcp&#34;</span>
</span></span><span class=line><span class=cl>    }<span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>    secrets</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl><span class=n>      { name</span> <span class=o>=</span><span class=n> &#34;DJANGO_SECRET_KEY&#34;, valueFrom</span> <span class=o>=</span> <span class=k>aws_secretsmanager_secret</span><span class=p>.</span><span class=k>django</span><span class=p>.</span><span class=k>arn</span> }<span class=p>,</span>
</span></span><span class=line><span class=cl><span class=n>      { name</span> <span class=o>=</span><span class=n> &#34;DATABASE_URL&#34;, valueFrom</span> <span class=o>=</span> <span class=k>aws_secretsmanager_secret</span><span class=p>.</span><span class=k>db</span><span class=p>.</span><span class=k>arn</span> }<span class=p>,</span>
</span></span><span class=line><span class=cl><span class=n>      { name</span> <span class=o>=</span><span class=n> &#34;REDIS_URL&#34;, valueFrom</span> <span class=o>=</span> <span class=k>aws_secretsmanager_secret</span><span class=p>.</span><span class=k>redis</span><span class=p>.</span><span class=k>arn</span> }<span class=p>,</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>      # ... more secrets
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>]</span>
</span></span><span class=line><span class=cl>  }<span class=p>])</span>
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p>The multi-stage Dockerfile keeps the image small:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=c># Stage 1: Build frontend</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=s> node:20-alpine AS frontend</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app/frontend</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> frontend/package*.json ./<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> npm ci<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> frontend/ ./<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> npm run build<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># Stage 2: Production</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=s> python:3.13-slim</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># Install Python dependencies</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> backend/requirements.txt ./<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> pip install --no-cache-dir -r requirements.txt<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># Copy backend</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> backend/ ./<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># Copy built frontend + Nginx config</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> --from<span class=o>=</span>frontend /app/frontend/dist /app/static/frontend<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> nginx.conf /etc/nginx/nginx.conf<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># Nginx serves static + proxies to Uvicorn</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>EXPOSE</span><span class=s> 8080</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;supervisord&#34;</span><span class=p>,</span> <span class=s2>&#34;-c&#34;</span><span class=p>,</span> <span class=s2>&#34;supervisord.conf&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></div><hr><h2 id=lessons-learned>Lessons Learned<a hidden class=anchor aria-hidden=true href=#lessons-learned>#</a></h2><p>After building and operating TARS, here are the patterns that proved most valuable:</p><p><strong>1. Temperature 0.0 for investigation agents.</strong> SRE investigation requires determinism. You want the agent to follow the same procedures consistently. Creative responses are a liability when debugging production.</p><p><strong>2. Sub-agents are essential for complex investigations.</strong> A single agent trying to search GitLab, read code, check AWS, and analyze logs will lose track of its investigation plan. Sub-agents with focused tool sets produce much better results.</p><p><strong>3. Streaming is not optional.</strong> Investigations take 30-60 seconds. Without real-time streaming of tool calls and reasoning, users don&rsquo;t trust the system. Seeing the agent&rsquo;s thought process builds confidence in the results.</p><p><strong>4. Tool output truncation prevents context collapse.</strong> A single CloudWatch <code>get_log_events</code> call can return megabytes of data. Without aggressive truncation (12,000 chars), the context window fills with log noise and the agent loses track of its investigation.</p><p><strong>5. Read-only by default, always.</strong> An AI agent that can modify infrastructure is a liability. TARS is read-only for AWS by design. The only write operations allowed are creating GitLab branches, committing to non-protected branches, and creating merge requests. This means the worst-case scenario is an unwanted MR, which is trivially reversible.</p><p><strong>6. Per-user credentials, never shared.</strong> Each user authenticates with their own GitLab token and AWS SAML credentials. This means every action the agent takes is auditable to the individual user. If the agent reads a file in GitLab, it shows up in that user&rsquo;s access log.</p><p><strong>7. The system prompt is the product.</strong> 80% of the agent&rsquo;s quality comes from the system prompt, not the model or the tools. Investing weeks in crafting precise behavioral constraints, investigation procedures, and output formatting rules pays off enormously.</p><p><strong>8. Cache aggressively, but at the right granularity.</strong> The KPI dashboard&rsquo;s fixed-bucket caching strategy (fetch 15/31/91 day buckets regardless of user request) improved cache hit rates from ~20% to ~85%. The key insight is that the most expensive operation (GitLab API calls) should be cached at a coarser granularity than what the user sees.</p><hr><h2 id=whats-next>What&rsquo;s Next<a hidden class=anchor aria-hidden=true href=#whats-next>#</a></h2><p>The natural evolution is expanding TARS from investigation to remediation. Today it tells you what&rsquo;s wrong. Tomorrow it could:</p><ul><li>Create a hotfix branch with the correct code change</li><li>Open an MR with the fix, tagged for urgent review</li><li>Draft the incident report based on its investigation findings</li><li>Suggest runbook updates based on novel failure modes it discovers</li></ul><p>The foundation is already there. The tool policy system supports ELEVATED operations. The branch protection ensures writes are safe. The main challenge is building the right human-in-the-loop confirmation flow so the agent proposes changes but never applies them autonomously.</p><p>That&rsquo;s the endgame: an AI SRE that investigates like your best engineer, communicates like your best technical writer, and never needs to sleep.</p><hr><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ul><li><a href=https://github.com/strands-agents/sdk-python>Strands Agents SDK</a></li><li><a href=https://docs.djangoproject.com/en/5.0/topics/async/>Django Async Views</a></li><li><a href=https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events>Server-Sent Events (MDN)</a></li><li><a href=https://oauth.net/2/pkce/>PKCE OAuth2 Flow</a></li><li><a href=https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithSAML.html>AWS STS AssumeRoleWithSAML</a></li><li><a href=https://www.radix-ui.com/>Radix UI</a></li><li><a href=https://guide.elm-lang.org/architecture/>The Elm Architecture</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://manuelfedele.github.io/tags/ai/>AI</a></li><li><a href=https://manuelfedele.github.io/tags/python/>Python</a></li><li><a href=https://manuelfedele.github.io/tags/django/>Django</a></li><li><a href=https://manuelfedele.github.io/tags/react/>React</a></li><li><a href=https://manuelfedele.github.io/tags/aws/>AWS</a></li><li><a href=https://manuelfedele.github.io/tags/gitlab/>GitLab</a></li><li><a href=https://manuelfedele.github.io/tags/llm/>LLM</a></li><li><a href=https://manuelfedele.github.io/tags/devops/>DevOps</a></li><li><a href=https://manuelfedele.github.io/tags/sre/>SRE</a></li><li><a href=https://manuelfedele.github.io/tags/architecture/>Architecture</a></li></ul><nav class=paginav><a class=next href=https://manuelfedele.github.io/posts/building-ai-powered-platform-operations-agent/><span class=title>Next »</span><br><span>Building an AI-Powered Platform Operations Agent</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator on x" href="https://x.com/intent/tweet/?text=Building%20an%20AI%20SRE%20Assistant%20From%20Scratch%3a%20Architecture%20of%20an%20Autonomous%20Infrastructure%20Investigator&amp;url=https%3a%2f%2fmanuelfedele.github.io%2fposts%2fbuilding-ai-sre-assistant-from-scratch%2f&amp;hashtags=AI%2cpython%2cdjango%2creact%2cAWS%2cGitLab%2cLLM%2cDevOps%2cSRE%2carchitecture"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fmanuelfedele.github.io%2fposts%2fbuilding-ai-sre-assistant-from-scratch%2f&amp;title=Building%20an%20AI%20SRE%20Assistant%20From%20Scratch%3a%20Architecture%20of%20an%20Autonomous%20Infrastructure%20Investigator&amp;summary=Building%20an%20AI%20SRE%20Assistant%20From%20Scratch%3a%20Architecture%20of%20an%20Autonomous%20Infrastructure%20Investigator&amp;source=https%3a%2f%2fmanuelfedele.github.io%2fposts%2fbuilding-ai-sre-assistant-from-scratch%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fmanuelfedele.github.io%2fposts%2fbuilding-ai-sre-assistant-from-scratch%2f&title=Building%20an%20AI%20SRE%20Assistant%20From%20Scratch%3a%20Architecture%20of%20an%20Autonomous%20Infrastructure%20Investigator"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fmanuelfedele.github.io%2fposts%2fbuilding-ai-sre-assistant-from-scratch%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator on whatsapp" href="https://api.whatsapp.com/send?text=Building%20an%20AI%20SRE%20Assistant%20From%20Scratch%3a%20Architecture%20of%20an%20Autonomous%20Infrastructure%20Investigator%20-%20https%3a%2f%2fmanuelfedele.github.io%2fposts%2fbuilding-ai-sre-assistant-from-scratch%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator on telegram" href="https://telegram.me/share/url?text=Building%20an%20AI%20SRE%20Assistant%20From%20Scratch%3a%20Architecture%20of%20an%20Autonomous%20Infrastructure%20Investigator&amp;url=https%3a%2f%2fmanuelfedele.github.io%2fposts%2fbuilding-ai-sre-assistant-from-scratch%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator on ycombinator" href="https://news.ycombinator.com/submitlink?t=Building%20an%20AI%20SRE%20Assistant%20From%20Scratch%3a%20Architecture%20of%20an%20Autonomous%20Infrastructure%20Investigator&u=https%3a%2f%2fmanuelfedele.github.io%2fposts%2fbuilding-ai-sre-assistant-from-scratch%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//manuelfedele-github-io.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2026 <a href=https://manuelfedele.github.io/>Git Push and Run</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>