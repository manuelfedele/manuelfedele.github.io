<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=false><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator &#183; Git Push and Run</title><meta name=title content="Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator &#183; Git Push and Run"><meta name=description content="Software Engineer and Cloud Architect writing about Go, Python, AWS, and AI automation."><meta name=keywords content="AI,python,django,react,AWS,GitLab,LLM,DevOps,SRE,architecture,"><link rel=canonical href=https://manuelfedele.github.io/posts/building-ai-sre-assistant-from-scratch/><meta name=author content="Manuel Fedele"><link href=https://github.com/manuelfedele rel=me><link href=https://linkedin.com/in/manuel-fedele rel=me><meta property="og:url" content="https://manuelfedele.github.io/posts/building-ai-sre-assistant-from-scratch/"><meta property="og:site_name" content="Git Push and Run"><meta property="og:title" content="Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator"><meta property="og:description" content="Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator # What if your on-call engineer never slept, had instant access to every repository and every AWS account, and could trace a production issue from DNS to database in under a minute?
That’s the question that led me to build TARS, an AI-powered SRE assistant that autonomously investigates infrastructure issues by combining LLM reasoning with deep integrations into GitLab and AWS. Named after the robot from Interstellar (because every good internal tool needs a movie reference), TARS is a full-stack application where engineers interact with an AI agent through a chat interface. The agent doesn’t just answer questions. It investigates. It clones repos, greps code, reads CloudWatch logs, traces DNS chains, inspects ECS services, and synthesizes findings into structured reports."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-02-22T09:30:00+01:00"><meta property="article:modified_time" content="2026-02-22T09:30:00+01:00"><meta property="article:tag" content="AI"><meta property="article:tag" content="Python"><meta property="article:tag" content="Django"><meta property="article:tag" content="React"><meta property="article:tag" content="AWS"><meta property="article:tag" content="GitLab"><meta name=twitter:card content="summary"><meta name=twitter:title content="Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator"><meta name=twitter:description content="Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator # What if your on-call engineer never slept, had instant access to every repository and every AWS account, and could trace a production issue from DNS to database in under a minute?
That’s the question that led me to build TARS, an AI-powered SRE assistant that autonomously investigates infrastructure issues by combining LLM reasoning with deep integrations into GitLab and AWS. Named after the robot from Interstellar (because every good internal tool needs a movie reference), TARS is a full-stack application where engineers interact with an AI agent through a chat interface. The agent doesn’t just answer questions. It investigates. It clones repos, greps code, reads CloudWatch logs, traces DNS chains, inspects ECS services, and synthesizes findings into structured reports."><link type=text/css rel=stylesheet href=/css/main.bundle.min.726dfbf42bcd66e35e2d7258d72fe8fe77509ff76d153e2b46cdbae9c3af9620653459f0119a72d2af4a9b4bc446652d244ad58743d0290e5d8e09e3983b98e5.css integrity="sha512-cm379CvNZuNeLXJY1y/o/ndQn/dtFT4rRs266cOvliBlNFnwEZpy0q9Km0vERmUtJErVh0PQKQ5djgnjmDuY5Q=="><script type=text/javascript src=/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js integrity="sha512-b0EXSzoFtoCCD+CMrb+l+3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.88278edec77139635e1ad294df5b32b7be9338191c5252d3f6f451ace5852d5f82390cccacedab9c64739d8e068b7e8502895cf8f951060c0368f9a73709fcb7.js integrity="sha512-iCeO3sdxOWNeGtKU31syt76TOBkcUlLT9vRRrOWFLV+COQzMrO2rnGRznY4Gi36FAolc+PlRBgwDaPmnNwn8tw==" data-copy=Copy data-copied=Copied></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator","headline":"Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator","inLanguage":"en","url":"https://manuelfedele.github.io/posts/building-ai-sre-assistant-from-scratch/","author":{"@type":"Person","name":"Manuel Fedele"},"copyrightYear":"2026","dateCreated":"2026-02-22T09:30:00\u002b01:00","datePublished":"2026-02-22T09:30:00\u002b01:00","dateModified":"2026-02-22T09:30:00\u002b01:00","keywords":["AI","python","django","react","AWS","GitLab","LLM","DevOps","SRE","architecture"],"mainEntityOfPage":"true","wordCount":"4535"}]</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-K9P1DJX238"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-K9P1DJX238")</script></head><body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral bf-scrollbar"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 z-100"><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl bg-neutral/25 dark:bg-neutral-800/25"></div><div class="relative m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32"><div class="main-menu flex items-center w-full gap-2 p-1 pl-0"><a href=/ class="text-base font-medium truncate min-w-0 shrink">Git Push and Run</a><div class="flex items-center ms-auto"><div class="hidden md:flex"><nav class="flex items-center gap-x-5 h-12"><a href=/posts/ class="flex items-center bf-icon-color-hover" aria-label=Blog title=Posts><span class="text-base font-medium break-normal">Blog
</span></a><a href=/about/ class="flex items-center bf-icon-color-hover" aria-label=About title=About><span class="text-base font-medium break-normal">About
</span></a><a href=https://github.com/manuelfedele target=_blank class="flex items-center bf-icon-color-hover" aria-label=github title><span><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><button id=search-button aria-label=Search class="text-base bf-icon-color-hover" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button></nav></div><div class="flex md:hidden"><div class="flex items-center h-14 gap-4"><button id=search-button-mobile aria-label=Search class="flex items-center justify-center bf-icon-color-hover" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<input type=checkbox id=mobile-menu-toggle autocomplete=off class="hidden peer">
<label for=mobile-menu-toggle class="flex items-center justify-center cursor-pointer bf-icon-color-hover"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></label><div role=dialog aria-modal=true style=scrollbar-gutter:stable class="fixed inset-0 z-50 invisible overflow-y-auto px-6 py-20 opacity-0 transition-[opacity,visibility] duration-300 peer-checked:visible peer-checked:opacity-100 bg-neutral-50/97 dark:bg-neutral-900/99
bf-scrollbar"><label for=mobile-menu-toggle class="fixed end-8 top-5 flex items-center justify-center z-50 h-12 w-12 cursor-pointer select-none rounded-full bf-icon-color-hover border bf-border-color bf-border-color-hover bg-neutral-50 dark:bg-neutral-900"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></label><nav class="mx-auto max-w-md space-y-6"><div class=px-2><a href=/posts/ aria-label=Blog class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=Posts class="text-2xl font-bold tracking-tight">Blog</span></a></div><div class=px-2><a href=/about/ aria-label=About class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=About class="text-2xl font-bold tracking-tight">About</span></a></div><div class=px-2><a href=https://github.com/manuelfedele aria-label=github target=_blank class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span class="flex items-center justify-center h-8 w-8 text-2xl"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span><span title class="text-2xl font-bold tracking-tight"></span></a></div></nav></div></div></div></div></div><script>(function(){var t,n,e=document.querySelector(".main-menu");if(!e)return;t=window.location.pathname,n=e.querySelectorAll('a[href="'+t+'"]'),n.forEach(function(e){var t=e.querySelectorAll("span");t.forEach(function(e){e.classList.add("active")})})})()</script></div></div><script type=text/javascript src=/js/background-blur.min.00a57c73ea12f2cab2980c3c3d649e89f6d82f190f74bbe2b67f2f5e39ab7d032ece47086400ca05396758aace13299da49aca43ea643d2625e62c506267a169.js integrity="sha512-AKV8c+oS8sqymAw8PWSeifbYLxkPdLvitn8vXjmrfQMuzkcIZADKBTlnWKrOEymdpJrKQ+pkPSYl5ixQYmehaQ==" data-blur-id=menu-blur></script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2026-02-22T09:30:00+01:00>22 February 2026</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">22 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/tags/ai/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">AI
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/python/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Python
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/django/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Django
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/react/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">React
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/aws/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">AWS
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/gitlab/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">GitLab
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/llm/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">LLM
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/devops/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">DevOps
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/sre/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">SRE
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/architecture/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Architecture</span></span></a></div></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ms-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs"><div class="toc ps-5 print:hidden lg:sticky lg:top-[140px]"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain bf-scrollbar rounded-lg -ms-5 ps-5 pe-2 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#table-of-contents>Table of Contents</a></li><li><a href=#the-problem>The Problem</a></li><li><a href=#architecture-overview>Architecture Overview</a></li><li><a href=#tech-stack>Tech Stack</a></li><li><a href=#authentication-four-layers-deep>Authentication: Four Layers Deep</a><ul><li><a href=#layer-1-microsoft-entra-id-user-identity>Layer 1: Microsoft Entra ID (User Identity)</a></li><li><a href=#layer-2-gitlab-repository-access>Layer 2: GitLab (Repository Access)</a></li><li><a href=#layer-3-aws-saml-federation-infrastructure-access>Layer 3: AWS SAML Federation (Infrastructure Access)</a></li><li><a href=#layer-4-keycloak-llm-gateway-access>Layer 4: Keycloak (LLM Gateway Access)</a></li></ul></li><li><a href=#the-agent-system>The Agent System</a><ul><li><a href=#the-system-prompt>The System Prompt</a></li></ul></li><li><a href=#tool-registry-30-specialized-tools>Tool Registry: 30+ Specialized Tools</a><ul><li><a href=#aws-tools-read-only>AWS Tools (Read-Only)</a></li><li><a href=#gitlab-tools>GitLab Tools</a></li><li><a href=#the-repo_grep-tool>The repo_grep Tool</a></li></ul></li><li><a href=#sub-agent-architecture>Sub-Agent Architecture</a></li><li><a href=#security-model>Security Model</a><ul><li><a href=#level-1-tool-policy-classification>Level 1: Tool Policy Classification</a></li><li><a href=#level-2-branch-protection>Level 2: Branch Protection</a></li><li><a href=#level-3-network-safety>Level 3: Network Safety</a></li><li><a href=#level-4-output-sanitization>Level 4: Output Sanitization</a></li></ul></li><li><a href=#streaming-infrastructure>Streaming Infrastructure</a></li><li><a href=#the-frontend>The Frontend</a><ul><li><a href=#the-usechat-hook>The useChat Hook</a></li><li><a href=#design-language>Design Language</a></li><li><a href=#activity-sidebar>Activity Sidebar</a></li></ul></li><li><a href=#kpi-dashboard>KPI Dashboard</a></li><li><a href=#memory-and-context-management>Memory and Context Management</a></li><li><a href=#database-design>Database Design</a></li><li><a href=#deployment>Deployment</a></li><li><a href=#lessons-learned>Lessons Learned</a></li><li><a href=#whats-next>What&rsquo;s Next</a></li><li><a href=#references>References</a></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#table-of-contents>Table of Contents</a></li><li><a href=#the-problem>The Problem</a></li><li><a href=#architecture-overview>Architecture Overview</a></li><li><a href=#tech-stack>Tech Stack</a></li><li><a href=#authentication-four-layers-deep>Authentication: Four Layers Deep</a><ul><li><a href=#layer-1-microsoft-entra-id-user-identity>Layer 1: Microsoft Entra ID (User Identity)</a></li><li><a href=#layer-2-gitlab-repository-access>Layer 2: GitLab (Repository Access)</a></li><li><a href=#layer-3-aws-saml-federation-infrastructure-access>Layer 3: AWS SAML Federation (Infrastructure Access)</a></li><li><a href=#layer-4-keycloak-llm-gateway-access>Layer 4: Keycloak (LLM Gateway Access)</a></li></ul></li><li><a href=#the-agent-system>The Agent System</a><ul><li><a href=#the-system-prompt>The System Prompt</a></li></ul></li><li><a href=#tool-registry-30-specialized-tools>Tool Registry: 30+ Specialized Tools</a><ul><li><a href=#aws-tools-read-only>AWS Tools (Read-Only)</a></li><li><a href=#gitlab-tools>GitLab Tools</a></li><li><a href=#the-repo_grep-tool>The repo_grep Tool</a></li></ul></li><li><a href=#sub-agent-architecture>Sub-Agent Architecture</a></li><li><a href=#security-model>Security Model</a><ul><li><a href=#level-1-tool-policy-classification>Level 1: Tool Policy Classification</a></li><li><a href=#level-2-branch-protection>Level 2: Branch Protection</a></li><li><a href=#level-3-network-safety>Level 3: Network Safety</a></li><li><a href=#level-4-output-sanitization>Level 4: Output Sanitization</a></li></ul></li><li><a href=#streaming-infrastructure>Streaming Infrastructure</a></li><li><a href=#the-frontend>The Frontend</a><ul><li><a href=#the-usechat-hook>The useChat Hook</a></li><li><a href=#design-language>Design Language</a></li><li><a href=#activity-sidebar>Activity Sidebar</a></li></ul></li><li><a href=#kpi-dashboard>KPI Dashboard</a></li><li><a href=#memory-and-context-management>Memory and Context Management</a></li><li><a href=#database-design>Database Design</a></li><li><a href=#deployment>Deployment</a></li><li><a href=#lessons-learned>Lessons Learned</a></li><li><a href=#whats-next>What&rsquo;s Next</a></li><li><a href=#references>References</a></li></ul></nav></div></details><script>(function(){"use strict";const s=.33,o="#TableOfContents",i=".anchor",a='a[href^="#"]',r="li ul",c="active";let t=!1;function l(e,n){const o=window.scrollY+window.innerHeight*n,i=[...document.querySelectorAll('#TableOfContents a[href^="#"]')],s=new Set(i.map(e=>e.getAttribute("href").substring(1)));if(t)for(let t=0;t<e.length;t++){const n=e[t];if(!s.has(n.id))continue;const o=n.getBoundingClientRect().top+window.scrollY;if(Math.abs(window.scrollY-o)<100)return n.id}for(let t=e.length-1;t>=0;t--){const n=e[t].getBoundingClientRect().top+window.scrollY;if(n<=o&&s.has(e[t].id))return e[t].id}return e.find(e=>s.has(e.id))?.id||""}function e({toc:e,anchors:t,links:n,scrollOffset:s,collapseInactive:o}){const i=l(t,s);if(!i)return;if(n.forEach(e=>{const t=e.getAttribute("href")===`#${i}`;if(e.classList.toggle(c,t),o){const n=e.closest("li")?.querySelector("ul");n&&(n.style.display=t?"":"none")}}),o){const n=e.querySelector(`a[href="#${CSS.escape(i)}"]`);let t=n;for(;t&&t!==e;)t.tagName==="UL"&&(t.style.display=""),t.tagName==="LI"&&t.querySelector("ul")?.style.setProperty("display",""),t=t.parentElement}}function n(){const n=document.querySelector(o);if(!n)return;const l=!0,u=[...document.querySelectorAll(i)],d=[...n.querySelectorAll(a)];l&&n.querySelectorAll(r).forEach(e=>e.style.display="none"),d.forEach(e=>{e.addEventListener("click",()=>{t=!0})});const c={toc:n,anchors:u,links:d,scrollOffset:s,collapseInactive:l};window.addEventListener("scroll",()=>e(c),{passive:!0}),window.addEventListener("hashchange",()=>e(c),{passive:!0}),e(c)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",n):n()})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><h1 class="relative group">Building an AI SRE Assistant From Scratch: Architecture of an Autonomous Infrastructure Investigator<div id=building-an-ai-sre-assistant-from-scratch-architecture-of-an-autonomous-infrastructure-investigator class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#building-an-ai-sre-assistant-from-scratch-architecture-of-an-autonomous-infrastructure-investigator aria-label=Anchor>#</a></span></h1><p>What if your on-call engineer never slept, had instant access to every repository and every AWS account, and could trace a production issue from DNS to database in under a minute?</p><p>That&rsquo;s the question that led me to build TARS, an AI-powered SRE assistant that autonomously investigates infrastructure issues by combining LLM reasoning with deep integrations into GitLab and AWS. Named after the robot from Interstellar (because every good internal tool needs a movie reference), TARS is a full-stack application where engineers interact with an AI agent through a chat interface. The agent doesn&rsquo;t just answer questions. It investigates. It clones repos, greps code, reads CloudWatch logs, traces DNS chains, inspects ECS services, and synthesizes findings into structured reports.</p><p>In this post I&rsquo;ll walk through every layer of the architecture: the authentication system, the agent framework, the tool registry, the streaming infrastructure, the frontend, and the deployment patterns that make it all work in production.</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="TARS Login Screen" src=/img/tars/login.png></figure><em>The TARS login screen. Microsoft Entra ID SSO provides zero-friction authentication for the engineering team.</em></p><hr><h2 class="relative group">Table of Contents<div id=table-of-contents class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#table-of-contents aria-label=Anchor>#</a></span></h2><ul><li><a href=/posts/building-ai-sre-assistant-from-scratch/#the-problem>The Problem</a></li><li><a href=/posts/building-ai-sre-assistant-from-scratch/#architecture-overview>Architecture Overview</a></li><li><a href=/posts/building-ai-sre-assistant-from-scratch/#tech-stack>Tech Stack</a></li><li><a href=/posts/building-ai-sre-assistant-from-scratch/#authentication-four-layers-deep>Authentication: Four Layers Deep</a></li><li><a href=/posts/building-ai-sre-assistant-from-scratch/#the-agent-system>The Agent System</a></li><li><a href=/posts/building-ai-sre-assistant-from-scratch/#tool-registry-30-specialized-tools>Tool Registry: 30+ Specialized Tools</a></li><li><a href=/posts/building-ai-sre-assistant-from-scratch/#sub-agent-architecture>Sub-Agent Architecture</a></li><li><a href=/posts/building-ai-sre-assistant-from-scratch/#security-model>Security Model</a></li><li><a href=/posts/building-ai-sre-assistant-from-scratch/#streaming-infrastructure>Streaming Infrastructure</a></li><li><a href=/posts/building-ai-sre-assistant-from-scratch/#the-frontend>The Frontend</a></li><li><a href=/posts/building-ai-sre-assistant-from-scratch/#kpi-dashboard>KPI Dashboard</a></li><li><a href=/posts/building-ai-sre-assistant-from-scratch/#memory-and-context-management>Memory and Context Management</a></li><li><a href=/posts/building-ai-sre-assistant-from-scratch/#database-design>Database Design</a></li><li><a href=/posts/building-ai-sre-assistant-from-scratch/#deployment>Deployment</a></li><li><a href=/posts/building-ai-sre-assistant-from-scratch/#lessons-learned>Lessons Learned</a></li></ul><hr><h2 class="relative group">The Problem<div id=the-problem class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#the-problem aria-label=Anchor>#</a></span></h2><p>Platform teams at scale face a recurring challenge: investigating production issues requires correlating information across multiple systems. A typical investigation might look like:</p><ol><li>Someone reports a 503 error on a service</li><li>You check the ALB target group health</li><li>Targets are unhealthy, so you check the ECS service</li><li>ECS shows a deployment in progress, so you check the task definition</li><li>The image tag points to a commit, so you check GitLab</li><li>The last MR changed a health check endpoint, so you read the code</li><li>The code has a bug in the new health check, so you check CloudWatch logs to confirm</li><li>Logs confirm the error, you write up the finding</li></ol><p>Each step requires switching context, authenticating to a different system, navigating a different UI, and mentally correlating the results. For an experienced engineer, this takes 15-30 minutes. For a junior engineer, it can take hours, and they might miss steps entirely.</p><p>TARS automates this entire workflow. You type &ldquo;investigate the 503 errors on service X&rdquo; and the agent autonomously:</p><ul><li>Finds the service in GitLab</li><li>Reads the repository structure and configuration</li><li>Identifies the AWS account and region</li><li>Checks ALB target health, ECS service status, and recent deployments</li><li>Reads CloudWatch logs for error patterns</li><li>Checks recent MRs and commits for relevant changes</li><li>Correlates all findings and presents a structured report</li></ul><p>The key insight is that SRE investigation is largely procedural. The steps follow patterns. What makes a good SRE isn&rsquo;t memorizing those patterns, it&rsquo;s knowing which patterns to apply and how to interpret the results. That&rsquo;s exactly what LLMs excel at.</p><hr><h2 class="relative group">Architecture Overview<div id=architecture-overview class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#architecture-overview aria-label=Anchor>#</a></span></h2><p>TARS is a monolith deployed as a single container. The architecture is intentionally simple:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>VPN -&gt; Internal ALB (HTTPS/443, TLS 1.3)
</span></span><span style=display:flex><span>           |
</span></span><span style=display:flex><span>           v
</span></span><span style=display:flex><span>    ECS Fargate (port 8080)
</span></span><span style=display:flex><span>           |
</span></span><span style=display:flex><span>           v
</span></span><span style=display:flex><span>    Nginx (port 8080)
</span></span><span style=display:flex><span>    /              \
</span></span><span style=display:flex><span>/assets/*         /api/*
</span></span><span style=display:flex><span>(static SPA)      (reverse proxy)
</span></span><span style=display:flex><span>                       |
</span></span><span style=display:flex><span>                       v
</span></span><span style=display:flex><span>               Uvicorn (port 8000)
</span></span><span style=display:flex><span>               Django ASGI
</span></span><span style=display:flex><span>              /     |      \
</span></span><span style=display:flex><span>      PostgreSQL  Redis  AWS Bedrock
</span></span><span style=display:flex><span>      (Aurora)  (ElastiCache) (AgentCore Memory)</span></span></code></pre></div></div><p>The frontend is a React SPA served by Nginx. API requests are proxied to the Django backend running on Uvicorn with ASGI support (critical for SSE streaming). PostgreSQL stores users, sessions, chat history, and KPI snapshots. Redis caches AWS credentials, GitLab API responses, and computed dashboard data. AWS Bedrock AgentCore provides persistent memory across sessions.</p><p>Why a monolith? Because the operational complexity of a microservice architecture is not justified when you have a single team, a single deployment target, and a single user-facing application. The monolith deploys in seconds, has one set of logs to check, and one service to monitor. If it ever needs to be split, the code is modular enough to extract services later.</p><hr><h2 class="relative group">Tech Stack<div id=tech-stack class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#tech-stack aria-label=Anchor>#</a></span></h2><p><strong>Backend:</strong></p><ul><li>Python 3.12+ with Django 6.0</li><li>Async support via <code>adrf</code> (async Django REST Framework)</li><li>Uvicorn as the ASGI server</li><li><code>strands-agents</code> for the AI agent framework</li><li><code>httpx</code> for async HTTP clients</li><li><code>msal</code> for Microsoft Entra ID OAuth2</li><li><code>requests-ntlm</code> for ADFS/SAML corporate auth</li><li><code>pyotp</code> for TOTP generation</li><li>Fernet encryption for credential storage</li></ul><p><strong>Frontend:</strong></p><ul><li>React 19 with TypeScript 5</li><li>Vite 7 as the build tool</li><li>Tailwind CSS 3 for styling</li><li>Radix UI for accessible primitives</li><li>Framer Motion for animations</li><li>Recharts for data visualization</li><li>React Hook Form + Zod for form validation</li><li>SSE (Server-Sent Events) for real-time streaming</li></ul><p><strong>Infrastructure:</strong></p><ul><li>AWS ECS Fargate (Spot + On-Demand)</li><li>Aurora PostgreSQL Serverless v2</li><li>ElastiCache Redis</li><li>Internal ALB with WAF</li><li>Terraform for IaC</li><li>Docker multi-stage build (Node 20 Alpine + Python 3.13 slim)</li></ul><hr><h2 class="relative group">Authentication: Four Layers Deep<div id=authentication-four-layers-deep class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#authentication-four-layers-deep aria-label=Anchor>#</a></span></h2><p>Authentication in TARS isn&rsquo;t just about identifying the user. It&rsquo;s about establishing trust chains across four distinct systems: the application itself, GitLab, AWS (via corporate SAML federation), and the LLM Gateway (via Keycloak). Each layer serves a different purpose, and each requires its own credential management.</p><h3 class="relative group">Layer 1: Microsoft Entra ID (User Identity)<div id=layer-1-microsoft-entra-id-user-identity class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#layer-1-microsoft-entra-id-user-identity aria-label=Anchor>#</a></span></h3><p>The primary authentication uses OAuth2 Authorization Code flow with PKCE:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#6272a4># Simplified OAuth2 PKCE flow</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>class</span> <span style=color:#50fa7b>AuthCallbackView</span>(APIView):
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>async</span> <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>post</span>(<span style=font-style:italic>self</span>, request):
</span></span><span style=display:flex><span>        code <span style=color:#ff79c6>=</span> request<span style=color:#ff79c6>.</span>data[<span style=color:#f1fa8c>&#34;code&#34;</span>]
</span></span><span style=display:flex><span>        code_verifier <span style=color:#ff79c6>=</span> request<span style=color:#ff79c6>.</span>data[<span style=color:#f1fa8c>&#34;code_verifier&#34;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#6272a4># Exchange authorization code for tokens</span>
</span></span><span style=display:flex><span>        msal_app <span style=color:#ff79c6>=</span> ConfidentialClientApplication(
</span></span><span style=display:flex><span>            client_id<span style=color:#ff79c6>=</span>settings<span style=color:#ff79c6>.</span>ENTRA_CLIENT_ID,
</span></span><span style=display:flex><span>            authority<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;https://login.microsoftonline.com/</span><span style=color:#f1fa8c>{</span>settings<span style=color:#ff79c6>.</span>ENTRA_TENANT_ID<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>&#34;</span>,
</span></span><span style=display:flex><span>            client_credential<span style=color:#ff79c6>=</span>settings<span style=color:#ff79c6>.</span>ENTRA_CLIENT_SECRET,
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        result <span style=color:#ff79c6>=</span> msal_app<span style=color:#ff79c6>.</span>acquire_token_by_authorization_code(
</span></span><span style=display:flex><span>            code<span style=color:#ff79c6>=</span>code,
</span></span><span style=display:flex><span>            scopes<span style=color:#ff79c6>=</span>[<span style=color:#f1fa8c>&#34;User.Read&#34;</span>],
</span></span><span style=display:flex><span>            redirect_uri<span style=color:#ff79c6>=</span>settings<span style=color:#ff79c6>.</span>ENTRA_REDIRECT_URI,
</span></span><span style=display:flex><span>            code_verifier<span style=color:#ff79c6>=</span>code_verifier,
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#6272a4># Validate the ID token signature against Microsoft JWKS</span>
</span></span><span style=display:flex><span>        id_token <span style=color:#ff79c6>=</span> validate_and_decode_token(result[<span style=color:#f1fa8c>&#34;id_token&#34;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#6272a4># Create or update user</span>
</span></span><span style=display:flex><span>        user, _ <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>await</span> User<span style=color:#ff79c6>.</span>objects<span style=color:#ff79c6>.</span>aupdate_or_create(
</span></span><span style=display:flex><span>            entra_id<span style=color:#ff79c6>=</span>id_token[<span style=color:#f1fa8c>&#34;oid&#34;</span>],
</span></span><span style=display:flex><span>            defaults<span style=color:#ff79c6>=</span>{<span style=color:#f1fa8c>&#34;display_name&#34;</span>: id_token[<span style=color:#f1fa8c>&#34;name&#34;</span>]},
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#6272a4># Create session with sliding window expiry</span>
</span></span><span style=display:flex><span>        session <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>await</span> UserSession<span style=color:#ff79c6>.</span>objects<span style=color:#ff79c6>.</span>acreate(
</span></span><span style=display:flex><span>            user<span style=color:#ff79c6>=</span>user,
</span></span><span style=display:flex><span>            expires_at<span style=color:#ff79c6>=</span>now() <span style=color:#ff79c6>+</span> timedelta(hours<span style=color:#ff79c6>=</span><span style=color:#bd93f9>24</span>),
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#6272a4># Set HttpOnly, Secure, SameSite=Strict cookie</span>
</span></span><span style=display:flex><span>        response <span style=color:#ff79c6>=</span> Response({<span style=color:#f1fa8c>&#34;user&#34;</span>: UserSerializer(user)<span style=color:#ff79c6>.</span>data})
</span></span><span style=display:flex><span>        response<span style=color:#ff79c6>.</span>set_cookie(
</span></span><span style=display:flex><span>            <span style=color:#f1fa8c>&#34;session_id&#34;</span>, session<span style=color:#ff79c6>.</span>token,
</span></span><span style=display:flex><span>            httponly<span style=color:#ff79c6>=</span><span style=color:#ff79c6>True</span>, secure<span style=color:#ff79c6>=</span><span style=color:#ff79c6>True</span>, samesite<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;Strict&#34;</span>,
</span></span><span style=display:flex><span>            max_age<span style=color:#ff79c6>=</span><span style=color:#bd93f9>86400</span>,
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>return</span> response</span></span></code></pre></div></div><p>The PKCE flow prevents authorization code interception attacks. The session cookie is <code>HttpOnly</code> (no JavaScript access), <code>Secure</code> (HTTPS only), and <code>SameSite=Strict</code> (no CSRF). Session expiry uses a sliding window: each authenticated request extends the session, but only if at least 300 seconds have passed since the last extension (to avoid hammering the database on every request).</p><h3 class="relative group">Layer 2: GitLab (Repository Access)<div id=layer-2-gitlab-repository-access class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#layer-2-gitlab-repository-access aria-label=Anchor>#</a></span></h3><p>Users configure their GitLab personal access token in the Settings page. The token is encrypted with Fernet symmetric encryption before storage:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff79c6>class</span> <span style=color:#50fa7b>EncryptedCharField</span>(models<span style=color:#ff79c6>.</span>CharField):
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#34;&#34;&#34;Transparently encrypts/decrypts field values using Fernet.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>__init__</span>(<span style=font-style:italic>self</span>, <span style=color:#ff79c6>*</span>args, <span style=color:#ff79c6>**</span>kwargs):
</span></span><span style=display:flex><span>        <span style=font-style:italic>self</span><span style=color:#ff79c6>.</span>fernet <span style=color:#ff79c6>=</span> Fernet(settings<span style=color:#ff79c6>.</span>FIELD_ENCRYPTION_KEY)
</span></span><span style=display:flex><span>        <span style=color:#8be9fd;font-style:italic>super</span>()<span style=color:#ff79c6>.</span><span style=color:#50fa7b>__init__</span>(<span style=color:#ff79c6>*</span>args, <span style=color:#ff79c6>**</span>kwargs)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>get_prep_value</span>(<span style=font-style:italic>self</span>, value):
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span> value:
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>return</span> <span style=font-style:italic>self</span><span style=color:#ff79c6>.</span>fernet<span style=color:#ff79c6>.</span>encrypt(value<span style=color:#ff79c6>.</span>encode())<span style=color:#ff79c6>.</span>decode()
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>return</span> value
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>from_db_value</span>(<span style=font-style:italic>self</span>, value, expression, connection):
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span> value:
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>return</span> <span style=font-style:italic>self</span><span style=color:#ff79c6>.</span>fernet<span style=color:#ff79c6>.</span>decrypt(value<span style=color:#ff79c6>.</span>encode())<span style=color:#ff79c6>.</span>decode()
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>return</span> value</span></span></code></pre></div></div><p>The encryption key is derived from <code>DJANGO_SECRET_KEY</code> and stored in AWS Secrets Manager. This means even if the database is compromised, the tokens are unreadable without the application secret.</p><h3 class="relative group">Layer 3: AWS SAML Federation (Infrastructure Access)<div id=layer-3-aws-saml-federation-infrastructure-access class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#layer-3-aws-saml-federation-infrastructure-access aria-label=Anchor>#</a></span></h3><p>This is the most complex authentication layer. Engineers need access to 100+ AWS accounts, each with multiple roles. Rather than managing individual IAM users, TARS authenticates via the corporate SAML federation chain:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>User credentials -&gt; Corporate ADFS (NTLM) -&gt; SAML assertion
</span></span><span style=display:flex><span>    -&gt; Keycloak (SAML relay + OTP) -&gt; AWS SAML response
</span></span><span style=display:flex><span>    -&gt; STS AssumeRoleWithSAML -&gt; Temporary credentials</span></span></code></pre></div></div><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="TARS AWS Settings" src=/img/tars/settings-aws.png></figure><em>The AWS authentication settings. Users provide corporate credentials and an optional OTP secret for automatic re-authentication.</em></p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff79c6>class</span> <span style=color:#50fa7b>AWSSAMLAuthenticator</span>:
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#34;&#34;&#34;Authenticates to AWS via corporate SAML federation.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>async</span> <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>authenticate</span>(<span style=font-style:italic>self</span>, username, password, otp<span style=color:#ff79c6>=</span><span style=color:#ff79c6>None</span>):
</span></span><span style=display:flex><span>        <span style=color:#6272a4># Step 1: Authenticate against corporate ADFS</span>
</span></span><span style=display:flex><span>        session <span style=color:#ff79c6>=</span> requests<span style=color:#ff79c6>.</span>Session()
</span></span><span style=display:flex><span>        session<span style=color:#ff79c6>.</span>auth <span style=color:#ff79c6>=</span> HttpNtlmAuth(
</span></span><span style=display:flex><span>            <span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;CORP</span><span style=color:#f1fa8c>\\</span><span style=color:#f1fa8c>{</span>username<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>&#34;</span>, password
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        adfs_response <span style=color:#ff79c6>=</span> session<span style=color:#ff79c6>.</span>get(
</span></span><span style=display:flex><span>            ADFS_URL,
</span></span><span style=display:flex><span>            params<span style=color:#ff79c6>=</span>{<span style=color:#f1fa8c>&#34;loginToRp&#34;</span>: KEYCLOAK_ENTITY_ID},
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#6272a4># Step 2: Extract SAML assertion from ADFS response</span>
</span></span><span style=display:flex><span>        saml_assertion <span style=color:#ff79c6>=</span> <span style=font-style:italic>self</span><span style=color:#ff79c6>.</span>_extract_saml(adfs_response<span style=color:#ff79c6>.</span>text)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#6272a4># Step 3: Submit SAML to Keycloak with OTP</span>
</span></span><span style=display:flex><span>        kc_response <span style=color:#ff79c6>=</span> session<span style=color:#ff79c6>.</span>post(
</span></span><span style=display:flex><span>            KEYCLOAK_SAML_ENDPOINT,
</span></span><span style=display:flex><span>            data<span style=color:#ff79c6>=</span>{
</span></span><span style=display:flex><span>                <span style=color:#f1fa8c>&#34;SAMLResponse&#34;</span>: saml_assertion,
</span></span><span style=display:flex><span>                <span style=color:#f1fa8c>&#34;otp&#34;</span>: otp <span style=color:#ff79c6>or</span> pyotp<span style=color:#ff79c6>.</span>TOTP(otp_secret)<span style=color:#ff79c6>.</span>now(),
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#6272a4># Step 4: Extract AWS roles from final SAML response</span>
</span></span><span style=display:flex><span>        aws_saml <span style=color:#ff79c6>=</span> <span style=font-style:italic>self</span><span style=color:#ff79c6>.</span>_extract_aws_saml(kc_response<span style=color:#ff79c6>.</span>text)
</span></span><span style=display:flex><span>        roles <span style=color:#ff79c6>=</span> <span style=font-style:italic>self</span><span style=color:#ff79c6>.</span>_parse_aws_roles(aws_saml)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#6272a4># Step 5: Assume each role via STS</span>
</span></span><span style=display:flex><span>        credentials <span style=color:#ff79c6>=</span> {}
</span></span><span style=display:flex><span>        sts <span style=color:#ff79c6>=</span> boto3<span style=color:#ff79c6>.</span>client(<span style=color:#f1fa8c>&#34;sts&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>for</span> role_arn, provider_arn <span style=color:#ff79c6>in</span> roles:
</span></span><span style=display:flex><span>            creds <span style=color:#ff79c6>=</span> sts<span style=color:#ff79c6>.</span>assume_role_with_saml(
</span></span><span style=display:flex><span>                RoleArn<span style=color:#ff79c6>=</span>role_arn,
</span></span><span style=display:flex><span>                PrincipalArn<span style=color:#ff79c6>=</span>provider_arn,
</span></span><span style=display:flex><span>                SAMLAssertion<span style=color:#ff79c6>=</span>aws_saml,
</span></span><span style=display:flex><span>            )
</span></span><span style=display:flex><span>            credentials[role_arn] <span style=color:#ff79c6>=</span> creds[<span style=color:#f1fa8c>&#34;Credentials&#34;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#6272a4># Cache credentials in Redis with TTL</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>await</span> <span style=font-style:italic>self</span><span style=color:#ff79c6>.</span>_cache_credentials(credentials)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>return</span> {<span style=color:#f1fa8c>&#34;accounts&#34;</span>: <span style=color:#8be9fd;font-style:italic>len</span>(<span style=color:#8be9fd;font-style:italic>set</span>(r<span style=color:#ff79c6>.</span>split(<span style=color:#f1fa8c>&#34;:&#34;</span>)[<span style=color:#bd93f9>4</span>] <span style=color:#ff79c6>for</span> r, _ <span style=color:#ff79c6>in</span> roles)),
</span></span><span style=display:flex><span>                <span style=color:#f1fa8c>&#34;roles&#34;</span>: <span style=color:#8be9fd;font-style:italic>len</span>(roles)}</span></span></code></pre></div></div><p>When the OTP secret is configured, TARS can automatically re-authenticate when credentials expire, making the AWS access seamless. The temporary credentials are cached in Redis with a TTL matching their STS expiration. The agent can then assume different roles on demand to investigate resources across any AWS account.</p><h3 class="relative group">Layer 4: Keycloak (LLM Gateway Access)<div id=layer-4-keycloak-llm-gateway-access class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#layer-4-keycloak-llm-gateway-access aria-label=Anchor>#</a></span></h3><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="TARS Settings - Credentials" src=/img/tars/settings-credentials.png></figure><em>The credentials settings page. Each integration has its own encrypted credential store.</em></p><p>The LLM Gateway that provides access to GPT models requires Keycloak authentication. Users configure their Keycloak credentials, and TARS obtains OAuth2 tokens on their behalf:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff79c6>async</span> <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>get_llm_gateway_token</span>(user_settings):
</span></span><span style=display:flex><span>    token_data <span style=color:#ff79c6>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#f1fa8c>&#34;grant_type&#34;</span>: <span style=color:#f1fa8c>&#34;password&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f1fa8c>&#34;client_id&#34;</span>: LLM_GW_CLIENT_ID,
</span></span><span style=display:flex><span>        <span style=color:#f1fa8c>&#34;username&#34;</span>: user_settings<span style=color:#ff79c6>.</span>keycloak_username,
</span></span><span style=display:flex><span>        <span style=color:#f1fa8c>&#34;password&#34;</span>: user_settings<span style=color:#ff79c6>.</span>keycloak_password,
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>async</span> <span style=color:#ff79c6>with</span> httpx<span style=color:#ff79c6>.</span>AsyncClient() <span style=color:#ff79c6>as</span> client:
</span></span><span style=display:flex><span>        response <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>await</span> client<span style=color:#ff79c6>.</span>post(
</span></span><span style=display:flex><span>            <span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;</span><span style=color:#f1fa8c>{</span>KEYCLOAK_URL<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>/realms/</span><span style=color:#f1fa8c>{</span>REALM<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>/protocol/openid-connect/token&#34;</span>,
</span></span><span style=display:flex><span>            data<span style=color:#ff79c6>=</span>token_data,
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> response<span style=color:#ff79c6>.</span>json()[<span style=color:#f1fa8c>&#34;access_token&#34;</span>]</span></span></code></pre></div></div><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt="TARS Settings - GitLab" src=/img/tars/settings-gitlab.png></figure><em>GitLab configuration. The base URL is configurable because different teams may use different GitLab instances.</em></p><hr><h2 class="relative group">The Agent System<div id=the-agent-system class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#the-agent-system aria-label=Anchor>#</a></span></h2><p>The heart of TARS is the agent, built on the <code>strands-agents</code> framework. Each user request creates a fresh agent instance with the user&rsquo;s credentials injected via Python&rsquo;s <code>contextvars</code>:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff79c6>from</span> strands <span style=color:#ff79c6>import</span> Agent
</span></span><span style=display:flex><span><span style=color:#ff79c6>from</span> strands.models.openai <span style=color:#ff79c6>import</span> OpenAIModel
</span></span><span style=display:flex><span><span style=color:#ff79c6>from</span> strands.tools <span style=color:#ff79c6>import</span> ConcurrentToolExecutor
</span></span><span style=display:flex><span><span style=color:#ff79c6>from</span> strands.conversation <span style=color:#ff79c6>import</span> SlidingWindowConversationManager
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>build_agent</span>(user, user_settings, session_id):
</span></span><span style=display:flex><span>    <span style=color:#6272a4># Configure the LLM</span>
</span></span><span style=display:flex><span>    model <span style=color:#ff79c6>=</span> OpenAIModel(
</span></span><span style=display:flex><span>        model_id<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;gpt-5.1&#34;</span>,
</span></span><span style=display:flex><span>        client_args<span style=color:#ff79c6>=</span>{
</span></span><span style=display:flex><span>            <span style=color:#f1fa8c>&#34;base_url&#34;</span>: LLM_GATEWAY_URL,
</span></span><span style=display:flex><span>            <span style=color:#f1fa8c>&#34;api_key&#34;</span>: get_gateway_token(user_settings),
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        params<span style=color:#ff79c6>=</span>{<span style=color:#f1fa8c>&#34;temperature&#34;</span>: <span style=color:#bd93f9>0.0</span>},
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4># Build tool list based on user&#39;s configured integrations</span>
</span></span><span style=display:flex><span>    tools <span style=color:#ff79c6>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span> user_settings<span style=color:#ff79c6>.</span>gitlab_token:
</span></span><span style=display:flex><span>        tools<span style=color:#ff79c6>.</span>extend(GITLAB_TOOLS)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span> has_aws_credentials(user):
</span></span><span style=display:flex><span>        tools<span style=color:#ff79c6>.</span>extend(AWS_TOOLS)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    tools<span style=color:#ff79c6>.</span>extend(CORE_TOOLS)  <span style=color:#6272a4># think, plan, http, repo_grep</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4># Configure memory</span>
</span></span><span style=display:flex><span>    memory <span style=color:#ff79c6>=</span> SafeAgentCoreMemorySessionManager(
</span></span><span style=display:flex><span>        namespaces<span style=color:#ff79c6>=</span>{
</span></span><span style=display:flex><span>            <span style=color:#f1fa8c>&#34;preferences&#34;</span>: <span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;/preferences/</span><span style=color:#f1fa8c>{</span>user<span style=color:#ff79c6>.</span>id<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f1fa8c>&#34;facts&#34;</span>: <span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;/facts/</span><span style=color:#f1fa8c>{</span>user<span style=color:#ff79c6>.</span>id<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f1fa8c>&#34;summaries&#34;</span>: <span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;/summaries/</span><span style=color:#f1fa8c>{</span>user<span style=color:#ff79c6>.</span>id<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>/</span><span style=color:#f1fa8c>{</span>session_id<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>&#34;</span>,
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> Agent(
</span></span><span style=display:flex><span>        model<span style=color:#ff79c6>=</span>model,
</span></span><span style=display:flex><span>        tools<span style=color:#ff79c6>=</span>tools,
</span></span><span style=display:flex><span>        tool_executor<span style=color:#ff79c6>=</span>ConcurrentToolExecutor(),
</span></span><span style=display:flex><span>        conversation_manager<span style=color:#ff79c6>=</span>SlidingWindowConversationManager(
</span></span><span style=display:flex><span>            window_size<span style=color:#ff79c6>=</span><span style=color:#bd93f9>40</span>,
</span></span><span style=display:flex><span>        ),
</span></span><span style=display:flex><span>        session_manager<span style=color:#ff79c6>=</span>memory,
</span></span><span style=display:flex><span>        system_prompt<span style=color:#ff79c6>=</span>SYSTEM_PROMPT,
</span></span><span style=display:flex><span>    )</span></span></code></pre></div></div><h3 class="relative group">The System Prompt<div id=the-system-prompt class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#the-system-prompt aria-label=Anchor>#</a></span></h3><p>The system prompt is over 8,000 words and establishes the agent&rsquo;s behavioral framework. Some key directives:</p><p><strong>Autonomous investigation, not advice:</strong></p><blockquote><p>&ldquo;You are TARS, a senior SRE debugger and platform analyst. When asked to investigate, you investigate. You don&rsquo;t suggest what the user should check. You check it yourself.&rdquo;</p></blockquote><p><strong>Context-first mandate:</strong></p><blockquote><p>&ldquo;When a service name is mentioned, ALWAYS call gather_context() before any analysis. Never reason about a service without first discovering its actual configuration.&rdquo;</p></blockquote><p><strong>Zero-hallucination enforcement:</strong></p><blockquote><p>&ldquo;Never reference AWS resources, GitLab projects, or configuration details that you have not discovered via tool calls in this conversation. If you haven&rsquo;t checked it, you don&rsquo;t know it.&rdquo;</p></blockquote><p><strong>Multi-signal verification:</strong></p><blockquote><p>&ldquo;Never conclude &rsquo;nothing found&rsquo; or &rsquo;everything looks fine&rsquo; without checking at least two independent signals. If CloudWatch shows no errors, also check ECS events and ALB metrics.&rdquo;</p></blockquote><p><strong>Tool intent transparency:</strong></p><blockquote><p>&ldquo;Before each tool call, emit a single short sentence explaining what you&rsquo;re checking and why. This helps the user follow your investigation.&rdquo;</p></blockquote><p>These constraints transform a general-purpose LLM into a focused investigation agent. The temperature is set to 0.0 because SRE investigation requires determinism, not creativity. You want the agent to follow the same investigation procedures every time.</p><hr><h2 class="relative group">Tool Registry: 30+ Specialized Tools<div id=tool-registry-30-specialized-tools class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#tool-registry-30-specialized-tools aria-label=Anchor>#</a></span></h2><p>TARS has access to over 30 tools, each designed for a specific investigation task. The tools are not generic wrappers. They encode domain knowledge about how to query each system effectively.</p><h3 class="relative group">AWS Tools (Read-Only)<div id=aws-tools-read-only class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#aws-tools-read-only aria-label=Anchor>#</a></span></h3><p>Each AWS service gets its own tool with smart defaults and domain-specific parameter handling:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>@tool
</span></span><span style=display:flex><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>aws_ecs</span>(
</span></span><span style=display:flex><span>    action: <span style=color:#8be9fd;font-style:italic>str</span>,
</span></span><span style=display:flex><span>    parameters: <span style=color:#8be9fd;font-style:italic>dict</span>,
</span></span><span style=display:flex><span>    account_id: <span style=color:#8be9fd;font-style:italic>str</span> <span style=color:#ff79c6>|</span> <span style=color:#ff79c6>None</span> <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>None</span>,
</span></span><span style=display:flex><span>    region: <span style=color:#8be9fd;font-style:italic>str</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;eu-central-1&#34;</span>,
</span></span><span style=display:flex><span>) <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd;font-style:italic>dict</span>:
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#34;&#34;&#34;Query AWS ECS resources.
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    Common actions:
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    - describe_services: Get service details (cluster, serviceName required)
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    - describe_tasks: Get task details (cluster, tasks required)
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    - list_services: List services in a cluster
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    - describe_task_definition: Get task definition details
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    - list_task_definitions: List task definition families
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    The tool automatically:
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    - Resolves the correct AWS account credentials from the SAML cache
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    - Adds &#39;eu-central-1&#39; as default region if not specified
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    - Handles pagination for list operations
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    - Truncates large responses to prevent context overflow
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4># Validate action is read-only</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span> <span style=color:#ff79c6>not</span> action<span style=color:#ff79c6>.</span>startswith((<span style=color:#f1fa8c>&#34;describe_&#34;</span>, <span style=color:#f1fa8c>&#34;list_&#34;</span>, <span style=color:#f1fa8c>&#34;get_&#34;</span>)):
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>return</span> {<span style=color:#f1fa8c>&#34;error&#34;</span>: <span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;Action &#39;</span><span style=color:#f1fa8c>{</span>action<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>&#39; is not allowed (read-only)&#34;</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4># Get cached credentials for the target account</span>
</span></span><span style=display:flex><span>    credentials <span style=color:#ff79c6>=</span> get_cached_aws_credentials(account_id)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    client <span style=color:#ff79c6>=</span> boto3<span style=color:#ff79c6>.</span>client(
</span></span><span style=display:flex><span>        <span style=color:#f1fa8c>&#34;ecs&#34;</span>,
</span></span><span style=display:flex><span>        region_name<span style=color:#ff79c6>=</span>region,
</span></span><span style=display:flex><span>        aws_access_key_id<span style=color:#ff79c6>=</span>credentials[<span style=color:#f1fa8c>&#34;AccessKeyId&#34;</span>],
</span></span><span style=display:flex><span>        aws_secret_access_key<span style=color:#ff79c6>=</span>credentials[<span style=color:#f1fa8c>&#34;SecretAccessKey&#34;</span>],
</span></span><span style=display:flex><span>        aws_session_token<span style=color:#ff79c6>=</span>credentials[<span style=color:#f1fa8c>&#34;SessionToken&#34;</span>],
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    method <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>getattr</span>(client, action)
</span></span><span style=display:flex><span>    response <span style=color:#ff79c6>=</span> method(<span style=color:#ff79c6>**</span>parameters)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> truncate_response(response, max_chars<span style=color:#ff79c6>=</span><span style=color:#bd93f9>12000</span>)</span></span></code></pre></div></div><p>There are specialized tools for ECS, CloudWatch, Lambda, RDS, S3, ElastiCache, ELB, API Gateway, Route53, Step Functions, networking (VPCs, subnets, security groups), and a generic <code>aws</code> tool that can call any AWS service.</p><h3 class="relative group">GitLab Tools<div id=gitlab-tools class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#gitlab-tools aria-label=Anchor>#</a></span></h3><p>GitLab tools go beyond simple API wrappers. The <code>gitlab_search_group</code> tool auto-paginates across results and searches at the group level (not just single repos):</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>@tool
</span></span><span style=display:flex><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>gitlab_search_group</span>(
</span></span><span style=display:flex><span>    group_id: <span style=color:#8be9fd;font-style:italic>int</span>,
</span></span><span style=display:flex><span>    scope: <span style=color:#8be9fd;font-style:italic>str</span>,
</span></span><span style=display:flex><span>    search: <span style=color:#8be9fd;font-style:italic>str</span>,
</span></span><span style=display:flex><span>    max_pages: <span style=color:#8be9fd;font-style:italic>int</span> <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>3</span>,
</span></span><span style=display:flex><span>) <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd;font-style:italic>list</span>[<span style=color:#8be9fd;font-style:italic>dict</span>]:
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#34;&#34;&#34;Search across all repositories in a GitLab group.
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    Scopes: projects, issues, merge_requests, blobs (code), commits, notes
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    Auto-paginates up to max_pages to collect comprehensive results.
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    Useful for finding which repositories contain specific code patterns,
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    configuration references, or AWS account IDs.
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    results <span style=color:#ff79c6>=</span> []
</span></span><span style=display:flex><span>    page <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>while</span> page <span style=color:#ff79c6>&lt;=</span> max_pages:
</span></span><span style=display:flex><span>        response <span style=color:#ff79c6>=</span> gitlab_api(
</span></span><span style=display:flex><span>            <span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;/groups/</span><span style=color:#f1fa8c>{</span>group_id<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>/search&#34;</span>,
</span></span><span style=display:flex><span>            params<span style=color:#ff79c6>=</span>{<span style=color:#f1fa8c>&#34;scope&#34;</span>: scope, <span style=color:#f1fa8c>&#34;search&#34;</span>: search, <span style=color:#f1fa8c>&#34;page&#34;</span>: page, <span style=color:#f1fa8c>&#34;per_page&#34;</span>: <span style=color:#bd93f9>20</span>},
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span> <span style=color:#ff79c6>not</span> response:
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        results<span style=color:#ff79c6>.</span>extend(response)
</span></span><span style=display:flex><span>        page <span style=color:#ff79c6>+=</span> <span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> results</span></span></code></pre></div></div><h3 class="relative group">The repo_grep Tool<div id=the-repo_grep-tool class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#the-repo_grep-tool aria-label=Anchor>#</a></span></h3><p>This is one of the most powerful tools. It clones a repository locally (shallow, sparse, cached) and provides grep, find, tree, and file read operations via subprocess:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>@tool
</span></span><span style=display:flex><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>repo_grep</span>(
</span></span><span style=display:flex><span>    project_id: <span style=color:#8be9fd;font-style:italic>int</span>,
</span></span><span style=display:flex><span>    ref: <span style=color:#8be9fd;font-style:italic>str</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;master&#34;</span>,
</span></span><span style=display:flex><span>    action: <span style=color:#8be9fd;font-style:italic>str</span> <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;grep&#34;</span>,
</span></span><span style=display:flex><span>    pattern: <span style=color:#8be9fd;font-style:italic>str</span> <span style=color:#ff79c6>|</span> <span style=color:#ff79c6>None</span> <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>None</span>,
</span></span><span style=display:flex><span>    path: <span style=color:#8be9fd;font-style:italic>str</span> <span style=color:#ff79c6>|</span> <span style=color:#ff79c6>None</span> <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>None</span>,
</span></span><span style=display:flex><span>) <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd;font-style:italic>str</span>:
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#34;&#34;&#34;Clone a GitLab repo locally and search its contents.
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    Actions:
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    - grep: Search file contents for a pattern (regex supported)
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    - find: Find files matching a name pattern
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    - tree: Show directory structure
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    - read_file: Read a specific file&#39;s contents
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    Repos are cached in /tmp for the session duration.
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    Shallow clones keep disk usage minimal.
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    repo_dir <span style=color:#ff79c6>=</span> clone_or_cache(project_id, ref)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span> action <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#34;grep&#34;</span>:
</span></span><span style=display:flex><span>        result <span style=color:#ff79c6>=</span> subprocess<span style=color:#ff79c6>.</span>run(
</span></span><span style=display:flex><span>            [<span style=color:#f1fa8c>&#34;grep&#34;</span>, <span style=color:#f1fa8c>&#34;-rn&#34;</span>, <span style=color:#f1fa8c>&#34;--include=*.py&#34;</span>, <span style=color:#f1fa8c>&#34;--include=*.tf&#34;</span>,
</span></span><span style=display:flex><span>             <span style=color:#f1fa8c>&#34;--include=*.yml&#34;</span>, <span style=color:#f1fa8c>&#34;--include=*.yaml&#34;</span>, <span style=color:#f1fa8c>&#34;--include=*.json&#34;</span>,
</span></span><span style=display:flex><span>             pattern, repo_dir],
</span></span><span style=display:flex><span>            capture_output<span style=color:#ff79c6>=</span><span style=color:#ff79c6>True</span>, text<span style=color:#ff79c6>=</span><span style=color:#ff79c6>True</span>, timeout<span style=color:#ff79c6>=</span><span style=color:#bd93f9>30</span>,
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>return</span> truncate(result<span style=color:#ff79c6>.</span>stdout, <span style=color:#bd93f9>12000</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4># ... other actions</span></span></span></code></pre></div></div><p>This allows the agent to do deep code analysis that isn&rsquo;t possible through GitLab&rsquo;s search API alone. It can trace function call chains, read configuration files, check Terraform variables, and find secrets that shouldn&rsquo;t be committed.</p><hr><h2 class="relative group">Sub-Agent Architecture<div id=sub-agent-architecture class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#sub-agent-architecture aria-label=Anchor>#</a></span></h2><p>Complex investigations often require parallel work streams. TARS uses a sub-agent pattern where the main agent can spawn autonomous child agents that run to completion with their own tool sets:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>@tool
</span></span><span style=display:flex><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>gather_context</span>(service_name: <span style=color:#8be9fd;font-style:italic>str</span>) <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd;font-style:italic>dict</span>:
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#34;&#34;&#34;Autonomously discover everything about a service.
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    This sub-agent:
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    1. Searches GitLab for the service repository
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    2. Reads the repo structure (Dockerfile, terraform/, .gitlab-ci.yml)
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    3. Extracts AWS account, region, and cluster information
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    4. Returns a structured context object
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    Always call this before investigating any service.
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    sub_agent <span style=color:#ff79c6>=</span> Agent(
</span></span><span style=display:flex><span>        model<span style=color:#ff79c6>=</span>model,
</span></span><span style=display:flex><span>        tools<span style=color:#ff79c6>=</span>[gitlab, gitlab_get_file, gitlab_list_tree, gitlab_search_group],
</span></span><span style=display:flex><span>        system_prompt<span style=color:#ff79c6>=</span>GATHER_CONTEXT_PROMPT,
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    result <span style=color:#ff79c6>=</span> sub_agent(
</span></span><span style=display:flex><span>        <span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;Find and analyze the service &#39;</span><span style=color:#f1fa8c>{</span>service_name<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>&#39;. &#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;Return the GitLab project ID, AWS account, region, &#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;cluster name, and key configuration details.&#34;</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> parse_context(result)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>@tool
</span></span><span style=display:flex><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>investigate_infrastructure</span>(context: <span style=color:#8be9fd;font-style:italic>dict</span>, symptoms: <span style=color:#8be9fd;font-style:italic>str</span>) <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd;font-style:italic>dict</span>:
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#34;&#34;&#34;Autonomously investigate AWS infrastructure for issues.
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    Uses the context from gather_context() to check:
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    - ECS service health, deployment status, task failures
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    - ALB target health, request metrics, error rates
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    - CloudWatch logs for error patterns
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    - Recent configuration changes
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    sub_agent <span style=color:#ff79c6>=</span> Agent(
</span></span><span style=display:flex><span>        model<span style=color:#ff79c6>=</span>model,
</span></span><span style=display:flex><span>        tools<span style=color:#ff79c6>=</span>[aws_ecs, aws_cloudwatch, aws_elb, aws_networking],
</span></span><span style=display:flex><span>        system_prompt<span style=color:#ff79c6>=</span>INVESTIGATE_INFRA_PROMPT,
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> sub_agent(
</span></span><span style=display:flex><span>        <span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;Context: </span><span style=color:#f1fa8c>{</span>json<span style=color:#ff79c6>.</span>dumps(context)<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;Symptoms: </span><span style=color:#f1fa8c>{</span>symptoms<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;Investigate the infrastructure and report findings.&#34;</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>@tool
</span></span><span style=display:flex><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>investigate_code</span>(context: <span style=color:#8be9fd;font-style:italic>dict</span>, hypothesis: <span style=color:#8be9fd;font-style:italic>str</span>) <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd;font-style:italic>dict</span>:
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#34;&#34;&#34;Autonomously investigate code for issues.
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    Traces code paths, reads recent changes, checks for
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    common patterns that could cause the reported symptoms.
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    sub_agent <span style=color:#ff79c6>=</span> Agent(
</span></span><span style=display:flex><span>        model<span style=color:#ff79c6>=</span>model,
</span></span><span style=display:flex><span>        tools<span style=color:#ff79c6>=</span>[gitlab_get_file, gitlab_list_tree, repo_grep, gitlab_search_group],
</span></span><span style=display:flex><span>        system_prompt<span style=color:#ff79c6>=</span>INVESTIGATE_CODE_PROMPT,
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> sub_agent(
</span></span><span style=display:flex><span>        <span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;Context: </span><span style=color:#f1fa8c>{</span>json<span style=color:#ff79c6>.</span>dumps(context)<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;Hypothesis: </span><span style=color:#f1fa8c>{</span>hypothesis<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;Investigate the code and report findings.&#34;</span>
</span></span><span style=display:flex><span>    )</span></span></code></pre></div></div><p>Sub-agent progress is forwarded to the main response stream via a shared <code>asyncio.Queue</code>. The frontend renders sub-agent tool calls as nested activity items, so the user can see exactly what each sub-agent is doing in real time.</p><hr><h2 class="relative group">Security Model<div id=security-model class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#security-model aria-label=Anchor>#</a></span></h2><p>An AI agent with access to 100+ AWS accounts and every GitLab repository needs serious guardrails. TARS implements security at three levels:</p><h3 class="relative group">Level 1: Tool Policy Classification<div id=level-1-tool-policy-classification class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#level-1-tool-policy-classification aria-label=Anchor>#</a></span></h3><p>Every tool call is classified before execution:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff79c6>class</span> <span style=color:#50fa7b>ToolPolicy</span>:
</span></span><span style=display:flex><span>    SAFE <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;safe&#34;</span>       <span style=color:#6272a4># Read-only operations</span>
</span></span><span style=display:flex><span>    ELEVATED <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;elevated&#34;</span>  <span style=color:#6272a4># Write operations (require confirmation)</span>
</span></span><span style=display:flex><span>    BLOCKED <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;blocked&#34;</span>    <span style=color:#6272a4># Destructive operations (never allowed)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>classify</span>(<span style=font-style:italic>self</span>, tool_name, parameters):
</span></span><span style=display:flex><span>        <span style=color:#6272a4># All AWS write operations are blocked</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span> tool_name<span style=color:#ff79c6>.</span>startswith(<span style=color:#f1fa8c>&#34;aws_&#34;</span>):
</span></span><span style=display:flex><span>            action <span style=color:#ff79c6>=</span> parameters<span style=color:#ff79c6>.</span>get(<span style=color:#f1fa8c>&#34;action&#34;</span>, <span style=color:#f1fa8c>&#34;&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>if</span> action<span style=color:#ff79c6>.</span>startswith((<span style=color:#f1fa8c>&#34;create_&#34;</span>, <span style=color:#f1fa8c>&#34;delete_&#34;</span>, <span style=color:#f1fa8c>&#34;update_&#34;</span>, <span style=color:#f1fa8c>&#34;put_&#34;</span>,
</span></span><span style=display:flex><span>                                  <span style=color:#f1fa8c>&#34;modify_&#34;</span>, <span style=color:#f1fa8c>&#34;remove_&#34;</span>, <span style=color:#f1fa8c>&#34;terminate_&#34;</span>)):
</span></span><span style=display:flex><span>                <span style=color:#ff79c6>return</span> <span style=font-style:italic>self</span><span style=color:#ff79c6>.</span>BLOCKED
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#6272a4># GitLab writes are elevated (branch-safe only)</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span> tool_name <span style=color:#ff79c6>in</span> (<span style=color:#f1fa8c>&#34;gitlab_commit_file&#34;</span>, <span style=color:#f1fa8c>&#34;gitlab_create_branch&#34;</span>,
</span></span><span style=display:flex><span>                         <span style=color:#f1fa8c>&#34;gitlab_create_merge_request&#34;</span>):
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>return</span> <span style=font-style:italic>self</span><span style=color:#ff79c6>.</span>ELEVATED
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#6272a4># GitLab generic tool blocks non-GET methods</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span> tool_name <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#34;gitlab&#34;</span>:
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>if</span> parameters<span style=color:#ff79c6>.</span>get(<span style=color:#f1fa8c>&#34;method&#34;</span>, <span style=color:#f1fa8c>&#34;GET&#34;</span>) <span style=color:#ff79c6>!=</span> <span style=color:#f1fa8c>&#34;GET&#34;</span>:
</span></span><span style=display:flex><span>                <span style=color:#ff79c6>return</span> <span style=font-style:italic>self</span><span style=color:#ff79c6>.</span>BLOCKED
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>return</span> <span style=font-style:italic>self</span><span style=color:#ff79c6>.</span>SAFE</span></span></code></pre></div></div><h3 class="relative group">Level 2: Branch Protection<div id=level-2-branch-protection class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#level-2-branch-protection aria-label=Anchor>#</a></span></h3><p>GitLab write tools enforce branch safety:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>@tool
</span></span><span style=display:flex><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>gitlab_commit_file</span>(project_id, branch, file_path, content, commit_message):
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#34;&#34;&#34;Commit a file to a GitLab repository.
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    SAFETY: Commits to main/master are rejected.
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    Only feature branches are allowed.
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span> branch<span style=color:#ff79c6>.</span>lower() <span style=color:#ff79c6>in</span> (<span style=color:#f1fa8c>&#34;main&#34;</span>, <span style=color:#f1fa8c>&#34;master&#34;</span>, <span style=color:#f1fa8c>&#34;release&#34;</span>, <span style=color:#f1fa8c>&#34;pre-release&#34;</span>):
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>return</span> {<span style=color:#f1fa8c>&#34;error&#34;</span>: <span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;Direct commits to &#39;</span><span style=color:#f1fa8c>{</span>branch<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>&#39; are blocked. &#34;</span>
</span></span><span style=display:flex><span>                         <span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;Create a feature branch first.&#34;</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4># ... proceed with commit</span></span></span></code></pre></div></div><h3 class="relative group">Level 3: Network Safety<div id=level-3-network-safety class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#level-3-network-safety aria-label=Anchor>#</a></span></h3><p>The HTTP tool includes SSRF protection:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>validate_url</span>(url):
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#34;&#34;&#34;Prevent SSRF by blocking requests to private IP ranges.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    parsed <span style=color:#ff79c6>=</span> urlparse(url)
</span></span><span style=display:flex><span>    ip <span style=color:#ff79c6>=</span> socket<span style=color:#ff79c6>.</span>gethostbyname(parsed<span style=color:#ff79c6>.</span>hostname)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    private_ranges <span style=color:#ff79c6>=</span> [
</span></span><span style=display:flex><span>        ipaddress<span style=color:#ff79c6>.</span>ip_network(<span style=color:#f1fa8c>&#34;10.0.0.0/8&#34;</span>),
</span></span><span style=display:flex><span>        ipaddress<span style=color:#ff79c6>.</span>ip_network(<span style=color:#f1fa8c>&#34;172.16.0.0/12&#34;</span>),
</span></span><span style=display:flex><span>        ipaddress<span style=color:#ff79c6>.</span>ip_network(<span style=color:#f1fa8c>&#34;192.168.0.0/16&#34;</span>),
</span></span><span style=display:flex><span>        ipaddress<span style=color:#ff79c6>.</span>ip_network(<span style=color:#f1fa8c>&#34;169.254.0.0/16&#34;</span>),
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    addr <span style=color:#ff79c6>=</span> ipaddress<span style=color:#ff79c6>.</span>ip_address(ip)
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>for</span> network <span style=color:#ff79c6>in</span> private_ranges:
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span> addr <span style=color:#ff79c6>in</span> network:
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>raise</span> SecurityError(<span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;Requests to private IP </span><span style=color:#f1fa8c>{</span>ip<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c> are blocked&#34;</span>)</span></span></code></pre></div></div><h3 class="relative group">Level 4: Output Sanitization<div id=level-4-output-sanitization class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#level-4-output-sanitization aria-label=Anchor>#</a></span></h3><p>Tool output is truncated to 12,000 characters to prevent context overflow attacks where a malicious response could fill the context window with adversarial content. Secret values detected in tool output are redacted before being shown to the user.</p><hr><h2 class="relative group">Streaming Infrastructure<div id=streaming-infrastructure class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#streaming-infrastructure aria-label=Anchor>#</a></span></h2><p>Real-time streaming is essential for an investigation agent. Investigations can take 30-60 seconds as the agent makes multiple tool calls. Without streaming, the user would stare at a loading spinner with no visibility into what&rsquo;s happening.</p><p>TARS uses Server-Sent Events (SSE) with Django&rsquo;s async <code>StreamingHttpResponse</code>:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff79c6>class</span> <span style=color:#50fa7b>ChatStreamView</span>(APIView):
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>async</span> <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>post</span>(<span style=font-style:italic>self</span>, request):
</span></span><span style=display:flex><span>        message <span style=color:#ff79c6>=</span> request<span style=color:#ff79c6>.</span>data[<span style=color:#f1fa8c>&#34;message&#34;</span>]
</span></span><span style=display:flex><span>        session_id <span style=color:#ff79c6>=</span> request<span style=color:#ff79c6>.</span>data<span style=color:#ff79c6>.</span>get(<span style=color:#f1fa8c>&#34;session_id&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        agent <span style=color:#ff79c6>=</span> build_agent(request<span style=color:#ff79c6>.</span>user, request<span style=color:#ff79c6>.</span>user_settings, session_id)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>async</span> <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>event_stream</span>():
</span></span><span style=display:flex><span>            queue <span style=color:#ff79c6>=</span> asyncio<span style=color:#ff79c6>.</span>Queue()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#6272a4># Run agent in background task</span>
</span></span><span style=display:flex><span>            task <span style=color:#ff79c6>=</span> asyncio<span style=color:#ff79c6>.</span>create_task(
</span></span><span style=display:flex><span>                run_agent(agent, message, queue)
</span></span><span style=display:flex><span>            )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>while</span> <span style=color:#ff79c6>True</span>:
</span></span><span style=display:flex><span>                event <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>await</span> queue<span style=color:#ff79c6>.</span>get()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#ff79c6>if</span> event[<span style=color:#f1fa8c>&#34;type&#34;</span>] <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#34;done&#34;</span>:
</span></span><span style=display:flex><span>                    <span style=color:#ff79c6>yield</span> format_sse(event)
</span></span><span style=display:flex><span>                    <span style=color:#ff79c6>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#ff79c6>if</span> event[<span style=color:#f1fa8c>&#34;type&#34;</span>] <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#34;text_delta&#34;</span>:
</span></span><span style=display:flex><span>                    <span style=color:#ff79c6>yield</span> format_sse(event)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#ff79c6>if</span> event[<span style=color:#f1fa8c>&#34;type&#34;</span>] <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#34;tool_start&#34;</span>:
</span></span><span style=display:flex><span>                    <span style=color:#ff79c6>yield</span> format_sse({
</span></span><span style=display:flex><span>                        <span style=color:#f1fa8c>&#34;type&#34;</span>: <span style=color:#f1fa8c>&#34;tool_start&#34;</span>,
</span></span><span style=display:flex><span>                        <span style=color:#f1fa8c>&#34;tool&#34;</span>: event[<span style=color:#f1fa8c>&#34;tool_name&#34;</span>],
</span></span><span style=display:flex><span>                        <span style=color:#f1fa8c>&#34;input&#34;</span>: event[<span style=color:#f1fa8c>&#34;input_params&#34;</span>],
</span></span><span style=display:flex><span>                    })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#ff79c6>if</span> event[<span style=color:#f1fa8c>&#34;type&#34;</span>] <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#34;tool_end&#34;</span>:
</span></span><span style=display:flex><span>                    <span style=color:#ff79c6>yield</span> format_sse({
</span></span><span style=display:flex><span>                        <span style=color:#f1fa8c>&#34;type&#34;</span>: <span style=color:#f1fa8c>&#34;tool_end&#34;</span>,
</span></span><span style=display:flex><span>                        <span style=color:#f1fa8c>&#34;tool&#34;</span>: event[<span style=color:#f1fa8c>&#34;tool_name&#34;</span>],
</span></span><span style=display:flex><span>                        <span style=color:#f1fa8c>&#34;output&#34;</span>: truncate(event[<span style=color:#f1fa8c>&#34;output&#34;</span>], <span style=color:#bd93f9>500</span>),
</span></span><span style=display:flex><span>                    })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#ff79c6>if</span> event[<span style=color:#f1fa8c>&#34;type&#34;</span>] <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#34;reasoning&#34;</span>:
</span></span><span style=display:flex><span>                    <span style=color:#ff79c6>yield</span> format_sse({
</span></span><span style=display:flex><span>                        <span style=color:#f1fa8c>&#34;type&#34;</span>: <span style=color:#f1fa8c>&#34;reasoning&#34;</span>,
</span></span><span style=display:flex><span>                        <span style=color:#f1fa8c>&#34;text&#34;</span>: event[<span style=color:#f1fa8c>&#34;text&#34;</span>],
</span></span><span style=display:flex><span>                    })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>await</span> task
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        response <span style=color:#ff79c6>=</span> StreamingHttpResponse(
</span></span><span style=display:flex><span>            event_stream(),
</span></span><span style=display:flex><span>            content_type<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;text/event-stream&#34;</span>,
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>        response[<span style=color:#f1fa8c>&#34;Cache-Control&#34;</span>] <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;no-cache&#34;</span>
</span></span><span style=display:flex><span>        response[<span style=color:#f1fa8c>&#34;X-Accel-Buffering&#34;</span>] <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;no&#34;</span>  <span style=color:#6272a4># Disable Nginx buffering</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>return</span> response
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>format_sse</span>(data):
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> <span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#34;data: </span><span style=color:#f1fa8c>{</span>json<span style=color:#ff79c6>.</span>dumps(data)<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>\n\n</span><span style=color:#f1fa8c>&#34;</span></span></span></code></pre></div></div><p>The <code>X-Accel-Buffering: no</code> header is critical. Without it, Nginx buffers the SSE stream and delivers it in chunks, destroying the real-time experience. The ALB is configured with sticky sessions (1-hour cookie) to ensure SSE connections aren&rsquo;t load-balanced mid-stream.</p><hr><h2 class="relative group">The Frontend<div id=the-frontend class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#the-frontend aria-label=Anchor>#</a></span></h2><p>The frontend is built with React 19 and follows a feature-based architecture:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>src/
</span></span><span style=display:flex><span>  features/
</span></span><span style=display:flex><span>    auth/       # OAuth2 PKCE, session management
</span></span><span style=display:flex><span>    chat/       # Chat UI, SSE streaming, sessions
</span></span><span style=display:flex><span>    kpi/        # Developer productivity dashboard
</span></span><span style=display:flex><span>    memory/     # Agent memory viewer/manager
</span></span><span style=display:flex><span>    admin/      # User management, system settings
</span></span><span style=display:flex><span>    common/     # Layout, sidebar, shared components</span></span></code></pre></div></div><h3 class="relative group">The useChat Hook<div id=the-usechat-hook class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#the-usechat-hook aria-label=Anchor>#</a></span></h3><p>The core of the chat feature is a custom React hook that manages the SSE connection, parses streaming events, and tracks tool invocations including nested sub-agent calls:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>function</span> useChat() {
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>const</span> [messages, setMessages] <span style=color:#ff79c6>=</span> useState&lt;<span style=color:#ff79c6>Message</span>[]&gt;([]);
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>const</span> [isStreaming, setIsStreaming] <span style=color:#ff79c6>=</span> useState(<span style=color:#ff79c6>false</span>);
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>const</span> [activeTools, setActiveTools] <span style=color:#ff79c6>=</span> useState&lt;<span style=color:#ff79c6>ToolCall</span>[]&gt;([]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>const</span> sendMessage <span style=color:#ff79c6>=</span> useCallback(<span style=color:#ff79c6>async</span> (content: <span style=color:#8be9fd>string</span>) <span style=color:#ff79c6>=&gt;</span> {
</span></span><span style=display:flex><span>    setIsStreaming(<span style=color:#ff79c6>true</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>const</span> response <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>await</span> fetch(<span style=color:#f1fa8c>&#34;/api/chat/stream&#34;</span>, {
</span></span><span style=display:flex><span>      method<span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;POST&#34;</span>,
</span></span><span style=display:flex><span>      headers<span style=color:#ff79c6>:</span> { <span style=color:#f1fa8c>&#34;Content-Type&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;application/json&#34;</span> },
</span></span><span style=display:flex><span>      body: <span style=color:#8be9fd>JSON.stringify</span>({ message: <span style=color:#8be9fd>content</span>, session_id: <span style=color:#8be9fd>sessionId</span> }),
</span></span><span style=display:flex><span>      credentials<span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;include&#34;</span>,
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>const</span> reader <span style=color:#ff79c6>=</span> response.body<span style=color:#ff79c6>!</span>.getReader();
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>const</span> decoder <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> TextDecoder();
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>let</span> buffer <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>while</span> (<span style=color:#ff79c6>true</span>) {
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>const</span> { done, value } <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>await</span> reader.read();
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>if</span> (done) <span style=color:#ff79c6>break</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      buffer <span style=color:#ff79c6>+=</span> decoder.decode(value, { stream: <span style=color:#8be9fd>true</span> });
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>const</span> lines <span style=color:#ff79c6>=</span> buffer.split(<span style=color:#f1fa8c>&#34;\n\n&#34;</span>);
</span></span><span style=display:flex><span>      buffer <span style=color:#ff79c6>=</span> lines.pop() <span style=color:#ff79c6>||</span> <span style=color:#f1fa8c>&#34;&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>for</span> (<span style=color:#ff79c6>const</span> line <span style=color:#ff79c6>of</span> lines) {
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span> (<span style=color:#ff79c6>!</span>line.startsWith(<span style=color:#f1fa8c>&#34;data: &#34;</span>)) <span style=color:#ff79c6>continue</span>;
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>const</span> event <span style=color:#ff79c6>=</span> JSON.parse(line.slice(<span style=color:#bd93f9>6</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>switch</span> (event.<span style=color:#ff79c6>type</span>) {
</span></span><span style=display:flex><span>          <span style=color:#ff79c6>case</span> <span style=color:#f1fa8c>&#34;text_delta&#34;</span><span style=color:#ff79c6>:</span>
</span></span><span style=display:flex><span>            appendToCurrentMessage(event.text);
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>break</span>;
</span></span><span style=display:flex><span>          <span style=color:#ff79c6>case</span> <span style=color:#f1fa8c>&#34;tool_start&#34;</span><span style=color:#ff79c6>:</span>
</span></span><span style=display:flex><span>            addActiveToolCall(event);
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>break</span>;
</span></span><span style=display:flex><span>          <span style=color:#ff79c6>case</span> <span style=color:#f1fa8c>&#34;tool_end&#34;</span><span style=color:#ff79c6>:</span>
</span></span><span style=display:flex><span>            resolveToolCall(event);
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>break</span>;
</span></span><span style=display:flex><span>          <span style=color:#ff79c6>case</span> <span style=color:#f1fa8c>&#34;reasoning&#34;</span><span style=color:#ff79c6>:</span>
</span></span><span style=display:flex><span>            setReasoningText(event.text);
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>break</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    setIsStreaming(<span style=color:#ff79c6>false</span>);
</span></span><span style=display:flex><span>  }, [sessionId]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>return</span> { messages, sendMessage, isStreaming, activeTools };
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div><h3 class="relative group">Design Language<div id=design-language class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#design-language aria-label=Anchor>#</a></span></h3><p>The UI uses a dark theme with glass morphism effects, consistent with modern developer tools:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>.<span style=color:#50fa7b>glass</span> {
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>background</span>: <span style=color:#8be9fd;font-style:italic>rgba</span>(<span style=color:#bd93f9>255</span>, <span style=color:#bd93f9>255</span>, <span style=color:#bd93f9>255</span>, <span style=color:#bd93f9>0.05</span>);
</span></span><span style=display:flex><span>  backdrop-filter: <span style=color:#8be9fd;font-style:italic>blur</span>(<span style=color:#bd93f9>12</span><span style=color:#8be9fd>px</span>);
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>border</span>: <span style=color:#bd93f9>1</span><span style=color:#8be9fd>px</span> <span style=color:#ff79c6>solid</span> <span style=color:#8be9fd;font-style:italic>rgba</span>(<span style=color:#bd93f9>255</span>, <span style=color:#bd93f9>255</span>, <span style=color:#bd93f9>255</span>, <span style=color:#bd93f9>0.1</span>);
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div><p>The deep purple/navy gradient background, subtle transparency, and smooth Framer Motion transitions create a polished, professional interface that engineers enjoy using. The login screen (shown at the top of this article) sets the tone immediately.</p><h3 class="relative group">Activity Sidebar<div id=activity-sidebar class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#activity-sidebar aria-label=Anchor>#</a></span></h3><p>During streaming, an activity sidebar shows every tool invocation in real time:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>&gt; Gathering context for &#34;payment-service&#34;...
</span></span><span style=display:flex><span>  &gt; gitlab_search_group: searching for payment-service
</span></span><span style=display:flex><span>  &gt; gitlab_list_tree: reading repository structure
</span></span><span style=display:flex><span>  &gt; gitlab_get_file: reading terraform/locals.tf
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&gt; Investigating infrastructure...
</span></span><span style=display:flex><span>  &gt; aws_ecs: describe_services on cluster payments-qual
</span></span><span style=display:flex><span>  &gt; aws_cloudwatch: get_log_events for /ecs/payment-service
</span></span><span style=display:flex><span>  &gt; aws_elb: describe_target_health for payment-tg</span></span></code></pre></div></div><p>Sub-agent tool calls are nested under their parent, making the investigation flow transparent to the user.</p><hr><h2 class="relative group">KPI Dashboard<div id=kpi-dashboard class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#kpi-dashboard aria-label=Anchor>#</a></span></h2><p>Beyond SRE investigation, TARS includes a developer productivity dashboard that computes metrics from GitLab data:</p><ul><li><strong>Commit frequency</strong> by day/week/month</li><li><strong>Code volume</strong> (lines added/removed)</li><li><strong>MR activity</strong> (opened, merged, review time)</li><li><strong>Review metrics</strong> (comments given/received)</li><li><strong>Repository engagement</strong> (contribution distribution)</li></ul><p>The caching strategy is multi-layered to minimize GitLab API calls:</p><ol><li><strong>Raw GitLab data</strong>: 15-minute Redis cache</li><li><strong>Computed dashboard metrics</strong>: 1-hour Redis cache</li><li><strong>PostgreSQL snapshots</strong>: 4-hour persistent cache</li></ol><p>Data is fetched in fixed time buckets (15, 31, 91 days) regardless of what the user requests. If a user asks for &ldquo;last 7 days&rdquo; of data, the system fetches the 15-day bucket and filters client-side. This maximizes cache hit rates because different users requesting different time ranges all hit the same cached bucket.</p><hr><h2 class="relative group">Memory and Context Management<div id=memory-and-context-management class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#memory-and-context-management aria-label=Anchor>#</a></span></h2><p>TARS uses AWS Bedrock AgentCore for persistent memory across sessions. Three memory strategies are active:</p><ol><li><strong>User Preferences</strong>: How the user likes responses formatted, which accounts they frequently investigate, preferred output verbosity</li><li><strong>Semantic Facts</strong>: Discovered facts about the infrastructure (e.g., &ldquo;payment-service runs on cluster X in account Y&rdquo;)</li><li><strong>Session Summaries</strong>: Compressed summaries of past conversations for continuity</li></ol><p>The conversation manager uses a sliding window of 40 messages. When the window fills, older messages are summarized and stored in the summaries namespace. This means the agent can reference context from days-old conversations without consuming the full context window.</p><p>Users can view and manage their memory records through a dedicated Memory page, with ownership verification preventing cross-user data access.</p><hr><h2 class="relative group">Database Design<div id=database-design class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#database-design aria-label=Anchor>#</a></span></h2><p>The schema is intentionally minimal:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>User (UUID pk)
</span></span><span style=display:flex><span>  ├── entra_id (unique, Entra ID SSO link)
</span></span><span style=display:flex><span>  ├── display_name
</span></span><span style=display:flex><span>  └── role (user/admin)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>UserSettings (one-to-one with User)
</span></span><span style=display:flex><span>  ├── keycloak_username / keycloak_password (encrypted)
</span></span><span style=display:flex><span>  ├── gitlab_token (encrypted) / gitlab_base_url
</span></span><span style=display:flex><span>  ├── corpgen_username / corpgen_password (encrypted)
</span></span><span style=display:flex><span>  └── aws_otp_secret (encrypted)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>UserSession (token pk)
</span></span><span style=display:flex><span>  ├── user (FK)
</span></span><span style=display:flex><span>  └── expires_at (sliding window)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ChatSession
</span></span><span style=display:flex><span>  ├── user (FK)
</span></span><span style=display:flex><span>  ├── title (auto-generated)
</span></span><span style=display:flex><span>  └── output_mode (brief/standard/detailed)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Message
</span></span><span style=display:flex><span>  ├── session (FK)
</span></span><span style=display:flex><span>  ├── role (user/assistant/system)
</span></span><span style=display:flex><span>  ├── content (text)
</span></span><span style=display:flex><span>  └── metrics (JSON: duration, tokens)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ToolInvocation
</span></span><span style=display:flex><span>  ├── message (FK)
</span></span><span style=display:flex><span>  ├── tool_name, input_params, output, status
</span></span><span style=display:flex><span>  └── timing (started_at, completed_at)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ChatShare
</span></span><span style=display:flex><span>  ├── session (FK)
</span></span><span style=display:flex><span>  ├── token (unique, time-limited)
</span></span><span style=display:flex><span>  └── message_count_snapshot
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DeveloperKPISnapshot
</span></span><span style=display:flex><span>  ├── user (FK)
</span></span><span style=display:flex><span>  ├── period, granularity
</span></span><span style=display:flex><span>  ├── metrics (JSON)
</span></span><span style=display:flex><span>  └── expires_at (4-hour TTL)</span></span></code></pre></div></div><p>All sensitive fields use <code>EncryptedCharField</code>. KPI snapshots auto-expire after 4 hours. Chat shares have a 30-day TTL.</p><hr><h2 class="relative group">Deployment<div id=deployment class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#deployment aria-label=Anchor>#</a></span></h2><p>TARS deploys to ECS Fargate with Terraform:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#ff79c6>resource</span> <span style=color:#f1fa8c>&#34;aws_ecs_service&#34; &#34;tars&#34;</span> {
</span></span><span style=display:flex><span>  name            <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;tars&#34;</span>
</span></span><span style=display:flex><span>  cluster         <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>aws_ecs_cluster</span>.<span style=color:#ff79c6>tars</span>.<span style=color:#ff79c6>id</span>
</span></span><span style=display:flex><span>  task_definition <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>aws_ecs_task_definition</span>.<span style=color:#ff79c6>tars</span>.<span style=color:#ff79c6>arn</span>
</span></span><span style=display:flex><span>  desired_count   <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>capacity_provider_strategy</span> {
</span></span><span style=display:flex><span>    capacity_provider <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;FARGATE_SPOT&#34;</span>
</span></span><span style=display:flex><span>    weight            <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>100</span>
</span></span><span style=display:flex><span>    base              <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>capacity_provider_strategy</span> {
</span></span><span style=display:flex><span>    capacity_provider <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;FARGATE&#34;</span>
</span></span><span style=display:flex><span>    weight            <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>deployment_circuit_breaker</span> {
</span></span><span style=display:flex><span>    enable   <span style=color:#ff79c6>=</span> <span style=color:#8be9fd>true</span>
</span></span><span style=display:flex><span>    rollback <span style=color:#ff79c6>=</span> <span style=color:#8be9fd>true</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>resource</span> <span style=color:#f1fa8c>&#34;aws_ecs_task_definition&#34; &#34;tars&#34;</span> {
</span></span><span style=display:flex><span>  family                   <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;tars&#34;</span>
</span></span><span style=display:flex><span>  requires_compatibilities <span style=color:#ff79c6>=</span> [<span style=color:#f1fa8c>&#34;FARGATE&#34;</span>]
</span></span><span style=display:flex><span>  network_mode             <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;awsvpc&#34;</span>
</span></span><span style=display:flex><span>  cpu                      <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1024</span><span style=color:#6272a4>   # 1 vCPU
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>  memory                   <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>2048</span><span style=color:#6272a4>   # 2 GB
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>runtime_platform</span> {
</span></span><span style=display:flex><span>    operating_system_family <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;LINUX&#34;</span>
</span></span><span style=display:flex><span>    cpu_architecture        <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;ARM64&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  container_definitions <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>jsonencode</span>([{
</span></span><span style=display:flex><span>    name  <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;tars&#34;</span>
</span></span><span style=display:flex><span>    image <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;${aws_ecr_repository.tars.repository_url}:latest&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    portMappings <span style=color:#ff79c6>=</span> [{
</span></span><span style=display:flex><span>      containerPort <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>8080</span>
</span></span><span style=display:flex><span>      protocol      <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;tcp&#34;</span>
</span></span><span style=display:flex><span>    }]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    secrets <span style=color:#ff79c6>=</span> [
</span></span><span style=display:flex><span>      { name <span style=color:#ff79c6>=</span> &#34;DJANGO_SECRET_KEY&#34;, valueFrom <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>aws_secretsmanager_secret</span>.<span style=color:#ff79c6>django</span>.<span style=color:#ff79c6>arn</span> },
</span></span><span style=display:flex><span>      { name <span style=color:#ff79c6>=</span> &#34;DATABASE_URL&#34;, valueFrom <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>aws_secretsmanager_secret</span>.<span style=color:#ff79c6>db</span>.<span style=color:#ff79c6>arn</span> },
</span></span><span style=display:flex><span>      { name <span style=color:#ff79c6>=</span> &#34;REDIS_URL&#34;, valueFrom <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>aws_secretsmanager_secret</span>.<span style=color:#ff79c6>redis</span>.<span style=color:#ff79c6>arn</span> },<span style=color:#6272a4>
</span></span></span><span style=display:flex><span><span style=color:#6272a4>      # ... more secrets
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    ]
</span></span><span style=display:flex><span>  }])
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div><p>The multi-stage Dockerfile keeps the image small:</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-dockerfile data-lang=dockerfile><span style=display:flex><span><span style=color:#6272a4># Stage 1: Build frontend</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>FROM</span><span style=color:#f1fa8c> node:20-alpine AS frontend</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>WORKDIR</span><span style=color:#f1fa8c> /app/frontend</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>COPY</span> frontend/package*.json ./
</span></span><span style=display:flex><span><span style=color:#ff79c6>RUN</span> npm ci
</span></span><span style=display:flex><span><span style=color:#ff79c6>COPY</span> frontend/ ./
</span></span><span style=display:flex><span><span style=color:#ff79c6>RUN</span> npm run build
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Stage 2: Production</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>FROM</span><span style=color:#f1fa8c> python:3.13-slim</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>WORKDIR</span><span style=color:#f1fa8c> /app</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Install Python dependencies</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>COPY</span> backend/requirements.txt ./
</span></span><span style=display:flex><span><span style=color:#ff79c6>RUN</span> pip install --no-cache-dir -r requirements.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Copy backend</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>COPY</span> backend/ ./
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Copy built frontend + Nginx config</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>COPY</span> --from<span style=color:#ff79c6>=</span>frontend /app/frontend/dist /app/static/frontend
</span></span><span style=display:flex><span><span style=color:#ff79c6>COPY</span> nginx.conf /etc/nginx/nginx.conf
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># Nginx serves static + proxies to Uvicorn</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>EXPOSE</span><span style=color:#f1fa8c> 8080</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>CMD</span> [<span style=color:#f1fa8c>&#34;supervisord&#34;</span>, <span style=color:#f1fa8c>&#34;-c&#34;</span>, <span style=color:#f1fa8c>&#34;supervisord.conf&#34;</span>]</span></span></code></pre></div></div><hr><h2 class="relative group">Lessons Learned<div id=lessons-learned class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#lessons-learned aria-label=Anchor>#</a></span></h2><p>After building and operating TARS, here are the patterns that proved most valuable:</p><p><strong>1. Temperature 0.0 for investigation agents.</strong> SRE investigation requires determinism. You want the agent to follow the same procedures consistently. Creative responses are a liability when debugging production.</p><p><strong>2. Sub-agents are essential for complex investigations.</strong> A single agent trying to search GitLab, read code, check AWS, and analyze logs will lose track of its investigation plan. Sub-agents with focused tool sets produce much better results.</p><p><strong>3. Streaming is not optional.</strong> Investigations take 30-60 seconds. Without real-time streaming of tool calls and reasoning, users don&rsquo;t trust the system. Seeing the agent&rsquo;s thought process builds confidence in the results.</p><p><strong>4. Tool output truncation prevents context collapse.</strong> A single CloudWatch <code>get_log_events</code> call can return megabytes of data. Without aggressive truncation (12,000 chars), the context window fills with log noise and the agent loses track of its investigation.</p><p><strong>5. Read-only by default, always.</strong> An AI agent that can modify infrastructure is a liability. TARS is read-only for AWS by design. The only write operations allowed are creating GitLab branches, committing to non-protected branches, and creating merge requests. This means the worst-case scenario is an unwanted MR, which is trivially reversible.</p><p><strong>6. Per-user credentials, never shared.</strong> Each user authenticates with their own GitLab token and AWS SAML credentials. This means every action the agent takes is auditable to the individual user. If the agent reads a file in GitLab, it shows up in that user&rsquo;s access log.</p><p><strong>7. The system prompt is the product.</strong> 80% of the agent&rsquo;s quality comes from the system prompt, not the model or the tools. Investing weeks in crafting precise behavioral constraints, investigation procedures, and output formatting rules pays off enormously.</p><p><strong>8. Cache aggressively, but at the right granularity.</strong> The KPI dashboard&rsquo;s fixed-bucket caching strategy (fetch 15/31/91 day buckets regardless of user request) improved cache hit rates from ~20% to ~85%. The key insight is that the most expensive operation (GitLab API calls) should be cached at a coarser granularity than what the user sees.</p><hr><h2 class="relative group">What&rsquo;s Next<div id=whats-next class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#whats-next aria-label=Anchor>#</a></span></h2><p>The natural evolution is expanding TARS from investigation to remediation. Today it tells you what&rsquo;s wrong. Tomorrow it could:</p><ul><li>Create a hotfix branch with the correct code change</li><li>Open an MR with the fix, tagged for urgent review</li><li>Draft the incident report based on its investigation findings</li><li>Suggest runbook updates based on novel failure modes it discovers</li></ul><p>The foundation is already there. The tool policy system supports ELEVATED operations. The branch protection ensures writes are safe. The main challenge is building the right human-in-the-loop confirmation flow so the agent proposes changes but never applies them autonomously.</p><p>That&rsquo;s the endgame: an AI SRE that investigates like your best engineer, communicates like your best technical writer, and never needs to sleep.</p><hr><h2 class="relative group">References<div id=references class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#references aria-label=Anchor>#</a></span></h2><ul><li><a href=https://github.com/strands-agents/sdk-python target=_blank rel=noreferrer>Strands Agents SDK</a></li><li><a href=https://docs.djangoproject.com/en/5.0/topics/async/ target=_blank rel=noreferrer>Django Async Views</a></li><li><a href=https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events target=_blank rel=noreferrer>Server-Sent Events (MDN)</a></li><li><a href=https://oauth.net/2/pkce/ target=_blank rel=noreferrer>PKCE OAuth2 Flow</a></li><li><a href=https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithSAML.html target=_blank rel=noreferrer>AWS STS AssumeRoleWithSAML</a></li><li><a href=https://www.radix-ui.com/ target=_blank rel=noreferrer>Radix UI</a></li><li><a href=https://guide.elm-lang.org/architecture/ target=_blank rel=noreferrer>The Elm Architecture</a></li></ul></div><h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2><section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3"><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src="https://images.unsplash.com/photo-1526374965328-7f61d4dc18c5?w=1200&amp;q=85" role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/posts/building-ai-document-processing-pipeline-aws/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>Building an AI-Powered Document Processing Pipeline on AWS</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-12-03T16:45:00+01:00>3 December 2025</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">11 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/tags/aws/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">AWS
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/ai/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">AI
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/llm/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">LLM
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/step-functions/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Step Functions
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/lambda/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Lambda
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/serverless/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Serverless
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/python/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Python
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/architecture/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Architecture</span></span></a></div></div></div><div class="px-6 pt-4 pb-2"></div></article><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src="https://images.unsplash.com/photo-1620712943543-bcc4688e7485?w=1200&amp;q=85" role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/posts/building-ai-powered-platform-operations-agent/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>Building an AI-Powered Platform Operations Agent</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2026-02-15T11:00:00+01:00>15 February 2026</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">9 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/tags/python/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Python
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/ai/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">AI
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/devops/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">DevOps
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/automation/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Automation
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/llm/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">LLM</span></span></a></div></div></div><div class="px-6 pt-4 pb-2"></div></article><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src="https://images.unsplash.com/photo-1535223289429-462ea9301402?w=1200&amp;q=85" role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/posts/multi-account-aws-terraform-workspaces/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>Managing Multi-Account AWS Infrastructure with Terraform Workspaces</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-09-22T09:15:00+02:00>22 September 2025</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">7 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/tags/aws/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">AWS
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/terraform/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Terraform
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/iac/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">IaC
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/devops/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">DevOps
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/cloud/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Cloud</span></span></a></div></div></div><div class="px-6 pt-4 pb-2"></div></article><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src="https://images.unsplash.com/photo-1558494949-ef010cbdcc31?w=1200&amp;q=85" role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/posts/ecs-fargate-production-patterns/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>ECS Fargate Production Patterns That Actually Work</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2026-01-08T14:20:00+01:00>8 January 2026</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">6 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/tags/aws/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">AWS
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/ecs/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">ECS
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/fargate/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Fargate
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/terraform/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Terraform
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/docker/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Docker
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/cloud/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Cloud</span></span></a></div></div></div><div class="px-6 pt-4 pb-2"></div></article></section></div></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span class="flex flex-col"><a class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/posts/building-ai-powered-platform-operations-agent/><span class=leading-6><span class="inline-block rtl:rotate-180">&larr;</span>&ensp;Building an AI-Powered Platform Operations Agent
</span></a><span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2026-02-15T11:00:00+01:00>15 February 2026</time>
</span></span><span class="flex flex-col items-end"><a class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/posts/wasm-vert-cloudfront-zero-cost/><span class=leading-6>WASM in the Browser: Deploying VERT on CloudFront for Free&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
</span></a><span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2026-03-01T10:00:00+01:00>1 March 2026</time></span></span></div></div></footer></article><div id=scroll-to-top class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200"><a href=#the-top class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2026
Manuel Fedele</p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://manuelfedele.github.io/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>